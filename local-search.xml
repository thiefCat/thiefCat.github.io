<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>CSE276A - Kalman Filter</title>
    <link href="/2025/11/08/CSE276A/CSE276A-kalman-filter/"/>
    <url>/2025/11/08/CSE276A/CSE276A-kalman-filter/</url>
    
    <content type="html"><![CDATA[<h2 id="Basis">Basis</h2><h3 id="What-is-Kalman-Filter">What is Kalman Filter</h3><p>An 1 dimensional example: We have two measurements <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> measuring a value. Each measurement has an uncertainty (standard deviation), <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\sigma_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>σ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\sigma_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. How to find the optimal estimate, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>, that best combines <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p><p>The idea is to use a weighted least squares, We want to find an <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span> that minimizes the “cost” function <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mover accent="true"><mi>x</mi><mo>^</mo></mover><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">S = \sum_{i=1}^{n}w_i(\hat{x} - x_i)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.104em;vertical-align:-0.2997em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>. We want to give more weight to the measurement we trust more (the one with lower uncertainty), so we set <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><msubsup><mi>σ</mi><mi>i</mi><mn>2</mn></msubsup></mfrac></mrow><annotation encoding="application/x-tex">w_i = \frac{1}{\sigma_i^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4443em;vertical-align:-0.5992em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.6264em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8051em;"><span style="top:-2.1777em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-2.8448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3223em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5992em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>. We solve <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>x</mi><mo>^</mo></mover><mo>=</mo><mfrac><mrow><mo>∑</mo><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><mrow><mo>∑</mo><msub><mi>w</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\hat{x} = \frac{\sum w_i x_i}{\sum w_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>x</mi><mo>^</mo></mover><mo>=</mo><mrow><mo fence="true">(</mo><mfrac><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mo fence="true">)</mo></mrow><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mrow><mo fence="true">(</mo><mfrac><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mo fence="true">)</mo></mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\hat{x} = \left( \frac{\sigma_2^2}{\sigma_1^2 + \sigma_2^2} \right) x_1 + \left( \frac{\sigma_1^2}{\sigma_1^2 + \sigma_2^2} \right) x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4434em;vertical-align:-0.9523em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4434em;vertical-align:-0.9523em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>The new uncertainty of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span></span></span></span>: Since <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Var</mtext><mo stretchy="false">(</mo><mi>a</mi><mo>⋅</mo><mi>X</mi><mo>+</mo><mi>b</mi><mo>⋅</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>a</mi><mn>2</mn></msup><mo>⋅</mo><mtext>Var</mtext><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup><mo>⋅</mo><mtext>Var</mtext><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Var}(a \cdot X + b \cdot Y) = a^2 \cdot \text{Var}(X) + b^2 \cdot \text{Var}(Y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Var</span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Var</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Var</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>, we get:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>σ</mi><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>2</mn></msubsup><mo>=</mo><msup><mrow><mo fence="true">(</mo><mfrac><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mo fence="true">)</mo></mrow><mn>2</mn></msup><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo fence="true">(</mo><mfrac><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mo fence="true">)</mo></mrow><mn>2</mn></msup><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_{\hat{x}}^2 = \left( \frac{\sigma_2^2}{\sigma_1^2 + \sigma_2^2} \right)^2 \sigma_1^2 + \left( \frac{\sigma_1^2}{\sigma_1^2 + \sigma_2^2} \right)^2 \sigma_2^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight">x</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.6474em;vertical-align:-0.9523em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.6951em;"><span style="top:-3.944em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.6474em;vertical-align:-0.9523em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.6951em;"><span style="top:-3.944em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>σ</mi><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>2</mn></msubsup><mo>=</mo><mfrac><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\sigma_{\hat{x}}^2 = \frac{\sigma_1^2 \sigma_2^2}{\sigma_1^2 + \sigma_2^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1111em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight">x</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4434em;vertical-align:-0.9523em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>Rewrite the above formula as an update step:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>x</mi><mo>^</mo></mover><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mfrac><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{x} = x_1 + \frac{\sigma_1^2}{\sigma_1^2 + \sigma_2^2} (x_2 - x_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4434em;vertical-align:-0.9523em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4911em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959em;"><span style="top:-2.4337em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2663em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9523em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><h3 id="Discrete-Kalman-Filter">Discrete Kalman Filter</h3><p><strong>In robotics case, the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the prediction of the robot’s state given previous state, and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is the actual measurement of robot’s state from sensor.</strong></p><h4 id="The-Process-Model">The Process Model</h4><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>F</mi><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>G</mi><msub><mi>u</mi><mi>t</mi></msub><mo>+</mo><msub><mi>w</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t = Fs_{t-1} + Gu_t + w_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: The <strong>true state</strong> of the system at time <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>: It defines how the state would change if there were no control inputs. For example, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>v</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">s = \begin{bmatrix} p \\ v \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span> (where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span> is position, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> is velocity), then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>t</mi></msub><mo>=</mo><msub><mi>p</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>v</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>⋅</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">p_t = p_{t-1} + v_{t-1} \cdot \Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6528em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>t</mi></msub><mo>=</mo><msub><mi>v</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">v_t = v_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>, then</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mi>t</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mi>t</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>p</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} p_t \\ v_t \end{bmatrix} = \begin{bmatrix} 1 &amp; \Delta t \\ 0 &amp; 1 \end{bmatrix} \begin{bmatrix} p_{t-1} \\ v_{t-1} \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><msub><mi>u</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">Gu_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">u_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is control input. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> maps that command to a change in the state. For example, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>=</mo><mo stretchy="false">[</mo><mi>a</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">u_t = [a]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mclose">]</span></span></span></span> which is acceleration, then <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>v</mi><mo>=</mo><mi>a</mi><mo>⋅</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta v = a \cdot \Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>p</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>a</mi><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\Delta p = \frac{1}{2} a (\Delta t)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">Δ</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>. As a result,</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>G</mi><msub><mi>u</mi><mi>t</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">Δ</mi><mi>p</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">Δ</mi><mi>v</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>a</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">Gu_t = \begin{bmatrix} \Delta p \\ \Delta v \end{bmatrix} = \begin{bmatrix} \frac{1}{2} (\Delta t)^2 \\ \Delta t \end{bmatrix} \begin{bmatrix} a \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal">p</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4051em;vertical-align:-0.9526em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4526em;"><span style="top:-3.6074em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.4074em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9526em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">w_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: Process noise, for example, a bump in the road or wheel slippage. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>w</mi><mo stretchy="false">)</mo><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>Q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(w) \sim N(0, Q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">Q</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span> represents “How much do I distrust my system model?”.</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub><mo>=</mo><mi>H</mi><msub><mi>s</mi><mi>t</mi></msub><mo>+</mo><msub><mi>v</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">z_t = Hs_t + v_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">z_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: The observation that sensor gives.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span>: For example, your state <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> might be a 6D vector (position x, y, z; velocity vx, vy, vz), but measurement <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">z_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is only a 3D vector (position x, y, z). The <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> matrix would be a 3x6 matrix that just “selects” the first three components of the state.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">v_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: Measurement Noise by the sensor itself. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(v) \sim N(0, R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span>. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> represents “How much do I distrust my sensor?”.</li></ul><h4 id="Kalman-Prediction">Kalman Prediction</h4><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>F</mi><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>G</mi><msub><mi>u</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_{t|t-1} = Fs_{t-1|t-1} + Gu_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_{t-1|t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span>: The corrected state after the last update.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_{t|t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span>: The new predicted state for the current time <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>, based only on information from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>.</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>F</mi><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mi>F</mi><mi>T</mi></msup><mo>+</mo><msub><mi>Q</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\Sigma_{t|t-1} = F\Sigma_{t-1|t-1}F^T + Q_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2465em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Sigma_{t-1|t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span>: Uncertainty covariance matrix of last best estimate <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_{t-1|t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span>.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Sigma_{t|t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span>: New, larger predicted uncertainty for the current time <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>.</li></ul><h4 id="Kalman-Updating">Kalman Updating</h4><p>State Update:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>K</mi><mi>t</mi></msub><mo stretchy="false">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>−</mo><mi>H</mi><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s_{t|t} = s_{t|t-1} + K_t(z_t - H s_{t|t-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><ul><li>The above formula is equivalent to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>^</mo></mover><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mi>K</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{x} = x_1 + K(x_2 - x_1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">s_{t|t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span>: The corrected state for time <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>.</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>−</mo><mi>H</mi><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(z_t - H s_{t|t-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">z_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is new measurement, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">H s_{t|t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span> is expected measurement. The difference is called “surprise”.</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>K</mi><mi>t</mi></msub><mo>=</mo><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mi>H</mi><mi>T</mi></msup><msubsup><mi>S</mi><mi>t</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">K_t = \Sigma_{t|t-1} H^T S_t^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2465em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-2.453em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>H</mi><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mi>H</mi><mi>T</mi></msup><mo>+</mo><msub><mi>R</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_t = H \Sigma_{t|t-1} H^T + R_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2465em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">S_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: Equivalent to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_1^2 + \sigma_2^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span> in the 1D example. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Sigma_{t|t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span> is predicted uncertainty (like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_1^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span>), and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mi>H</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">H \Sigma_{t|t-1} H^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1965em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span> is the predicted uncertainty projected into the measurement space. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">R_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> is measurement sensor’s uncertainty (like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_2^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0622em;vertical-align:-0.2481em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4519em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em;"><span></span></span></span></span></span></span></span></span></span>).</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">K_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>: This is the matrix version of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mo>=</mo><mfrac><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mrow><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>σ</mi><mn>2</mn><mn>2</mn></msubsup></mrow></mfrac></mrow><annotation encoding="application/x-tex">K = \frac{\sigma_1^2}{\sigma_1^2 + \sigma_2^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.7258em;vertical-align:-0.5916em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1341em;"><span style="top:-2.6264em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8051em;"><span style="top:-2.1885em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span><span style="top:-2.8448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3115em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8051em;"><span style="top:-2.1885em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-2.8448em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3115em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5102em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.214em;margin-left:-0.0359em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5916em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>.</li></ul><p>Covariance Update:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><mi>I</mi><mo>−</mo><msub><mi>K</mi><mi>t</mi></msub><mi>H</mi><mo stretchy="false">)</mo><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Sigma_{t|t} = (I - K_t H) \Sigma_{t|t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mclose">)</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\Sigma_{t|t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span>: Corrected, smaller uncertainty (like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_{\hat{x}}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0972em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.4169em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mathnormal mtight">x</span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord mtight">^</span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span>).</li></ul><h3 id="Extended-Kalman-Filter">Extended Kalman Filter</h3><p>The previous formula all assumed a linear world. However, in many cases, the state change is non-linear. For example, a robot’s state <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y, \theta]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">]</span></span></span></span>:</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>v</mi><mi>t</mi></msub><mo>⋅</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">x_t = x_{t-1} + v_t \cdot \cos(\theta_{t-1}) \cdot \Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>v</mi><mi>t</mi></msub><mo>⋅</mo><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>⋅</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">y_t = y_{t-1} + v_t \cdot \sin(\theta_{t-1}) \cdot \Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>t</mi></msub><mo>=</mo><msub><mi>θ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ω</mi><mi>t</mi></msub><mo>⋅</mo><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\theta_t = \theta_{t-1} + \omega_t \cdot \Delta t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span></li></ul><p>As a result, there is no way to write the relationship with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>F</mi><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>G</mi><msub><mi>u</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">s_t = F s_{t-1} + G u_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. In this section, we will use a non-linear expression:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>u</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>w</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_t = f(s_{t-1}, u_{t-1}) + w_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub><mo>=</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">z_t = h(s_t) + v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>If the system is non-linear, we can’t use the Kalman filter. So, at every single time step, we will approximate the non-linear function with a linear one. The best linear approximation of a function at a specific point is its tangent line (or tangent plane in multi-dimensions) found by <strong>first-order Taylor series expansion</strong>.</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mi>t</mi></msub><mo>≈</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>u</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>w</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">s_t \approx f(s_{t-1|t-1}, u_{t-1}, 0) + F(s_{t-1} - s_{t-1|t-1}) + w_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6331em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub><mo>≈</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>+</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>−</mo><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>v</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">z_t \approx h(s_{t|t}, 0) + H(s_t - s_{t|t}) + v_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6331em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>f</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>s</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>u</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_{ij} = \frac{\partial f_i}{\partial s_j}(s_{t-1|t-1}, u_{t-1}, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4745em;vertical-align:-0.5423em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:-0.1076em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5423em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msub><mi>h</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>s</mi><mi>j</mi></msub></mrow></mfrac><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi></mrow></msub><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H_{ij} = \frac{\partial h_i}{\partial s_j}(s_{t|t}, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.4385em;vertical-align:-0.5423em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8962em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5423em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span>.</p><h4 id="EKF-Prediction">EKF Prediction</h4><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>u</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s_{t|t-1} = f(s_{t-1|t-1}, u_{t-1}, 0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>F</mi><mi>t</mi></msub><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msubsup><mi>F</mi><mi>t</mi><mi>T</mi></msubsup><mo>+</mo><msub><mi>Q</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Sigma_{t|t-1} = F_t \Sigma_{t-1|t-1} F_t^T + Q_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2465em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span></p><h4 id="EKF-Updating">EKF Updating</h4><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>K</mi><mi>t</mi></msub><mo>=</mo><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msubsup><mi>H</mi><mi>t</mi><mi>T</mi></msubsup><mo stretchy="false">(</mo><msub><mi>H</mi><mi>t</mi></msub><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msubsup><mi>H</mi><mi>t</mi><mi>T</mi></msubsup><mo>+</mo><msub><mi>R</mi><mi>t</mi></msub><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">K_t = \Sigma_{t|t-1} H_t^T (H_t \Sigma_{t|t-1} H_t^T + R_t)^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2465em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>K</mi><mi>t</mi></msub><mo stretchy="false">(</mo><msub><mi>z</mi><mi>t</mi></msub><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s_{t|t} = s_{t|t-1} + K_t (z_t - h(s_{t|t-1}, 0))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7858em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mclose">))</span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><mi>I</mi><mo>−</mo><msub><mi>K</mi><mi>t</mi></msub><msub><mi>H</mi><mi>t</mi></msub><mo stretchy="false">)</mo><msub><mi mathvariant="normal">Σ</mi><mrow><mi>t</mi><mi mathvariant="normal">∣</mi><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\Sigma_{t|t} = (I - K_t H_t) \Sigma_{t|t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0385em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">Σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">∣</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span></span></span></span></span></span></span></span></span></span></span></p>]]></content>
    
    
    <categories>
      
      <category>CSE276A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ROS2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSE276A - ROS2 TF</title>
    <link href="/2025/11/08/CSE276A/CSE276A-tf/"/>
    <url>/2025/11/08/CSE276A/CSE276A-tf/</url>
    
    <content type="html"><![CDATA[<h3 id="Introduction">Introduction</h3><p>There are many coordinate systems in the environment (e.g., robot frame, world frame, camera frame, arm frame, landmark frame). If we can get the transformation from camera to a landmark, then where is the landmark relative to the robot? The ROS2 tf system can help us do the transformation.</p><h3 id="tf2">tf2</h3><p>tf2 stores all frames in a tree structure.</p><ul><li>Each frame has only one parent frame.</li><li>A parent frame can have many children frames.</li></ul><p>This tree structure ensures there is always a single path between any two frames. If a frame is not connected to the main tree, tf2 cannot transform to it.</p><h4 id="Static-Transform-Broadcaster">Static Transform Broadcaster</h4><p>This node publishes an unchanging transform. This is perfect for fixed relationships. This node publish transforms to <code>/tf_static</code> topic.</p><div class="code-wrapper"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> rclpy<span class="hljs-keyword">from</span> rclpy.node <span class="hljs-keyword">import</span> Node<span class="hljs-keyword">from</span> geometry_msgs.msg <span class="hljs-keyword">import</span> TransformStamped<span class="hljs-keyword">from</span> tf2_ros.static_transform_broadcaster <span class="hljs-keyword">import</span> StaticTransformBroadcaster<span class="hljs-keyword">import</span> tf_transformations<span class="hljs-keyword">class</span> <span class="hljs-title class_">StaticFramePublisher</span>(<span class="hljs-title class_ inherited__">Node</span>):    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    This node publishes a static transform between &#x27;base_link&#x27; and &#x27;camera_link&#x27;.</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):        <span class="hljs-built_in">super</span>().__init__(<span class="hljs-string">&#x27;static_transform_broadcaster_node&#x27;</span>)        <span class="hljs-comment"># 1. Initialize the StaticTransformBroadcaster</span>        <span class="hljs-variable language_">self</span>.tf_static_broadcaster = StaticTransformBroadcaster(<span class="hljs-variable language_">self</span>)        <span class="hljs-comment"># 2. Create the TransformStamped message</span>        static_transform = TransformStamped()        static_transform.header.stamp = <span class="hljs-variable language_">self</span>.get_clock().now().to_msg()        static_transform.header.frame_id = <span class="hljs-string">&#x27;base_link&#x27;</span>  <span class="hljs-comment"># Parent frame</span>        static_transform.child_frame_id = <span class="hljs-string">&#x27;camera_link&#x27;</span> <span class="hljs-comment"># Child frame</span>        <span class="hljs-comment"># 3. Set the translation</span>        static_transform.transform.translation.x = <span class="hljs-number">0.5</span>        static_transform.transform.translation.y = <span class="hljs-number">0.0</span>        static_transform.transform.translation.z = <span class="hljs-number">0.2</span>        <span class="hljs-comment"># 4. Set the rotation</span>        q = tf_transformations.quaternion_from_euler(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>) <span class="hljs-comment"># default order: (roll, pitch, yaw)</span>        static_transform.transform.rotation.x = q[<span class="hljs-number">0</span>]        static_transform.transform.rotation.y = q[<span class="hljs-number">1</span>]        static_transform.transform.rotation.z = q[<span class="hljs-number">2</span>]        static_transform.transform.rotation.w = q[<span class="hljs-number">3</span>]        <span class="hljs-comment"># 5. Publish the transform</span>        <span class="hljs-variable language_">self</span>.tf_static_broadcaster.sendTransform(static_transform)        <span class="hljs-variable language_">self</span>.get_logger().info(<span class="hljs-string">&#x27;Published static transform: base_link -&gt; camera_link&#x27;</span>)</code></pre></div><h4 id="Dynamic-Transform-Broadcaster">Dynamic Transform Broadcaster</h4><div class="code-wrapper"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> rclpy<span class="hljs-keyword">from</span> rclpy.node <span class="hljs-keyword">import</span> Node<span class="hljs-keyword">from</span> geometry_msgs.msg <span class="hljs-keyword">import</span> TransformStamped<span class="hljs-keyword">from</span> tf2_ros <span class="hljs-keyword">import</span> TransformBroadcaster<span class="hljs-keyword">import</span> tf_transformations<span class="hljs-keyword">import</span> math<span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicFrameBroadcaster</span>(<span class="hljs-title class_ inherited__">Node</span>):    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    This node publishes a dynamic transform from &#x27;odom&#x27; to &#x27;base_link&#x27;.</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):        <span class="hljs-built_in">super</span>().__init__(<span class="hljs-string">&#x27;dynamic_transform_broadcaster_node&#x27;</span>)        <span class="hljs-comment"># 1. Initialize the TransformBroadcaster</span>        <span class="hljs-variable language_">self</span>.tf_broadcaster = TransformBroadcaster(<span class="hljs-variable language_">self</span>)        <span class="hljs-comment"># 2. Create a timer to call the publish_callback function</span>        <span class="hljs-variable language_">self</span>.timer = <span class="hljs-variable language_">self</span>.create_timer(<span class="hljs-number">0.1</span>, <span class="hljs-variable language_">self</span>.publish_callback) <span class="hljs-comment"># 10 Hz</span>        <span class="hljs-variable language_">self</span>.get_logger().info(<span class="hljs-string">&#x27;Publishing dynamic transform: odom -&gt; base_link&#x27;</span>)    <span class="hljs-keyword">def</span> <span class="hljs-title function_">publish_callback</span>(<span class="hljs-params">self</span>):        current_time = <span class="hljs-variable language_">self</span>.get_clock().now()                seconds, _ = <span class="hljs-variable language_">self</span>.get_clock().now().seconds_nanoseconds()                t = TransformStamped()        t.header.stamp = current_time.to_msg()        t.header.frame_id = <span class="hljs-string">&#x27;odom&#x27;</span>        t.child_frame_id = <span class="hljs-string">&#x27;base_link&#x27;</span>        t.transform.translation.x = math.sin(seconds)        t.transform.translation.y = math.cos(seconds)        t.transform.translation.z = <span class="hljs-number">0.0</span>        q = tf_transformations.quaternion_from_euler(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, -seconds) <span class="hljs-comment"># (roll, pitch, yaw)</span>        t.transform.rotation.x = q[<span class="hljs-number">0</span>]        t.transform.rotation.y = q[<span class="hljs-number">1</span>]        t.transform.rotation.z = q[<span class="hljs-number">2</span>]        t.transform.rotation.w = q[<span class="hljs-number">3</span>]        <span class="hljs-variable language_">self</span>.tf_broadcaster.sendTransform(t)</code></pre></div><h4 id="Transform-Listener">Transform Listener</h4><p>This node listens to the <code>/tf</code> and <code>/tf_static</code> topics (via the buffer) and can look up any transform in the tree.</p><ul><li>The <code>tf2::Buffer</code> is is the “brain” of the operation. When you ask for odom -&gt; camera_link, it looks at its data and figures out the path, then performs all the mathematical calculations to get the final transform.</li><li>The <code>TransformListener</code> automatically subscribe to the <code>/tf</code> and <code>/tf_static</code> topics and feed all the incoming transform messages directly into the <code>tf2::Buffer</code>.</li></ul><div class="code-wrapper"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> rclpy<span class="hljs-keyword">from</span> rclpy.node <span class="hljs-keyword">import</span> Node<span class="hljs-keyword">from</span> rclpy.duration <span class="hljs-keyword">import</span> Duration<span class="hljs-keyword">from</span> tf2_ros <span class="hljs-keyword">import</span> TransformException<span class="hljs-keyword">from</span> tf2_ros.buffer <span class="hljs-keyword">import</span> Buffer<span class="hljs-keyword">from</span> tf2_ros.transform_listener <span class="hljs-keyword">import</span> TransformListener<span class="hljs-keyword">class</span> <span class="hljs-title class_">FrameListener</span>(<span class="hljs-title class_ inherited__">Node</span>):    <span class="hljs-string">&quot;&quot;&quot;</span><span class="hljs-string">    This node listens to the TF tree and looks up the transform</span><span class="hljs-string">    from &#x27;odom&#x27; (target) to &#x27;camera_link&#x27; (source).</span><span class="hljs-string">    &quot;&quot;&quot;</span>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):        <span class="hljs-built_in">super</span>().__init__(<span class="hljs-string">&#x27;tf_listener_node&#x27;</span>)        <span class="hljs-variable language_">self</span>.target_frame = <span class="hljs-string">&#x27;odom&#x27;</span>        <span class="hljs-variable language_">self</span>.source_frame = <span class="hljs-string">&#x27;camera_link&#x27;</span>        <span class="hljs-comment"># The Buffer stores incoming transforms</span>        <span class="hljs-variable language_">self</span>.tf_buffer = Buffer()        <span class="hljs-comment"># The Listener subscribes to /tf and /tf_static and fills the buffer</span>        <span class="hljs-variable language_">self</span>.tf_listener = TransformListener(<span class="hljs-variable language_">self</span>.tf_buffer, <span class="hljs-variable language_">self</span>)        <span class="hljs-variable language_">self</span>.timer = <span class="hljs-variable language_">self</span>.create_timer(<span class="hljs-number">1.0</span>, <span class="hljs-variable language_">self</span>.lookup_callback) <span class="hljs-comment"># 1 Hz</span>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lookup_callback</span>(<span class="hljs-params">self</span>):        target = <span class="hljs-variable language_">self</span>.target_frame        source = <span class="hljs-variable language_">self</span>.source_frame        <span class="hljs-keyword">try</span>:            <span class="hljs-comment"># Look up the transform</span>            trans = <span class="hljs-variable language_">self</span>.tf_buffer.lookup_transform(                target,                source,                rclpy.time.Time(), <span class="hljs-comment"># this parameter means finding the newest transform in the buffer</span>                timeout=Duration(seconds=<span class="hljs-number">0.5</span>)) <span class="hljs-comment"># Wait up to 0.5s for the transform, if time exceeds, throw exception</span>            <span class="hljs-variable language_">self</span>.get_logger().info(<span class="hljs-string">f&#x27;  Translation: [x: <span class="hljs-subst">&#123;trans.transform.translation.x:<span class="hljs-number">.2</span>f&#125;</span>, &#x27;</span> +                                  <span class="hljs-string">f&#x27;y: <span class="hljs-subst">&#123;trans.transform.translation.y:<span class="hljs-number">.2</span>f&#125;</span>, &#x27;</span> +                                  <span class="hljs-string">f&#x27;z: <span class="hljs-subst">&#123;trans.transform.translation.z:<span class="hljs-number">.2</span>f&#125;</span>]&#x27;</span>)            <span class="hljs-variable language_">self</span>.get_logger().info(<span class="hljs-string">f&#x27;  Rotation: [x: <span class="hljs-subst">&#123;trans.transform.rotation.x:<span class="hljs-number">.2</span>f&#125;</span>, &#x27;</span> +                                  <span class="hljs-string">f&#x27;y: <span class="hljs-subst">&#123;trans.transform.rotation.y:<span class="hljs-number">.2</span>f&#125;</span>, &#x27;</span> +                                  <span class="hljs-string">f&#x27;z: <span class="hljs-subst">&#123;trans.transform.rotation.z:<span class="hljs-number">.2</span>f&#125;</span>, &#x27;</span> +                                  <span class="hljs-string">f&#x27;w: <span class="hljs-subst">&#123;trans.transform.rotation.w:<span class="hljs-number">.2</span>f&#125;</span>]&#x27;</span>)        <span class="hljs-keyword">except</span> TransformException <span class="hljs-keyword">as</span> ex:            <span class="hljs-comment"># Handle exceptions (e.g., transform not available)</span>            <span class="hljs-variable language_">self</span>.get_logger().warn(                <span class="hljs-string">f&#x27;Could not get transform from <span class="hljs-subst">&#123;source&#125;</span> to <span class="hljs-subst">&#123;target&#125;</span>: <span class="hljs-subst">&#123;ex&#125;</span>&#x27;</span>)</code></pre></div><h3 id="TransformStamped-Message">TransformStamped Message</h3><p><code>TransformStamped</code> is the standard ROS message used to communicate a single transformation. It’s not a matrix itself, but it contains the data needed to build one.</p><ul><li><code>header.stamp</code>: When this transform was measured</li><li><code>header.frame_id</code>: The parent frame</li><li><code>child_frame_id</code>: The child frame</li><li><code>transform.translation</code>: The <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">t</mi></mrow><annotation encoding="application/x-tex">\mathbf{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6349em;"></span><span class="mord mathbf">t</span></span></span></span> vector</li><li><code>transform.rotation</code>: The <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">R</mi></mrow><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">R</span></span></span></span> matrix represented as a quaternion</li></ul><h3 id="tf-transformations-Package"><code>tf_transformations</code> Package</h3><p>This package helps us do the calculations related to transformations.</p><ul><li><code>translation_matrix([x, y, z])</code>: Creates a 4x4 translation-only matrix.</li><li><code>quaternion_matrix([x, y, z, w])</code>: Creates a 4x4 rotation-only matrix from a quaternion.</li><li><code>concatenate_matrices(matrix1, matrix2, ...)</code>: Multiplies (chains) matrices.</li><li><code>inverse_matrix(matrix)</code>: Calculates the inverse of a 4x4 matrix (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mi>B</mi></msup><msub><mi>T</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">{}^B T_{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9913em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mi>A</mi></msup><msub><mi>T</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">{}^{A} T_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9913em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>).</li><li><code>translation_from_matrix(matrix)</code>: Extracts the translation vector <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>t</mi><mi>x</mi></msub><mo separator="true">,</mo><msub><mi>t</mi><mi>y</mi></msub><mo separator="true">,</mo><msub><mi>t</mi><mi>z</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[t_x, t_y, t_z]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> from a 4x4 matrix.</li><li><code>quaternion_from_matrix(matrix)</code>: Extracts the rotation part as a quaternion <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>z</mi><mo separator="true">,</mo><mi>w</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x, y, z, w]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mclose">]</span></span></span></span>.</li><li><code>(roll, pitch, yaw) = tf_transformations.euler_from_quaternion([x, y, z, w], axes='sxyz')</code>: Converts a quaternion to Euler angles.</li></ul><p>Suppose we have a <code>TransformStamped</code> message and we want to build a homogeneous from it:</p><div class="code-wrapper"><pre><code class="hljs python">trans = Tstamped.transform.translationrot = Tstamped.transform.rotationTmatrix = tf_transformations.concatenate_matrices(    tf_transformations.translation_matrix([trans.x, trans.y, trans.z]),    tf_transformations.quaternion_matrix([rot.x, rot.y, rot.z, rot.w]))</code></pre></div><p>When we apply a homogeneous transformation to a point, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>A</mi></msub><mo>=</mo><msup><mrow></mrow><mi>A</mi></msup><msub><mi>T</mi><mi>B</mi></msub><mo>⋅</mo><msub><mi>p</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">p_A = {}^A T_B \cdot p_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9913em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, where</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mrow></mrow><mi>A</mi></msup><msub><mi>T</mi><mi>B</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>R</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>t</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">{}^A T_B = \begin{bmatrix}R &amp; t \\0 &amp; 1\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0413em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">t</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>It’s equivalent to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>A</mi></msub><mo>=</mo><mi>R</mi><mo>⋅</mo><msub><mi>p</mi><mi>B</mi></msub><mo>+</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">p_A = R \cdot p_B + t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>, which means, we first rotate <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span>, then apply translation. This is equivalent to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>A</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>T</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>l</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub><mo>⋅</mo><msub><mi>T</mi><mrow><mi>r</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub><mo stretchy="false">)</mo><mo>⋅</mo><msub><mi>p</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">p_A = (T_{translation} \cdot T_{rotation}) \cdot p_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, as a result</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mrow></mrow><mi>A</mi></msup><msub><mi>T</mi><mi>B</mi></msub><mo>=</mo><msub><mi>T</mi><mrow><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>l</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub><mo>⋅</mo><msub><mi>T</mi><mrow><mi>r</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{}^A T_B = T_{translation} \cdot T_{rotation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0413em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mord mathnormal mtight">an</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p>That’s why in the above code, we first concatenate translation then rotation.</p>]]></content>
    
    
    <categories>
      
      <category>CSE276A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ROS2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSE276A - Mathematics behind Coordinate Transformations</title>
    <link href="/2025/11/08/CSE276A/CSE276A-pose/"/>
    <url>/2025/11/08/CSE276A/CSE276A-pose/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><ul><li>How to describe the relationship between two coordinate frames?</li><li>If I know a point in frame A, how to compute the point in frame B?</li></ul><h2 id="Homogeneous-Transformation-Matrix">Homogeneous Transformation Matrix</h2><p>If we have constructed two coordinates (e.g., robot base link frame and camera frame), how to describe the transformation between the two coordinates? Suppose we want to find a matrix that can map coordinates in camera frame to robot frame, denoted by <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mi>r</mi></msup><mi mathvariant="bold">x</mi><mo>=</mo><msup><mrow></mrow><mi>r</mi></msup><msub><mi mathvariant="bold">T</mi><mi>c</mi></msub><msup><mrow></mrow><mi>c</mi></msup><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">{}^r\mathbf{x} = {}^r\mathbf{T}_c {}^c\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8361em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span></span></span></span></span><span class="mord mathbf">x</span></span></span></span></p><h3 id="Translation">Translation</h3><p>The child frame’s origin (camera) in the parent frame (robot).</p><h3 id="Rotation">Rotation</h3><p>A useful online rotation representation converter: <a href="https://www.andre-gaschler.com/rotationconverter/">rotation converter</a>.</p><h4 id="Euler-Angles">Euler Angles</h4><p>Any 3D orientation can be achieved by performing three sequential rotations around a set of defined axes. The order matters for Euler angles. As a result, a 3-dimensional euler vector cannot describe an orientation unless we specify the rotation order.</p><h4 id="Rotation-Matrix">Rotation Matrix</h4><p><strong>A 3x3 matrix where the columns are the child frame’s (camera’s) X, Y, and Z axes, as described in the parent frame’s (robot’s) coordinates.</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>R</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">∣</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">∣</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">∣</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mover accent="true"><mi>X</mi><mo>⃗</mo></mover><mi>C</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mover accent="true"><mi>Y</mi><mo>⃗</mo></mover><mi>C</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mover accent="true"><mi>Z</mi><mo>⃗</mo></mover><mi>C</mi></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">∣</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">∣</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="normal">∣</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">R = \begin{bmatrix}| &amp; | &amp; | \\\vec{X}_C &amp; \vec{Y}_C &amp; \vec{Z}_C \\| &amp; | &amp; |\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.7263em;vertical-align:-1.6132em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1132em;"><span style="top:-4.2732em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span></span></span><span style="top:-2.9468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9663em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.7468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.6132em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1132em;"><span style="top:-4.2732em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span></span></span><span style="top:-2.9468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9663em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.7468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.6132em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.1132em;"><span style="top:-4.2732em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span></span></span><span style="top:-2.9468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9663em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.7468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.6132em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="3.600em" viewBox="0 0 667 3600"><path d="M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v0 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h4 id="Quaternion">Quaternion</h4><p>Instead of 3 separate rotations, a quaternion represents orientation as a single rotation around one specific axis in 3D space. The quaternion representation is 4 dimensional.</p><h3 id="Transformation">Transformation</h3><p>After obtaining transformation and rotation, this 4x4 transformation matrix <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> is constructed by plugging in the 3x3 rotation matrix <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> and the 3x1 translation vector <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>T</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9663em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9663em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span></span>.</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mrow></mrow><mi>r</mi></msup><msub><mi mathvariant="bold">T</mi><mi>c</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>R</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mover accent="true"><mi>T</mi><mo>⃗</mo></mover></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mn>3</mn><mo>×</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mn>3</mn><mo>×</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">{}^r\mathbf{T}_c =\begin{bmatrix} &amp; &amp; &amp; \\ &amp; R &amp; &amp; \vec{T} \\ &amp; (3 \times 3) &amp; &amp; (3 \times 1) \\ &amp; &amp; &amp; \\0 &amp; 0 &amp; 0 &amp; 1\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8644em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:6.1263em;vertical-align:-2.8132em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.000em" viewBox="0 0 667 6000"><path d="M403 1759 V84 H666 V0 H319 V1759 v2400 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v2400 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3132em;"><span style="top:-5.4732em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-4.1468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.9468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.7468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.5468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8132em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3132em;"><span style="top:-5.4732em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-4.1468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-2.9468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">3</span><span class="mclose">)</span></span></span><span style="top:-1.7468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.5468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8132em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3132em;"><span style="top:-5.4732em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-4.1468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-2.9468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.7468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.5468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8132em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.3132em;"><span style="top:-5.4732em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-4.1468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9663em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1522em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span></span></span><span style="top:-2.9468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span><span style="top:-1.7468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.5468em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.8132em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.25em;"><span class="pstrut" style="height:8em;"></span><span style="width:0.667em;height:6.000em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="6.000em" viewBox="0 0 667 6000"><path d="M347 1759 V0 H0 V84 H263 V1759 v2400 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v2400 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>This matrix <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span> can transform any point <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">P_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> defined in the camera_frame coordinates directly into its corresponding point <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">P_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in the base_link frame coordinates with a single matrix multiplication:</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mi>B</mi><mo separator="true">,</mo><mi>x</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mi>B</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mi>B</mi><mo separator="true">,</mo><mi>z</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><msup><mrow></mrow><mi>r</mi></msup><msub><mi mathvariant="bold">T</mi><mi>c</mi></msub><mo>⋅</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mi>C</mi><mo separator="true">,</mo><mi>x</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mi>C</mi><mo separator="true">,</mo><mi>y</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mrow><mi>C</mi><mo separator="true">,</mo><mi>z</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix} P_{B,x} \\ P_{B,y} \\ P_{B,z} \\ 1 \end{bmatrix}={}^r\mathbf{T}_c\cdot\begin{bmatrix} P_{C,x} \\ P_{C,y} \\ P_{C,z} \\ 1 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.8em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.65em;"><span class="pstrut" style="height:6.8em;"></span><span style="width:0.667em;height:4.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.800em" viewBox="0 0 667 4800"><path d="M403 1759 V84 H666 V0 H319 V1759 v1200 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v1200 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.65em;"><span class="pstrut" style="height:6.8em;"></span><span style="width:0.667em;height:4.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.800em" viewBox="0 0 667 4800"><path d="M347 1759 V0 H0 V84 H263 V1759 v1200 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v1200 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8644em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:4.8em;vertical-align:-2.15em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.65em;"><span class="pstrut" style="height:6.8em;"></span><span style="width:0.667em;height:4.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.800em" viewBox="0 0 667 4800"><path d="M403 1759 V84 H666 V0 H319 V1759 v1200 v1759 h347 v-84H403z M403 1759 V0 H319 V1759 v1200 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65em;"><span style="top:-4.65em;"><span class="pstrut" style="height:6.8em;"></span><span style="width:0.667em;height:4.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.667em" height="4.800em" viewBox="0 0 667 4800"><path d="M347 1759 V0 H0 V84 H263 V1759 v1200 v1759 H0 v84 H347zM347 1759 V0 H263 V1759 v1200 v1759 h84z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.15em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><h3 id="Application">Application</h3><ul><li>Chaining Transforms</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mrow></mrow><mi>A</mi></msup><msub><mi>T</mi><mi>C</mi></msub><mo>=</mo><msup><mrow></mrow><mi>A</mi></msup><msub><mi>T</mi><mi>B</mi></msub><mo>⋅</mo><msup><mrow></mrow><mi>B</mi></msup><msub><mi>T</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex">{}^A T_C = {}^A T_B \cdot {}^B T_C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0413em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0413em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0413em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li>Transform a Point Between Frames</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>P</mi><mi>A</mi></msub><mo>=</mo><msup><mrow></mrow><mi>A</mi></msup><msub><mi>T</mi><mi>B</mi></msub><mo>⋅</mo><msub><mi>P</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">P_A = {}^A T_B \cdot P_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0413em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><ul><li>Inverse of Transformation</li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>T</mi><mo>=</mo><msup><mrow></mrow><mi>A</mi></msup><msub><mi>T</mi><mi>B</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="bold">R</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="bold">t</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">T = {}^A T_B = \begin{bmatrix}\mathbf{R} &amp; \mathbf{t} \\0 &amp; 1\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0413em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">R</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">t</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>T</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mrow></mrow><mi>B</mi></msup><msub><mi>T</mi><mi>A</mi></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi mathvariant="bold">R</mi><mi>T</mi></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msup><mi mathvariant="bold">R</mi><mi>T</mi></msup><mi mathvariant="bold">t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">T^{-1} = {}^B T_A = \begin{bmatrix}\mathbf{R}^T &amp; -\mathbf{R}^T \mathbf{t} \\0 &amp; 1\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0413em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4013em;vertical-align:-0.9507em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4507em;"><span style="top:-3.6093em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span><span style="top:-2.4093em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9507em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4507em;"><span style="top:-3.6093em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathbf">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathbf">t</span></span></span><span style="top:-2.4093em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9507em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p>]]></content>
    
    
    <categories>
      
      <category>CSE276A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ROS2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSE276A - ROS2 Commands</title>
    <link href="/2025/10/26/CSE276A/CSE276A-ROS2-Commands/"/>
    <url>/2025/10/26/CSE276A/CSE276A-ROS2-Commands/</url>
    
    <content type="html"><![CDATA[<h3 id="Set-Up">Set Up</h3><ul><li><p><code>ros2 pkg create &lt;package_name&gt; --build-type &lt;type&gt; --dependencies &lt;deps&gt;</code>: Automatically generates the entire file and directory structure for a new, empty ROS 2 package.</p></li><li><p><code>ros2 pkg list</code>: Shows all packages that the ROS 2 environment can currently find.</p></li><li><p><code>ros2 pkg executables &lt;package_name&gt;</code>: Lists all the nodes that a specific package provides.</p></li><li><p><code>ros2 pkg dependencies &lt;package_name&gt;</code>:</p></li><li><p><code>colcon build</code>: Run this command from the workspace, it will find all the ROS 2 packages in the src directory, compile them in the correct order based on their dependencies, and place the resulting files in the install and build directories. After build, we need to source using <code>source install/setup.bash</code>.</p></li></ul><h3 id="Launch-Node">Launch Node</h3><ul><li><p><code>ros2 run &lt;package_name&gt; &lt;executable_name&gt;</code>: Launch a single node from a specific package.</p></li><li><p><code>ros2 launch &lt;package_name&gt; &lt;launch_file_name&gt;</code>: This launch file describes all the nodes that should be started, any parameters they should be set with, and how they might be connected. Running the launch file enable us to launch a complex application.</p></li></ul><h3 id="Node">Node</h3><ul><li><code>ros2 node list</code>: Shows all nodes currently active in the system.</li><li><code>ros2 node info &lt;node_name&gt;</code>: Lists all the publishers, subscribers, services, and actions associated with that specific node.</li></ul><h3 id="Topic">Topic</h3><ul><li><code>ros2 topic list</code>: Shows all topics currently active in the system.</li><li><code>ros2 topic echo &lt;topic_name&gt;</code>: Prints the data being published on a topic to the terminal in real-time.</li><li><code>ros2 topic pub &lt;topic_name&gt; &lt;message_type&gt; '&lt;data&gt;'</code>: Publishes a single message to a topic from the command line. Used for debugging.</li><li><code>ros2 topic hz &lt;topic_name&gt;</code>: Reports the average frequency in hertz at which messages are being published on a topic.</li></ul><h3 id="service">service</h3><ul><li><code>ros2 service list</code>: Shows all services currently active in the system.</li><li><code>ros2 service type &lt;service_name&gt;</code>: Shows the data type (interface) of the service.</li></ul>]]></content>
    
    
    <categories>
      
      <category>CSE276A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ROS2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSE276A - ROS2</title>
    <link href="/2025/10/24/CSE276A/CSE276A-ROS2/"/>
    <url>/2025/10/24/CSE276A/CSE276A-ROS2/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>ROS 2 (Robot Operating System 2) is a framework that runs on an existing OS. In a robot, there are separate programs that read camera data, controlling wheels, planning paths .etc. ROS 2 provides a standard way for all these independent programs to discover each other and exchange information.</p><h3 id="Nodes">Nodes</h3><p>A node is a single program responsible for one specific task.</p><div class="code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rclpy <span class="hljs-comment"># ROS Client Library for Python</span><span class="hljs-keyword">from</span> rclpy.node <span class="hljs-keyword">import</span> Node<span class="hljs-keyword">class</span> <span class="hljs-title class_">SensorNode</span>(<span class="hljs-title class_ inherited__">Node</span>):    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):        <span class="hljs-comment"># Initialize the node with the name &#x27;sensor_node&#x27;</span>        <span class="hljs-built_in">super</span>().__init__(<span class="hljs-string">&#x27;sensor_node&#x27;</span>)        <span class="hljs-variable language_">self</span>.get_logger().info(<span class="hljs-string">&#x27;LIDAR sensor node has started.&#x27;</span>)</code></pre></div><h3 id="Topics">Topics</h3><p>Topics are channels where nodes can send (publish) or receive (subscribe) data. This communication is asynchronous. E.g., the <code>sensor_node</code> needs to continuously broadcast sensor data to anyone who cares.</p><ul><li><p>Publisher</p><ul><li><code>self.publisher_ = self.create_publisher(String, 'chatter', 10)</code>: <code>String</code> specifies the message type, <code>'chatter'</code> is topic name, <code>10</code> is the the depth of the message queue.</li><li><code>self.timer = self.create_timer()</code>: register a timer event, the event is scheduled by <code>rclpy.init()</code>.</li><li><code>rclpy.init()</code>: Initializes the rclpy library, first step, mandatory.</li><li><code>rclpy.spin(node)</code>: ROS2 nodes are event-driven, this function will keep the node running and constantly listen for events. The program will stay at this line until <code>Ctrl+C</code> is entered.</li><li><code>node.destroy_node()</code>: Gracefully cleans up the node’s internal resources.</li><li><code>rclpy.shutdown()</code>: Shuts down the rclpy Library.</li></ul>  <div class="code-wrapper"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> rclpy<span class="hljs-keyword">from</span> rclpy.node <span class="hljs-keyword">import</span> Node<span class="hljs-keyword">from</span> std_msgs.msg <span class="hljs-keyword">import</span> String<span class="hljs-keyword">class</span> <span class="hljs-title class_">Talker</span>(<span class="hljs-title class_ inherited__">Node</span>):    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):        <span class="hljs-built_in">super</span>().__init__(<span class="hljs-string">&#x27;talker&#x27;</span>)        <span class="hljs-variable language_">self</span>.publisher_ = <span class="hljs-variable language_">self</span>.create_publisher(String, <span class="hljs-string">&#x27;chatter&#x27;</span>, <span class="hljs-number">10</span>)        timer_period = <span class="hljs-number">0.5</span>        <span class="hljs-variable language_">self</span>.timer = <span class="hljs-variable language_">self</span>.create_timer(timer_period, <span class="hljs-variable language_">self</span>.timer_callback) <span class="hljs-comment"># timer_callback is called every 0.5 seconds</span>        <span class="hljs-variable language_">self</span>.count = <span class="hljs-number">0</span>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">timer_callback</span>(<span class="hljs-params">self</span>):        msg = String()        msg.data = <span class="hljs-string">f&#x27;Hello ROS2: <span class="hljs-subst">&#123;self.count&#125;</span>&#x27;</span>        <span class="hljs-variable language_">self</span>.publisher_.publish(msg)        <span class="hljs-variable language_">self</span>.get_logger().info(<span class="hljs-string">f&#x27;Publishing: &quot;<span class="hljs-subst">&#123;msg.data&#125;</span>&quot;&#x27;</span>)        <span class="hljs-variable language_">self</span>.count += <span class="hljs-number">1</span><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">args=<span class="hljs-literal">None</span></span>):    rclpy.init(args=args)    node = Talker() <span class="hljs-comment"># Creates an instance of the Talker node class</span>    rclpy.spin(node)     node.destroy_node()    rclpy.shutdown()<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    main()</code></pre></div></li><li><p>Subscriber</p>  <div class="code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rclpy<span class="hljs-keyword">from</span> rclpy.node <span class="hljs-keyword">import</span> Node<span class="hljs-keyword">from</span> std_msgs.msg <span class="hljs-keyword">import</span> String<span class="hljs-keyword">class</span> <span class="hljs-title class_">Listener</span>(<span class="hljs-title class_ inherited__">Node</span>):    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):        <span class="hljs-built_in">super</span>().__init__(<span class="hljs-string">&#x27;listener&#x27;</span>)        <span class="hljs-variable language_">self</span>.subscription = <span class="hljs-variable language_">self</span>.create_subscription(            String,          <span class="hljs-comment"># message type</span>            <span class="hljs-string">&#x27;chatter&#x27;</span>,       <span class="hljs-comment"># topic name</span>            <span class="hljs-variable language_">self</span>.listener_callback,  <span class="hljs-comment"># callback function</span>            <span class="hljs-number">10</span>               <span class="hljs-comment"># queue size</span>        )        <span class="hljs-variable language_">self</span>.subscription    <span class="hljs-keyword">def</span> <span class="hljs-title function_">listener_callback</span>(<span class="hljs-params">self, msg</span>):        <span class="hljs-variable language_">self</span>.get_logger().info(<span class="hljs-string">f&#x27;I heard: &quot;<span class="hljs-subst">&#123;msg.data&#125;</span>&quot;&#x27;</span>)<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">args=<span class="hljs-literal">None</span></span>):    rclpy.init(args=args)    node = Listener()    rclpy.spin(node)    node.destroy_node()    rclpy.shutdown()<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    main()</code></pre></div></li></ul><h3 id="Services">Services</h3><p>Services are used for two-way communication. This communication is synchronous.</p><ul><li><p>Service Server</p>  <div class="code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rclpy<span class="hljs-keyword">from</span> rclpy.node <span class="hljs-keyword">import</span> Node<span class="hljs-keyword">from</span> example_interfaces.srv <span class="hljs-keyword">import</span> AddTwoInts<span class="hljs-keyword">class</span> <span class="hljs-title class_">AddTwoIntsServer</span>(<span class="hljs-title class_ inherited__">Node</span>):    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):        <span class="hljs-built_in">super</span>().__init__(<span class="hljs-string">&#x27;add_two_ints_server&#x27;</span>)        <span class="hljs-comment"># create a service</span>        <span class="hljs-variable language_">self</span>.srv = <span class="hljs-variable language_">self</span>.create_service(AddTwoInts, <span class="hljs-string">&#x27;add_two_ints&#x27;</span>, <span class="hljs-variable language_">self</span>.add_two_ints_callback)    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_two_ints_callback</span>(<span class="hljs-params">self, request, response</span>):        <span class="hljs-variable language_">self</span>.get_logger().info(<span class="hljs-string">f&#x27;Received request: a=<span class="hljs-subst">&#123;request.a&#125;</span>, b=<span class="hljs-subst">&#123;request.b&#125;</span>&#x27;</span>)        response.<span class="hljs-built_in">sum</span> = request.a + request.b        <span class="hljs-variable language_">self</span>.get_logger().info(<span class="hljs-string">f&#x27;Returning response: sum=<span class="hljs-subst">&#123;response.<span class="hljs-built_in">sum</span>&#125;</span>&#x27;</span>)        <span class="hljs-keyword">return</span> response<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">args=<span class="hljs-literal">None</span></span>):    rclpy.init(args=args)    node = AddTwoIntsServer()    rclpy.spin(node)  <span class="hljs-comment"># spin to waiting for requests</span>    node.destroy_node()    rclpy.shutdown()<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    main()</code></pre></div></li><li><p>Client</p></li></ul><div class="code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> rclpy<span class="hljs-keyword">from</span> rclpy.node <span class="hljs-keyword">import</span> Node<span class="hljs-keyword">from</span> example_interfaces.srv <span class="hljs-keyword">import</span> AddTwoInts<span class="hljs-keyword">class</span> <span class="hljs-title class_">AddTwoIntsClient</span>(<span class="hljs-title class_ inherited__">Node</span>):    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):        <span class="hljs-built_in">super</span>().__init__(<span class="hljs-string">&#x27;add_two_ints_client&#x27;</span>)        <span class="hljs-variable language_">self</span>.client = <span class="hljs-variable language_">self</span>.create_client(AddTwoInts, <span class="hljs-string">&#x27;add_two_ints&#x27;</span>)        <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> <span class="hljs-variable language_">self</span>.client.wait_for_service(timeout_sec=<span class="hljs-number">1.0</span>):            <span class="hljs-variable language_">self</span>.get_logger().info(<span class="hljs-string">&#x27;Service not available, waiting...&#x27;</span>)        <span class="hljs-variable language_">self</span>.request = AddTwoInts.Request()        <span class="hljs-variable language_">self</span>.request.a = <span class="hljs-number">5</span>        <span class="hljs-variable language_">self</span>.request.b = <span class="hljs-number">7</span>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_request</span>(<span class="hljs-params">self</span>):        <span class="hljs-variable language_">self</span>.future = <span class="hljs-variable language_">self</span>.client.call_async(<span class="hljs-variable language_">self</span>.request)        rclpy.spin_until_future_complete(<span class="hljs-variable language_">self</span>, <span class="hljs-variable language_">self</span>.future) <span class="hljs-comment"># wait for response</span>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.future.result()<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">args=<span class="hljs-literal">None</span></span>):    rclpy.init(args=args)    node = AddTwoIntsClient()    response = node.send_request()    node.get_logger().info(<span class="hljs-string">f&#x27;Result of addition: <span class="hljs-subst">&#123;response.<span class="hljs-built_in">sum</span>&#125;</span>&#x27;</span>)    node.destroy_node()    rclpy.shutdown()<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:    main()</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>CSE276A</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ROS2</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSE224 - Go OOP</title>
    <link href="/2025/05/30/CSE224/go-oop/"/>
    <url>/2025/05/30/CSE224/go-oop/</url>
    
    <content type="html"><![CDATA[<h2 id="Class">Class</h2><h3 id="Named-Type">Named Type</h3><p>I can create a new named type MyInt that is based on int, but is treated as a distinct type by the compiler.</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> MyInt <span class="hljs-type">int</span></code></pre></div><h3 id="struct-methods">struct + methods</h3><p>Go doesn’t have traditional classes, instead, it uses Custom types + attached methods. As a result, structs in go can hold both data and associated methods. Example:</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Celsius <span class="hljs-type">float64</span><span class="hljs-comment">// This defines a method on the Celsius type.</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(c Celsius)</span></span> ToFahrenheit() <span class="hljs-type">float64</span> &#123;    <span class="hljs-keyword">return</span> <span class="hljs-type">float64</span>(c)*<span class="hljs-number">9</span>/<span class="hljs-number">5</span> + <span class="hljs-number">32</span>  <span class="hljs-comment">// need type convertion</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;    temp := Celsius(<span class="hljs-number">25</span>)    fmt.Println(<span class="hljs-string">&quot;In Fahrenheit:&quot;</span>, temp.ToFahrenheit()) <span class="hljs-comment">// 77</span>&#125;</code></pre></div><p>Another example: User behaves just like a class</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> &#123;    Name <span class="hljs-type">string</span>    Age  <span class="hljs-type">int</span>&#125;<span class="hljs-comment">// This function is like a method defined in a class</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u User)</span></span> Greet() <span class="hljs-type">string</span> &#123;    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello, &quot;</span> + u.Name&#125;</code></pre></div><h3 id="Constructors">Constructors</h3><p>Go does not have built-in constructors. We define a function by ourself as a constructor:</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">NewUser</span><span class="hljs-params">(name <span class="hljs-type">string</span>, age <span class="hljs-type">int</span>)</span></span> User &#123;    <span class="hljs-keyword">return</span> User&#123;Name: name, Age: age&#125;&#125;</code></pre></div><h3 id="Encapsulation">Encapsulation</h3><p>Go doesn’t use public or private keywords like Java or C++. Instead, it uses capitalization to control visibility.</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Account <span class="hljs-keyword">struct</span> &#123;    Owner   <span class="hljs-type">string</span>  <span class="hljs-comment">// Exported, other packages can read/write it.</span>    balance <span class="hljs-type">float64</span> <span class="hljs-comment">// Unexported, only code inside this package can access it.</span>&#125;</code></pre></div><h2 id="Composition">Composition</h2><p>Composition over Inheritance: Go doesn’t have classes or inheritance, but it has composition using embedding.</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Animal <span class="hljs-keyword">struct</span> &#123;    Name <span class="hljs-type">string</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a Animal)</span></span> Speak() &#123;    fmt.Println(a.Name, <span class="hljs-string">&quot;makes a sound&quot;</span>)&#125;<span class="hljs-keyword">type</span> Dog <span class="hljs-keyword">struct</span> &#123;    Animal <span class="hljs-comment">// embedded</span>    Breed <span class="hljs-type">string</span>&#125;<span class="hljs-comment">// Now Dog inherits the Speak() method from Animal.</span>d := Dog&#123;Animal: Animal&#123;Name: <span class="hljs-string">&quot;Buddy&quot;</span>&#125;, Breed: <span class="hljs-string">&quot;Labrador&quot;</span>&#125;d.Speak() <span class="hljs-comment">// Buddy makes a sound</span></code></pre></div><p>By composition, I can resue methods.</p><h3 id="Override">Override</h3><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-comment">// Define a method with the same name on the outer struct, and it will shadow the embedded (override)</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(d Dog)</span></span> Speak() &#123;    fmt.Println(d.Name, <span class="hljs-string">&quot;barks!&quot;</span>)&#125;</code></pre></div><h2 id="Interface-Polymorphism-and-Abstraction">Interface (Polymorphism and Abstraction)</h2><p>An interface in Go is a set of method signatures. <strong>If a type has those methods, it automatically implements the interface</strong>.</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Greeter <span class="hljs-keyword">interface</span> &#123;    Greet() <span class="hljs-type">string</span>&#125;<span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span>&#123;&#125;<span class="hljs-comment">// Person has a Greet() method, so it automatically satisfies the Greeter interface.</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p Person)</span></span> Greet() <span class="hljs-type">string</span> &#123;    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello!&quot;</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sayHello</span><span class="hljs-params">(g Greeter)</span></span> &#123;    <span class="hljs-comment">// any type that has Greet() can be passed as a parameter (Polymorphism)</span>    fmt.Println(g.Greet())&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;    p := Person&#123;&#125;    sayHello(p) <span class="hljs-comment">// Hello!</span>&#125;</code></pre></div><p>If the method is defined on a pointer receiver, only the pointer type implements the interface.</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Greeter <span class="hljs-keyword">interface</span> &#123;    Greet()&#125;<span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> &#123;    Name <span class="hljs-type">string</span>&#125;<span class="hljs-comment">// This means only *Person (pointer) has the method Greet()</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(p *Person)</span></span> Greet() &#123;    fmt.Println(<span class="hljs-string">&quot;Hello, my name is&quot;</span>, p.Name)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;    <span class="hljs-keyword">var</span> g Greeter    p := Person&#123;Name: <span class="hljs-string">&quot;Alice&quot;</span>&#125;    <span class="hljs-comment">// g = p         // ❌ error (p is a Person (value))</span>    g = &amp;p           <span class="hljs-comment">// ✅ &amp;p is a *Person</span>    g.Greet()&#125;</code></pre></div><p>In this example, <code>Person</code> doesn’t implement the interface, but <code>*Person</code> does, so assigning a <code>Person</code> to a <code>Greeter</code> causes an error. (<code>g = &amp;p</code> works)</p>]]></content>
    
    
    <categories>
      
      <category>CSE224</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSE224 - HTTP server</title>
    <link href="/2025/05/21/CSE224/http-server/"/>
    <url>/2025/05/21/CSE224/http-server/</url>
    
    <content type="html"><![CDATA[<h2 id="Required-library-packages">Required library packages</h2><h3 id="Http-package">Http package</h3><p><code>net/http</code>: A standard library package in Go to create and handle web-based communication using the HTTP protocol.</p><ul><li><code>http.HandleFunc(path, handler)</code>: When someone visits path, run the handler function. e.g., <code>http.HandleFunc(&quot;/&quot;, homeHandler)</code></li><li><code>http.ListenAndServe(addr, nil)</code>: Starts the server and listens on a specific address/port. e.g., <code>http.ListenAndServe(&quot;:8080&quot;, nil)</code>, Listen for HTTP requests on port 8080.</li><li><code>func(w http.ResponseWriter, r *http.Request)</code>: This is what handler functions look like.</li></ul><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">greetHandler</span><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;    name := r.URL.Query().Get(<span class="hljs-string">&quot;name&quot;</span>) <span class="hljs-comment">// Reads a query parameter from the URL</span>    <span class="hljs-keyword">if</span> name == <span class="hljs-string">&quot;&quot;</span> &#123;        name = <span class="hljs-string">&quot;Guest&quot;</span>    &#125;    fmt.Fprintf(w, <span class="hljs-string">&quot;Hello, %s!&quot;</span>, name)&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;    http.HandleFunc(<span class="hljs-string">&quot;/&quot;</span>, greetoHandler)    http.ListenAndServe(<span class="hljs-string">&quot;:8080&quot;</span>, <span class="hljs-literal">nil</span>)&#125;</code></pre></div><p>Then visit <code>http://localhost:8080/?name=Alice</code>, and will output: Hello, Alice!</p><ul><li><code>r.URL.Query().Get(&quot;id&quot;)</code>: Reads a query parameter from the URL, like <code>/student?id=Alice</code></li><li><code>r.ParseForm()</code>: Used for reading form data submitted via POST.</li><li><code>name := r.FormValue(&quot;student_name&quot;)</code>: Access form values, gives you the first value for that key.</li><li><code>r.Form[&quot;key&quot;]</code>: gives you all values as a slice ([]string)</li><li><code>http.Redirect(...)</code>: Redirects the browser to another URL after a POST request.</li></ul><h3 id="html-template-package">html/template package</h3><p><code>html/template</code> is a Go standard library package that helps you create HTML pages with dynamic content.</p><ol><li>Define HTML Template</li></ol><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Student Name: &#123;&#123;.Name&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Grade: &#123;&#123;.Grade&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></code></pre></div><ol start="2"><li>Define a go struct</li></ol><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> GradeInfo <span class="hljs-keyword">struct</span> &#123; Name  <span class="hljs-type">string</span> Grade <span class="hljs-type">string</span>&#125;</code></pre></div><ol start="3"><li>Fill the template</li></ol><div class="code-wrapper"><pre><code class="hljs go">tmpl := template.Must(template.ParseFiles(<span class="hljs-string">&quot;gradeinfo.html&quot;</span>))student := GradeInfo&#123;Name: <span class="hljs-string">&quot;Alice&quot;</span>, Grade: <span class="hljs-string">&quot;A+&quot;</span>&#125;tmpl.Execute(w, student)</code></pre></div><p><code>tmpl.Execute(w, students)</code> use template for <code>index.html</code>, fill data from student, dynamically generate a HTML page, and finally write the page to w.</p>]]></content>
    
    
    <categories>
      
      <category>CSE224</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSE224 - Go Concurrent Programming</title>
    <link href="/2025/05/10/CSE224/go-concurrent/"/>
    <url>/2025/05/10/CSE224/go-concurrent/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><h3 id="Go-Routines">Go Routines</h3><p>Traditionally, people used OS-level threads for concurrency, but threads are heavyweight. Go introduced <strong>goroutines</strong>, which are</p><ol><li>Very cheap in terms of memory</li><li>Managed by the Go runtime, not the OS</li><li>Can be created in large numbers</li></ol><p>Go uses an internal scheduler that maps many goroutines onto fewer OS threads using something called the M:N model (many goroutines on few threads). The scheduler runs in user space — no need to ask the operating system every time. As a result, go routines is like a user-level thread.</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">go</span> sayHello() <span class="hljs-comment">// create a go routine</span></code></pre></div><h3 id="Channel">Channel</h3><p>A channel is a way for goroutines to communicate and synchronize with each other. It’s like a pipe.</p><div class="code-wrapper"><pre><code class="hljs go">ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">string</span>)<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;    ch &lt;- <span class="hljs-string">&quot;hello&quot;</span>&#125;()msg := &lt;-chfmt.Println(msg) <span class="hljs-comment">// prints: hello</span></code></pre></div><p>Channels can be synchronous or buffered:</p><ol><li>Synchronous: No buffer. The sender waits until a receiver is ready.</li></ol><div class="code-wrapper"><pre><code class="hljs go">ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>)<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;    fmt.Println(<span class="hljs-string">&quot;Sending...&quot;</span>)    ch &lt;- <span class="hljs-number">42</span>  <span class="hljs-comment">// block until some routine receive data</span>    fmt.Println(<span class="hljs-string">&quot;Sent&quot;</span>)&#125;()x := &lt;-ch  <span class="hljs-comment">// block until some data is available</span>fmt.Println(<span class="hljs-string">&quot;Received&quot;</span>, x)</code></pre></div><ol start="2"><li>Buffered: Has space to hold values. Sender doesn’t wait until buffer is full.</li></ol><div class="code-wrapper"><pre><code class="hljs go">ch := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-type">int</span>, <span class="hljs-number">2</span>)ch &lt;- <span class="hljs-number">1</span>ch &lt;- <span class="hljs-number">2</span><span class="hljs-comment">// Can send twice before it blocks</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>CSE224</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSE224 - RPC</title>
    <link href="/2025/05/08/CSE224/rpc/"/>
    <url>/2025/05/08/CSE224/rpc/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>Remote Procedure Call (RPC) is a way for a program to call a function defined on a different computer as if it were calling a local function.</p><p>Issues:</p><ol><li>A remote machine might use a different language, so it represent data types using different sizes.</li><li>Use a different byte ordering (endianness).</li><li>Have different data alignment requirements.</li><li>Represent floating point numbers differently.</li></ol><h3 id="Interface-Description-Language-IDL">Interface Description Language (IDL)</h3><p>Mechanism to pass procedure parameters and return values in a machine and language independent way.</p><h4 id="Protobuf">Protobuf</h4><p>Protocol Buffers (protobuf) is a language-neutral format for defining structured data by gPRC.</p><div class="code-wrapper"><pre><code class="hljs abnf"><span class="hljs-attribute">syntax</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;proto3&quot;</span><span class="hljs-comment">;</span>message NumberEntry &#123;    int64 ts <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-comment">;</span>    int32 number <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-comment">;</span>&#125;service NumberService &#123;    rpc SendNumber(NumberEntry) returns (Ack)<span class="hljs-comment">;</span>&#125;message Ack &#123;    string status <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-comment">;</span>&#125;</code></pre></div><p><code>.proto</code> file defines</p><ol><li>Service APIs (rpc methods)</li><li>Message formats</li></ol><p>Then run <code>protoc --go_out=. --go-grpc_out=. your_file.proto</code> will generate</p><ol><li>Client stub code (for calling SendNumber)</li><li>Server stub code (for implementing SendNumber)</li><li>Marshalling code (for turning NumberEntry into bytes and back)</li></ol><h3 id="Workflow">Workflow</h3><ol><li>Client calls stub function</li><li>Stub marshals parameters to a network message</li><li>OS sends a network message to the server</li><li>Server OS receives message, sends it up to stub</li><li>Server stub unmarshals params, calls server function</li><li>Server function runs, returns a value</li><li>Server stub marshals the return value, sends msg</li><li>Server OS sends the reply back across the network</li><li>Client OS receives the reply and passes up to stub</li><li>Client stub unmarshals return value, returns to client</li></ol><h2 id="Example">Example</h2><p>Building a Replicated KV Store:</p><ol><li>To run the system, run the code in each node machine.</li><li>Each node is both a server and a client, server is run by a go routine, client is also run by a go routine.</li><li>The server code listens to rpc calls from other nodes</li><li>The client code interprets commands, and handle the command by sending rpc</li></ol><h3 id="Define-the-proto-file">Define the proto file:</h3><div class="code-wrapper"><pre><code class="hljs proto">syntax = <span class="hljs-string">&quot;proto3&quot;</span>;<span class="hljs-keyword">package</span> rkvs;<span class="hljs-comment">// tells the protobuf compiler where to put the generated Go code</span><span class="hljs-keyword">option</span> go_package = <span class="hljs-string">&quot;/proto;pb&quot;</span>; <span class="hljs-comment">// here, the package will be called pb in the /proto directory</span><span class="hljs-comment">// service defines a set of remote procedures (functions) that can be called over the network.</span><span class="hljs-keyword">service </span><span class="hljs-title class_">RKVSService</span> &#123;    <span class="hljs-function"><span class="hljs-keyword">rpc</span> Replicate (ReplicateRequest) <span class="hljs-keyword">returns</span> (ReplicateResponse)</span>;    <span class="hljs-function"><span class="hljs-keyword">rpc</span> Stop (StopRequest) <span class="hljs-keyword">returns</span> (StopResponse)</span>;&#125;<span class="hljs-comment">// A message is what you send or what you receive in a network call.</span><span class="hljs-keyword">message </span><span class="hljs-title class_">ReplicateRequest</span> &#123;    <span class="hljs-type">string</span> key = <span class="hljs-number">1</span>;    <span class="hljs-type">string</span> value = <span class="hljs-number">2</span>;&#125;<span class="hljs-keyword">message </span><span class="hljs-title class_">ReplicateResponse</span>&#123;&#125;<span class="hljs-keyword">message </span><span class="hljs-title class_">StopRequest</span>&#123;&#125;<span class="hljs-keyword">message </span><span class="hljs-title class_">StopResponse</span>&#123;&#125;</code></pre></div><p>Then, <code>protoc --go_out=. --go-grpc_out=. rkvs.proto</code> will generate a pb package with:</p><ol><li>RKVSServiceServer interface for the server to implement</li></ol><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> RKVSServiceServer <span class="hljs-keyword">interface</span> &#123; Replicate(context.Context, *ReplicateRequest) (*ReplicateResponse, <span class="hljs-type">error</span>)  Stop(context.Context, *StopRequest) (*StopResponse, <span class="hljs-type">error</span>) mustEmbedUnimplementedRKVSServiceServer()&#125;</code></pre></div><ol start="2"><li>RKVSServiceClient for calling remote methods</li></ol><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> RKVSServiceClient <span class="hljs-keyword">interface</span> &#123;  Replicate(ctx context.Context, in *ReplicateRequest, opts ...grpc.CallOption) (*ReplicateResponse, <span class="hljs-type">error</span>)  Stop(ctx context.Context, in *StopRequest, opts ...grpc.CallOption) (*StopResponse, <span class="hljs-type">error</span>)&#125;</code></pre></div><h3 id="Implement-the-gRPC-Server-in-Go">Implement the gRPC Server in Go:</h3><p>After defining a service, we need to implement rpc functions.</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-comment">// struct server implements the RPC methods from your .proto file: Replicate and Stop</span><span class="hljs-keyword">type</span> server <span class="hljs-keyword">struct</span> &#123;    pb.UnimplementedRKVSServiceServer <span class="hljs-comment">// This is part of the Go code auto-generated from your .proto file.</span>    state  <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>    peers  []<span class="hljs-type">string</span>    stopCh <span class="hljs-keyword">chan</span> <span class="hljs-keyword">struct</span>&#123;&#125;&#125;<span class="hljs-comment">// Implementing the Replicate RPC</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *server)</span></span> Replicate(ctx context.Context, req *pb.ReplicateRequest) (*pb.ReplicateResponse, <span class="hljs-type">error</span>) &#123;    s.state[req.Key] = req.Value    <span class="hljs-keyword">return</span> &amp;pb.ReplicateResponse&#123;&#125;, <span class="hljs-literal">nil</span>&#125;<span class="hljs-comment">// Implementing the Stop RPC</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *server)</span></span> Stop(ctx context.Context, req *pb.StopRequest) (*pb.StopResponse, <span class="hljs-type">error</span>) &#123;    s.stopCh &lt;- <span class="hljs-keyword">struct</span>&#123;&#125;&#123;&#125;    <span class="hljs-keyword">return</span> &amp;pb.StopResponse&#123;&#125;, <span class="hljs-literal">nil</span>&#125;</code></pre></div><p><code>pb.UnimplementedRKVSServiceServer</code>: It contains default (empty) implementations of all the methods declared in your .proto file. Since your server struct must implement all methods defined in the .proto file’s service section to satisfy the RKVSServiceServer interface. But often, you only want to implement some of them. So when you include <code>pb.UnimplementedRKVSServiceServer</code>, your struct now inherits those defaults, and you only need to override the ones you care about.</p><h3 id="Start-the-gRPC-Server">Start the gRPC Server</h3><div class="code-wrapper"><pre><code class="hljs go">grpcServer := grpc.NewServer()pb.RegisterRKVSServiceServer(grpcServer, s) <span class="hljs-comment">// s is an object that implements all the methods of RKVSServiceServer</span>lis, err := net.Listen(<span class="hljs-string">&quot;tcp&quot;</span>, addr)<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    log.Fatalf(<span class="hljs-string">&quot;Failed to listen: %v&quot;</span>, err)&#125;log.Printf(<span class="hljs-string">&quot;Listening on %s&quot;</span>, addr)grpcServer.Serve(lis) <span class="hljs-comment">// Starts the main server loop</span></code></pre></div><h3 id="Make-gRPC-Requests-as-a-Client">Make gRPC Requests as a Client</h3><div class="code-wrapper"><pre><code class="hljs go">conn, err := grpc.NewClient(peerAddr, grpc.WithTransportCredentials(insecure.NewCredentials())) <span class="hljs-comment">// create a connection to server</span><span class="hljs-keyword">defer</span> conn.Close()client := pb.NewRKVSServiceClient(conn) <span class="hljs-comment">// create a client stub</span>_, err = client.Replicate(context.Background(), &amp;pb.ReplicateRequest&#123;Key: <span class="hljs-string">&quot;foo&quot;</span>, Value: <span class="hljs-string">&quot;bar&quot;</span>&#125;)</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>CSE224</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
      <tag>RPC</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSE224 - Go I/O</title>
    <link href="/2025/04/29/CSE224/go-io/"/>
    <url>/2025/04/29/CSE224/go-io/</url>
    
    <content type="html"><![CDATA[<h2 id="Read-and-Write-binary-files">Read and Write binary files</h2><p>Go follows the Reader/Writer interface model:</p><ol><li>io.Reader:  Can read data (Read([]byte) (int, error))</li><li>io.Writer:  Can write data (Write([]byte) (int, error))</li></ol><p>Most I/O types (files, TCP connections, buffers) implement these interfaces.</p><h3 id="I-O-types">I/O types</h3><div class="code-wrapper"><pre><code class="hljs go">file, _ := os.Open(<span class="hljs-string">&quot;hello.txt&quot;</span>) <span class="hljs-comment">// *os.File, used when read/write to files.</span>conn, _ := net.Dial(<span class="hljs-string">&quot;tcp&quot;</span>, <span class="hljs-string">&quot;example.com:80&quot;</span>)  <span class="hljs-comment">// net.Conn, </span>r := strings.NewReader(<span class="hljs-string">&quot;hello world&quot;</span>) <span class="hljs-comment">// *strings.Reader</span>r := bufio.NewReader(strings.NewReader(<span class="hljs-string">&quot;hello\nworld&quot;</span>)) <span class="hljs-comment">// bufio.Reader, wraps any io.Reader to add buffering and helper methods like ReadLine(), ReadString(&#x27;\n&#x27;), etc.</span></code></pre></div><p>All above implements both io.Reader and io.Writer.</p><h3 id="Read-a-binary-file">Read a binary file</h3><p>Open a file:</p><div class="code-wrapper"><pre><code class="hljs go">file, err := os.Open(<span class="hljs-string">&quot;file.bin&quot;</span>)<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    log.Fatal(err)&#125;<span class="hljs-keyword">defer</span> file.Close()</code></pre></div><p>Read specific number of bytes</p><div class="code-wrapper"><pre><code class="hljs go">buf := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, <span class="hljs-number">8</span>) <span class="hljs-comment">// read 8 bytes</span>_, err := file.Read(buf)<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    log.Fatal(err)&#125;</code></pre></div><ul><li><code>n, err := file.Read(buf)</code>: Read to a slice of bytes, returns actual number of bytes read, may read less than you ask for, even though there’s more data available later. <strong>It blocks until at least some bytes are ready to be read.</strong></li><li><code>n, err := io.ReadFull(reader, buf)</code>: Reads exactly len(buf) bytes, blocking until buffer is full or EOF.</li><li><code>data, err := io.ReadAll(reader)</code>: Reads entire stream until EOF into memory (until I receive EOF).</li><li><code>data, err := os.ReadFile(filePath)</code>: os.ReadFile is a convenience function that: Opens a file, Reads all of its contents into memory, Closes the file, Returns the file contents as a []byte.</li></ul><p>Read and convert</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">var</span> num <span class="hljs-type">int32</span>err := binary.Read(file, binary.LittleEndian, &amp;num)<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    log.Fatal(err)&#125;fmt.Println(<span class="hljs-string">&quot;Read int32:&quot;</span>, num)</code></pre></div><ul><li><code>err := binary.Read()</code>: A high-level function from encoding/binary, read and then convert</li></ul><h3 id="Write-a-binary-file">Write a binary file</h3><p>Create a binary file</p><div class="code-wrapper"><pre><code class="hljs go">file, err := os.Create(<span class="hljs-string">&quot;data.bin&quot;</span>)<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    log.Fatal(err)&#125;<span class="hljs-keyword">defer</span> file.Close()</code></pre></div><div class="code-wrapper"><pre><code class="hljs go">data := []<span class="hljs-type">byte</span>(<span class="hljs-string">&quot;Hello, binary world!\n&quot;</span>)n, err := file.Write(data)<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    log.Fatal(err)&#125;</code></pre></div><ul><li><code>n, err := writer.Write(data)</code>: Writes len(data) bytes, returns how many were actually written (should be all, or an error).</li><li><code>error := os.WriteFile(name string, data []byte, perm fs.FileMode)</code>: writes data to a file in one shot</li></ul><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">var</span> number <span class="hljs-type">uint32</span> = <span class="hljs-number">123456</span>err = binary.Write(file, binary.LittleEndian, number)<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    log.Fatal(err)&#125;</code></pre></div><h3 id="Communicate-via-network">Communicate via network</h3><p>When you call <code>conn.Write(data)</code> in Go (e.g., using a TCP connection), you’re not directly writing data onto the network wire. Instead, your data is copied into the OS’s send buffer. The OS then takes care of delivering that data over the network asynchronously.</p><p>When you call <code>conn.Read(buffer)</code>, you’re trying to read data from the OS’s receive buffer. If no data is available yet, <code>Read()</code> will block (wait) until some data is available.</p><h2 id="Client-and-Server">Client and Server</h2><p>Server:</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> (  <span class="hljs-string">&quot;fmt&quot;</span>  <span class="hljs-string">&quot;net&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123; <span class="hljs-comment">// Start listening on TCP port 9000</span> listener, err := net.Listen(<span class="hljs-string">&quot;tcp&quot;</span>, <span class="hljs-string">&quot;127.0.0.1:9000&quot;</span>)  <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    fmt.Println(<span class="hljs-string">&quot;Error starting server:&quot;</span>, err)   <span class="hljs-keyword">return</span>  &#125;  <span class="hljs-keyword">defer</span> listener.Close()  fmt.Println(<span class="hljs-string">&quot;Server is listening on 127.0.0.1:9000&quot;</span>) <span class="hljs-keyword">for</span> &#123;    conn, err := listener.Accept()    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;      fmt.Println(<span class="hljs-string">&quot;Failed to accept connection:&quot;</span>, err)     <span class="hljs-keyword">continue</span>    &#125;    <span class="hljs-keyword">go</span> handleConnection(conn) <span class="hljs-comment">// Handle each connection concurrently</span>  &#125;&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">handleConnection</span><span class="hljs-params">(conn net.Conn)</span></span> &#123; <span class="hljs-keyword">defer</span> conn.Close()  buffer := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, <span class="hljs-number">1024</span>) <span class="hljs-comment">// Create a buffer to hold incoming data</span>  n, err := conn.Read(buffer) <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    fmt.Println(<span class="hljs-string">&quot;Failed to read data:&quot;</span>, err)   <span class="hljs-keyword">return</span>  &#125;  message := <span class="hljs-type">string</span>(buffer[:n])  fmt.Printf(<span class="hljs-string">&quot;Received message: %s\n&quot;</span>, message)  <span class="hljs-comment">// Send a response back</span> response := <span class="hljs-string">&quot;Hello Client! I got your message: &quot;</span> + message conn.Write([]<span class="hljs-type">byte</span>(response))&#125;</code></pre></div><p>Client:</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> (  <span class="hljs-string">&quot;fmt&quot;</span>  <span class="hljs-string">&quot;net&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123; <span class="hljs-comment">// Connect to the server</span>  conn, err := net.Dial(<span class="hljs-string">&quot;tcp&quot;</span>, <span class="hljs-string">&quot;127.0.0.1:9000&quot;</span>)  <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    fmt.Println(<span class="hljs-string">&quot;Error connecting to server:&quot;</span>, err)    <span class="hljs-keyword">return</span>  &#125;  <span class="hljs-keyword">defer</span> conn.Close()  <span class="hljs-comment">// Send a message</span> message := <span class="hljs-string">&quot;Hello Server!&quot;</span> _, err = conn.Write([]<span class="hljs-type">byte</span>(message)) <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    fmt.Println(<span class="hljs-string">&quot;Failed to send message:&quot;</span>, err)    <span class="hljs-keyword">return</span>  &#125;  <span class="hljs-comment">// Read the response</span>  buffer := <span class="hljs-built_in">make</span>([]<span class="hljs-type">byte</span>, <span class="hljs-number">1024</span>) n, err := conn.Read(buffer) <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;    fmt.Println(<span class="hljs-string">&quot;Failed to read response:&quot;</span>, err)   <span class="hljs-keyword">return</span>  &#125;  response := <span class="hljs-type">string</span>(buffer[:n]) fmt.Printf(<span class="hljs-string">&quot;Server replied: %s\n&quot;</span>, response)&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>CSE224</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CSE224 - Go Basis</title>
    <link href="/2025/04/03/CSE224/go-basis/"/>
    <url>/2025/04/03/CSE224/go-basis/</url>
    
    <content type="html"><![CDATA[<h2 id="How-to-create-a-go-project">How to create a go project</h2><ol><li><p><code>mkdir myapp</code>, <code>cd myapp</code></p></li><li><p>create a module: <code>go mod init github.com/yourname/myapp</code>, then go will generate a <code>go.mod</code> file inside.</p></li><li><p>create <code>main.go</code>:</p></li></ol><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> (    <span class="hljs-string">&quot;fmt&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;    fmt.Println(<span class="hljs-string">&quot;Hello, Module!&quot;</span>)&#125;</code></pre></div><p>execute <code>go run main.go</code> to run it.</p><ol start="4"><li>add dependencies:</li></ol><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> (    <span class="hljs-string">&quot;fmt&quot;</span>    <span class="hljs-string">&quot;[github.com/google/uuid](https://github.com/google/uuid)&quot;</span>)<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;    id := uuid.New()    fmt.Println(<span class="hljs-string">&quot;Generated UUID:&quot;</span>, id)&#125;</code></pre></div><p>after I execute <code>go run main.go</code>, go will download <code>github.com/google/uuid</code> and add <code>require github.com/google/uuid v1.3.1</code> to <code>go.mod</code> config file.</p><h3 id="Packages">Packages</h3><div class="code-wrapper"><pre><code class="hljs xl">myproject/│├── <span class="hljs-function"><span class="hljs-title">go</span>.<span class="hljs-built_in">mod</span>              -&gt;</span> <span class="hljs-built_in">mod</span> file├── <span class="hljs-function"><span class="hljs-title">main</span>.go             -&gt;</span> package main├── utils/│   └── <span class="hljs-function"><span class="hljs-title">math</span>.go         -&gt;</span> package utils├── service/│   └── <span class="hljs-function"><span class="hljs-title">handler</span>.go      -&gt;</span> package service</code></pre></div><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-comment">// main.go</span><span class="hljs-keyword">package</span> main<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;myapp/utils&quot;</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;    <span class="hljs-built_in">println</span>(utils.SayHi())&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-comment">// utils/helper.go</span><span class="hljs-keyword">package</span> utils<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">SayHi</span><span class="hljs-params">()</span></span> <span class="hljs-type">string</span> &#123;    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hi&quot;</span>&#125;</code></pre></div><ol><li>Each <code>.go</code> file must have <code>package xxx</code></li><li>A module usually have many packages.</li><li>Each folder must have one package.</li><li>Can import between packages.</li><li><strong>Functions can freely call each other as long as they’re defined in the same package (even if they are in different files)</strong>.</li><li>In a Go project, the entry point is always the main package, specifically the main() function inside it. When I run <code>go build</code>, Go will look for <code>package main</code> and <code>func main()</code>, and then compiles all dependencies recursively together into a single executable.</li><li>A module can have multiple main packages, each in a different subdirectory. Each main.go here is its own entry point, and Go builds them into separate executables.</li></ol><div class="code-wrapper"><pre><code class="hljs stylus">mytool/              ← module├── go<span class="hljs-selector-class">.mod</span>├── cmd/│   ├── server/│   │   └── <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.go</span>   ← package <span class="hljs-selector-tag">main</span> (binary <span class="hljs-number">1</span>)│   └── cli/│       └── <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.go</span>   ← package <span class="hljs-selector-tag">main</span> (binary <span class="hljs-number">2</span>)├── internal/│   └── logic<span class="hljs-selector-class">.go</span>      ← package internal (shared code)</code></pre></div><h2 id="Value-Type">Value Type</h2><p>Assigning it to a new variable, or passing it to a function, creates a copy of the value.</p><ol><li>Basic types:  int, float64, bool, string</li><li>Arrays: [3]int, [5]byte</li><li>Structs:  type Point struct {x, y int}</li><li>Custom types: type MyInt int</li></ol><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Point <span class="hljs-keyword">struct</span> &#123;    X, Y <span class="hljs-type">int</span>&#125;p1 := Point&#123;X: <span class="hljs-number">1</span>, Y: <span class="hljs-number">2</span>&#125;p2 := p1 <span class="hljs-comment">// Copy of p1</span>p2.X = <span class="hljs-number">100</span>fmt.Println(p1.X) <span class="hljs-comment">// 1 — unchanged</span>fmt.Println(p2.X) <span class="hljs-comment">// 100 — only p2 changed</span></code></pre></div><h2 id="Pointer-Type">Pointer Type</h2><p>The following are pointer types:</p><ol><li>slice</li></ol><div class="code-wrapper"><pre><code class="hljs go">a := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;b := ab[<span class="hljs-number">0</span>] = <span class="hljs-number">99</span>fmt.Println(a[<span class="hljs-number">0</span>]) <span class="hljs-comment">// 99</span></code></pre></div><ol start="2"><li>map</li><li>channel</li><li>function</li><li>interface</li></ol><h2 id="Basic-Syntax">Basic Syntax</h2><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">var</span> x <span class="hljs-type">int</span> = <span class="hljs-number">42</span>z := <span class="hljs-number">3.14</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">add</span><span class="hljs-params">(a <span class="hljs-type">int</span>, b <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;    <span class="hljs-keyword">return</span> a + b&#125;<span class="hljs-keyword">type</span> Person <span class="hljs-keyword">struct</span> &#123;    Name <span class="hljs-type">string</span>    Age  <span class="hljs-type">int</span>&#125;p := Person&#123;Name: <span class="hljs-string">&quot;Alice&quot;</span>, Age: <span class="hljs-number">30</span>&#125;fmt.Println(p.Name)</code></pre></div><h2 id="Array-and-Slices">Array and Slices</h2><h3 id="Array">Array:</h3><p>Arrays are value types, so <code>[3]int</code> is not compatible with <code>[4]int</code>.</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">var</span> arr [<span class="hljs-number">3</span>]<span class="hljs-type">int</span> <span class="hljs-comment">// array of 3 integers, all initialized to 0</span>b := [<span class="hljs-number">3</span>]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>&#125;         <span class="hljs-comment">// initialized with values</span>c := [...]<span class="hljs-type">int</span>&#123;<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>&#125;    <span class="hljs-comment">// size inferred to be 4</span>a[<span class="hljs-number">0</span>] = <span class="hljs-number">42</span>  <span class="hljs-comment">// mutation</span></code></pre></div><h3 id="Slices">Slices</h3><p>A slice is a flexible, powerful view into an underlying array. It lets you work with sequences that can grow, shrink, or share memory</p><p>A slice is a struct with three fields:</p><ol><li>A pointer to the underlying array</li><li>A length (number of visible elements)</li><li>A capacity (maximum number of elements before reallocation) (cap(t) = number of elements from (start of the slice) to end of the backing array.)</li></ol><h4 id="Slice-creation">Slice creation:</h4><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-comment">// 1. From an array</span>arr := [<span class="hljs-number">5</span>]<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;s := arr[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>] <span class="hljs-comment">// slice of [2, 3, 4]</span><span class="hljs-comment">// 2. Using a literal</span>s := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>&#125;<span class="hljs-comment">// 3. Using make</span>s := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">3</span>)         <span class="hljs-comment">// length 3, capacity 3</span>s := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>)      <span class="hljs-comment">// length 2, capacity 5</span></code></pre></div><h4 id="Slice-internals">Slice internals:</h4><div class="code-wrapper"><pre><code class="hljs go">s := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;t := s[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>] <span class="hljs-comment">// t = [2, 3, 4], length = 3, capacity = 4</span></code></pre></div><h4 id="Modification">Modification</h4><div class="code-wrapper"><pre><code class="hljs go">s := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>&#125;t := s[<span class="hljs-number">1</span>:<span class="hljs-number">4</span>] <span class="hljs-comment">// [2 3 4]</span>fmt.Println(<span class="hljs-built_in">len</span>(t)) <span class="hljs-comment">// 3</span>fmt.Println(<span class="hljs-built_in">cap</span>(t)) <span class="hljs-comment">// 4</span><span class="hljs-comment">// t and s points to the same array</span>t = <span class="hljs-built_in">append</span>(t, <span class="hljs-number">99</span>)   <span class="hljs-comment">// still fits in capacity, modifies s[4]!</span>fmt.Println(s)      <span class="hljs-comment">// [1 2 3 4 99]</span></code></pre></div><p>Append:<br>If there’s enough capacity, append extends the existing array. Otherwise, it allocates a new backing array.</p><div class="code-wrapper"><pre><code class="hljs go">s := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">2</span>&#125;s = <span class="hljs-built_in">append</span>(s, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>) <span class="hljs-comment">// s = [1, 2, 3, 4]</span></code></pre></div><h2 id="Pointers">Pointers</h2><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">var</span> x <span class="hljs-type">int</span> = <span class="hljs-number">10</span><span class="hljs-keyword">var</span> px *<span class="hljs-type">int</span> = &amp;x <span class="hljs-comment">// px holds the address of x</span>*px = <span class="hljs-number">20</span> <span class="hljs-comment">// sets x to 20 through the pointer</span><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">modify</span><span class="hljs-params">(n *<span class="hljs-type">int</span>)</span></span> &#123;    *n = <span class="hljs-number">42</span>&#125;<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;    a := <span class="hljs-number">10</span>    modify(&amp;a)         <span class="hljs-comment">// pass address of a</span>    fmt.Println(a)     <span class="hljs-comment">// 42</span>&#125;</code></pre></div><h2 id="Loop">Loop</h2><p>There is no <code>while</code> keyword in Go.</p><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++ &#123;    fmt.Println(i)&#125;i := <span class="hljs-number">0</span><span class="hljs-keyword">for</span> i &lt; <span class="hljs-number">5</span> &#123;    fmt.Println(i)    i++&#125;<span class="hljs-comment">// Infinite loop</span><span class="hljs-keyword">for</span> &#123;    fmt.Println(<span class="hljs-string">&quot;This will run forever unless you break it&quot;</span>)&#125;<span class="hljs-comment">// Looping over collections </span><span class="hljs-comment">// range returns two stuffs: index and value. index and value are declared and initialized automatically by the Go compiler as part of the loop syntax.</span>nums := []<span class="hljs-type">int</span>&#123;<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>&#125;<span class="hljs-keyword">for</span> index, value := <span class="hljs-keyword">range</span> nums &#123;    fmt.Println(<span class="hljs-string">&quot;Index:&quot;</span>, index, <span class="hljs-string">&quot;Value:&quot;</span>, value)&#125;<span class="hljs-keyword">for</span> _, value := <span class="hljs-keyword">range</span> nums &#123;    fmt.Println(Value:<span class="hljs-string">&quot;, value)</span><span class="hljs-string">&#125;</span></code></pre></div><h2 id="Map">Map</h2><p>Create a map:</p><div class="code-wrapper"><pre><code class="hljs go">ages := <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">int</span>&#123;    <span class="hljs-string">&quot;Alice&quot;</span>: <span class="hljs-number">25</span>,    <span class="hljs-string">&quot;Bob&quot;</span>:   <span class="hljs-number">30</span>,&#125;colors := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>)colors[<span class="hljs-string">&quot;red&quot;</span>] = <span class="hljs-string">&quot;#FF0000&quot;</span>colors[<span class="hljs-string">&quot;green&quot;</span>] = <span class="hljs-string">&quot;#00FF00&quot;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-comment">// Iterate a map:</span><span class="hljs-keyword">for</span> name, age := <span class="hljs-keyword">range</span> ages &#123;  fmt.Printf(<span class="hljs-string">&quot;%s %d\n&quot;</span>, name, age)&#125;<span class="hljs-comment">// Check if exists:</span><span class="hljs-comment">// ok is a boolean indicating whether the key exists in the map</span>age, ok := ages[<span class="hljs-string">&quot;Alice&quot;</span>]<span class="hljs-keyword">if</span> ok &#123;    fmt.Println(<span class="hljs-string">&quot;Found:&quot;</span>, age)&#125; <span class="hljs-keyword">else</span> &#123;    fmt.Println(<span class="hljs-string">&quot;Not found&quot;</span>)&#125;<span class="hljs-comment">// delete a key</span><span class="hljs-built_in">delete</span>(ages, <span class="hljs-string">&quot;Bob&quot;</span>)</code></pre></div><h2 id="Function-as-parameters">Function as parameters</h2><div class="code-wrapper"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">apply</span><span class="hljs-params">(fn <span class="hljs-keyword">func</span>(<span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span>, val <span class="hljs-type">int</span>) <span class="hljs-type">int</span> &#123; <span class="hljs-keyword">return</span> fn(val)&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>CSE224</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Go</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Stanford CS142 笔记 - Express.js</title>
    <link href="/2024/11/26/CS142/expressjs/"/>
    <url>/2024/11/26/CS142/expressjs/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<span class="hljs-keyword">let</span> expressApp = <span class="hljs-title function_">express</span>();</code></pre></div><p>The instance <code>expressAPP</code> provides all the methods to:</p><ol><li>Route HTTP requests (map different URLs to different logic)</li><li>Render HTML</li><li>Configure middleware (Middleware are functions that process requests before they reach routes)</li></ol><h3 id="Express-Routing">Express Routing</h3><p>Routing allows you to define actions for specific HTTP methods:</p><div class="code-wrapper"><pre><code class="hljs javascript">expressApp.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/path&#x27;</span>, callback);expressApp.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/path&#x27;</span>, callback);expressApp.<span class="hljs-title function_">put</span>(<span class="hljs-string">&#x27;/path&#x27;</span>, callback);expressApp.<span class="hljs-title function_">delete</span>(<span class="hljs-string">&#x27;/path&#x27;</span>, callback);expressApp.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/path&#x27;</span>, callback); <span class="hljs-comment">// Handles requests for all HTTP methods (e.g., GET, POST, etc.) on a specific path.</span>expressApp.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/:user_id&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">`User ID is <span class="hljs-subst">$&#123;req.params.user_id&#125;</span>`</span>);&#125;);</code></pre></div><p>The order of execution in Express routes is determined by the order in which they are defined in your code. Here’s the principle:</p><ul><li>When a request is received, Express evaluates routes from top to bottom in the order they are defined in the code.</li><li>It stops at the first match it finds (this is called short-circuiting).</li></ul><h4 id="httpRequest-Object">httpRequest Object</h4><p>It represents the HTTP request sent by the client.</p><ul><li><code>request.params</code>: Access route parameters</li></ul><div class="code-wrapper"><pre><code class="hljs javascript">expressApp.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/:user_id&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(req.<span class="hljs-property">params</span>.<span class="hljs-property">user_id</span>); <span class="hljs-comment">// Logs the user_id</span>&#125;);</code></pre></div><ul><li><code>request.query</code>: Contains query string parameters from the URL</li></ul><div class="code-wrapper"><pre><code class="hljs javascript">expressApp.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/search&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(req.<span class="hljs-property">query</span>); <span class="hljs-comment">// &#123; foo: &#x27;9&#x27; &#125; ?foo=9 becomes &#123;foo: &#x27;9&#x27;&#125;</span>&#125;);</code></pre></div><ul><li><code>request.body</code>: Contains the body of POST or PUT requests</li></ul><h4 id="httpResponse-Object">httpResponse Object</h4><p>Represents the response sent back to the client.</p><ul><li><code>response.send(content)</code>: Sends a response to the client (automatically ends the response). e.g., <code>res.send('Hello, world!');</code>.</li><li><code>response.status(code)</code>: Sets the HTTP status code of the response. e.g., <code>res.status(404).send('Not Found');</code>.</li><li><code>response.set(field, value)</code>: Sets a custom HTTP response header.</li><li><code>response.end()</code>: Ends the response process.</li><li>channing: e.g., <code>res.status(200).send('OK');</code></li></ul><p>Example Usage:</p><div class="code-wrapper"><pre><code class="hljs javascript">app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/:id&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> &#123;  <span class="hljs-keyword">let</span> id = request.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>;  <span class="hljs-keyword">let</span> user = cs142models.<span class="hljs-title function_">userModel</span>(id);  <span class="hljs-keyword">if</span> (user === <span class="hljs-literal">null</span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;User with _id:&#x27;</span> + id + <span class="hljs-string">&#x27; not found.&#x27;</span>);    response.<span class="hljs-title function_">status</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Not found&#x27;</span>);    <span class="hljs-keyword">return</span>;  &#125;  response.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">send</span>(user);  <span class="hljs-keyword">return</span>;&#125;);</code></pre></div><h3 id="Middleware">Middleware</h3><p>Middleware are functions that can:</p><ol><li>Intercept HTTP requests.</li><li>Perform operations on the request/response objects.</li><li>Either terminate the request-response cycle or pass control to the next middleware in the stack using next().</li></ol><div class="code-wrapper"><pre><code class="hljs javascript">app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/specific-route&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Middleware for /specific-route&#x27;</span>);  <span class="hljs-title function_">next</span>(); <span class="hljs-comment">// Pass control to the next handler or middleware</span>&#125;);</code></pre></div><ul><li><code>app.all()</code>: Matches all HTTP methods for the route.</li></ul><div class="code-wrapper"><pre><code class="hljs javascript">app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Global Middleware&#x27;</span>);  <span class="hljs-title function_">next</span>();&#125;);</code></pre></div><ul><li><code>app.use()</code>: Registers middleware for all routes.</li></ul><p>e.g., <code>app.use(express.json());</code>, Use built-in middleware for parsing JSON.</p>]]></content>
    
    
    <categories>
      
      <category>CS142</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Stanford CS142 笔记 - Node.js</title>
    <link href="/2024/10/30/CS142/nodejs/"/>
    <url>/2024/10/30/CS142/nodejs/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>Node.js is an open-source, cross-platform JavaScript runtime environment that executes JavaScript code outside of a web browser.</p><ul><li>Single-Threaded Event Loop: Node.js uses a single-threaded event loop. The Event Loop continuously checks the event queue to see if there are any events to be handled.</li><li>Non-blocking I/O: Node.js performs I/O operations (like reading from a database or reading from a file) asynchronously. Instead of waiting for the operation to complete, Node.js registers a callback and moves on to handle the next event. This non-blocking behavior ensures that Node.js can handle many I/O operations concurrently without getting bogged down by slow operations</li></ul><h2 id="Module-System">Module System</h2><ul><li><p><code>require</code> is a function in Node.js used to load modules. We use <code>Express</code> and <code>Mongoose</code> for web development.</p><ul><li>System modules: Built-in Node.js modules like fs, http, path, etc.</li><li>File modules: Like <code>require(&quot;./myModule.js&quot;)</code></li><li>Directory modules: Like <code>require(&quot;./myModule&quot;)</code>, look for <code>myModule/index.js</code></li></ul></li><li><p>In Node.js, every module (or file) has its own scope, module.exports allows us to make functions or variables available to other files.</p></li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> notGlobal;<span class="hljs-keyword">function</span> <span class="hljs-title function_">func1</span>(<span class="hljs-params"></span>) &#123;&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">func2</span>(<span class="hljs-params"></span>) &#123;&#125;<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<span class="hljs-attr">func1</span>: func1, <span class="hljs-attr">func2</span>: func2&#125;;</code></pre></div><h2 id="Non-blocking">Non-blocking</h2><div class="code-wrapper"><pre><code class="hljs javascript">r1 = <span class="hljs-title function_">step1</span>();<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;step1 done&#x27;</span>, r1);r2 = <span class="hljs-title function_">step2</span>(r1);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;step2 done&#x27;</span>, r2);r3 = <span class="hljs-title function_">step3</span>(r2);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;step3 done&#x27;</span>, r3);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;All Done!&#x27;</span>);</code></pre></div><p>If <code>step()</code> function doesn’t block, then it’s ok.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">step1</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">r1</span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;step1 done&#x27;</span>, r1);    <span class="hljs-title function_">step2</span>(r1, <span class="hljs-keyword">function</span> (<span class="hljs-params">r2</span>) &#123;        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;step2 done&#x27;</span>, r2);        <span class="hljs-title function_">step3</span>(r2, <span class="hljs-keyword">function</span> (<span class="hljs-params">r3</span>) &#123;            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;step3 done&#x27;</span>, r3);            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;All Done!&#x27;</span>);  <span class="hljs-comment">// Correct</span>        &#125;);    &#125;);&#125;);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;All Done!&#x27;</span>); <span class="hljs-comment">// Wrong!</span></code></pre></div><p>If the function is blocking, use callbacks.</p><h2 id="Listener-and-Emitter">Listener and Emitter</h2><div class="code-wrapper"><pre><code class="hljs javascript">myEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;myEvent&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">param1, param2</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;myEvent occurred with &#x27;</span> + param1 + <span class="hljs-string">&#x27; and &#x27;</span> + param2 + <span class="hljs-string">&#x27;!&#x27;</span>);&#125;);myEmitter.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&#x27;myEvent&#x27;</span>, <span class="hljs-string">&#x27;arg1&#x27;</span>, <span class="hljs-string">&#x27;arg2&#x27;</span>);</code></pre></div><p>On emit call listeners are called synchronously and in the order the listeners were registered.</p><p>Have multiple different events for different state or actions:</p><div class="code-wrapper"><pre><code class="hljs javascript">myEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;conditionA&#x27;</span>, doConditionA);myEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;conditionB&#x27;</span>, doConditionB);myEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;conditionC&#x27;</span>, doConditionC);myEmitter.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;error&#x27;</span>, handleErrorCondition);</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>CS142</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MaterialUI</title>
    <link href="/2024/10/09/CS142/material-ui/"/>
    <url>/2024/10/09/CS142/material-ui/</url>
    
    <content type="html"><![CDATA[<h2 id="Layout">Layout</h2><h3 id="Grid">Grid</h3><p><a href="https://mui.com/material-ui/react-grid2/">Official Documentation</a></p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">Grid</span> <span class="hljs-attr">container</span> <span class="hljs-attr">spacing</span>=<span class="hljs-string">&#123;2&#125;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">Grid</span> <span class="hljs-attr">item</span> <span class="hljs-attr">xs</span>=<span class="hljs-string">&#123;12&#125;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">TopBar</span> /&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">Grid</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;cs142-main-topbar-buffer&quot;</span> /&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">Grid</span> <span class="hljs-attr">item</span> <span class="hljs-attr">sm</span>=<span class="hljs-string">&#123;3&#125;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">Paper</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;cs142-main-grid-item&quot;</span>&gt;</span>      ...    <span class="hljs-tag">&lt;/<span class="hljs-name">Paper</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">Grid</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">Grid</span> <span class="hljs-attr">item</span> <span class="hljs-attr">sm</span>=<span class="hljs-string">&#123;9&#125;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">Paper</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;cs142-main-grid-item&quot;</span>&gt;</span>      ...    <span class="hljs-tag">&lt;/<span class="hljs-name">Paper</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">Grid</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Grid</span>&gt;</span></code></pre></div><ul><li>When my screen size is smaller than any specified screen size, components will take all 12 columns by default. In this case, when the screen size is xs, since no <code>xs={}</code> is specified and smallest, the Grid item will default to taking up all 12 columns. So the two <code>paper</code> components will stack on one another.</li><li>If a specific size (like md, lg, or xl) is not specified, the grid system will use the settings from the closest smaller breakpoint that is defined.</li></ul><h2 id="theme">theme</h2><p><a href="https://mui.com/material-ui/customization/default-theme/">The default Theme Parameters</a></p><h2 id="Miscellaneous">Miscellaneous</h2><h3 id="Template-Literals">Template Literals</h3><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ListItemText</span> <span class="hljs-attr">primary</span>=<span class="hljs-string">&#123;</span>` $&#123;<span class="hljs-attr">user.first_name</span>&#125; $&#123;<span class="hljs-attr">user.last_name</span>&#125; `&#125; /&gt;</span></code></pre></div><ul><li>In JavaScript, strings can be created using single quotes (<code>'</code>), double quotes (<code>&quot;</code>), or backticks (<code>   </code> `). Backticks are used to create template literals, which is useful for formatting a string.</li><li><code>${}</code> allows you to interpolate JavaScript expressions or variables directly into the string, as shown in the example</li></ul><h3 id="Component-Prop">Component Prop</h3><p>Example:</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ListItem</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&#123;Link&#125;</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&#123;</span>`/$&#123;<span class="hljs-attr">user._id</span>&#125;`&#125; <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;list-item&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">ListItemText</span> <span class="hljs-attr">primary</span>=<span class="hljs-string">&#123;</span>` $&#123;<span class="hljs-attr">user.first_name</span>&#125; $&#123;<span class="hljs-attr">user.last_name</span>&#125; `&#125; /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ListItem</span>&gt;</span></code></pre></div><ul><li>MUI components are built on top of standard HTML elements like div, button, a, etc.</li><li>The component prop allows you to specify which element or component should be rendered in place of the default one. For example, if you have an MUI <code>&lt;ListItem /&gt;</code>, its default rendering might be a <code>li</code> tag. However, you can replace that li tag with something else, like a Link (from react-router-dom or any other component), by passing the component={Link} prop.</li><li>In the example, I’m using the component={Link} prop to turn the ListItem into a Link component from react-router-dom. Since Link expects a <code>to={}</code> prop (which defines the route path for navigation), I’m able to pass <code>to={/${user._id}}</code> as a prop to the ListItem, because the ListItem is now acting as a Link component.</li></ul><h3 id="Overriding-Styles">Overriding Styles</h3><p>Every Material UI component accepts a className prop, which allows you to apply custom CSS classes to the component. For example,</p><div class="code-wrapper"><pre><code class="hljs css">&lt;<span class="hljs-selector-tag">Button</span> className=&quot;my-custom-<span class="hljs-selector-tag">button</span>&quot;&gt;Click Me&lt;/<span class="hljs-selector-tag">Button</span>&gt;<span class="hljs-selector-class">.my-custom-button</span> &#123;  <span class="hljs-attribute">background-color</span>: green;  <span class="hljs-attribute">color</span>: white;&#125;</code></pre></div><p>However, some Material UI components are composed of multiple nested elements. To target these specific parts, you need to use the global class names provided by Material UI. These class names follow a pattern like .MuiComponentName-elementName.</p><p>CSS pseudo-classes like <code>:hover</code>, <code>:focus</code>, and <code>:disabled</code> have higher specificity. Material UI mimics this behavior by applying state classes with higher specificity. Therefore, to override these styles, you need to match or exceed this specificity in your CSS. For example,</p><div class="code-wrapper"><pre><code class="hljs css">&lt;MenuItem selected className=&quot;my-<span class="hljs-selector-tag">menu</span>-item&quot;&gt;<span class="hljs-selector-tag">Option</span> <span class="hljs-number">1</span>&lt;/MenuItem&gt;<span class="hljs-selector-class">.my-menu-item</span> &#123;  <span class="hljs-attribute">color</span>: black;&#125;<span class="hljs-comment">/* Increase specificity for the selected state */</span><span class="hljs-selector-class">.my-menu-item</span><span class="hljs-selector-class">.Mui-selected</span> &#123;  <span class="hljs-attribute">color</span>: blue;&#125;</code></pre></div><ul><li><strong>When you add the selected prop to the MenuItem, Material UI automatically applies a special class called Mui-selected to the component.</strong> As a result, the <code>&lt;MenuItem selected className=&quot;my-menu-item&quot;&gt;Option 1&lt;/MenuItem&gt;</code> will have color blue instead of black.</li></ul><h4 id="Using-the-sx-prop">Using the sx prop</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">Grid</span> <span class="hljs-attr">container</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">Grid</span> <span class="hljs-attr">item</span>&gt;</span>    ...  <span class="hljs-tag">&lt;/<span class="hljs-name">Grid</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">Grid</span> <span class="hljs-attr">item</span>&gt;</span>    ...  <span class="hljs-tag">&lt;/<span class="hljs-name">Grid</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Grid</span>&gt;</span></code></pre></div><p>The above html becomes the following in the browser, which are modified by materialUI by injecting some new classes:</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;MuiGrid-root MuiGrid-container&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;MuiGrid-root MuiGrid-item&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;MuiGrid-root MuiGrid-item&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">Grid</span> <span class="hljs-attr">container</span> <span class="hljs-attr">spacing</span>=<span class="hljs-string">&#123;3&#125;</span> <span class="hljs-attr">sx</span>=<span class="hljs-string">&#123;&#123;</span></span><span class="hljs-tag">  <span class="hljs-attr">maxHeight:</span> &#x27;<span class="hljs-attr">80vh</span>&#x27;,</span><span class="hljs-tag">  <span class="hljs-attr">overflowY:</span> &#x27;<span class="hljs-attr">auto</span>&#x27;,</span><span class="hljs-tag">  &#x27;&amp; <span class="hljs-attr">.MuiGrid-root</span>&#x27;<span class="hljs-attr">:</span> &#123;</span><span class="hljs-tag">    <span class="hljs-attr">paddingLeft:</span> &#x27;<span class="hljs-attr">10px</span>&#x27;,</span><span class="hljs-tag">    <span class="hljs-attr">paddingTop:</span> &#x27;<span class="hljs-attr">10px</span>&#x27;,</span><span class="hljs-tag">    <span class="hljs-attr">paddingBottom:</span> &#x27;<span class="hljs-attr">10px</span>&#x27;</span><span class="hljs-tag">  &#125;,</span><span class="hljs-tag">&#125;&#125; &gt;</span></code></pre></div><ul><li>The <code>&amp;</code> represents the current component in the context of the sx prop. In this case, &amp; refers to the Grid container component.</li><li><code>'&amp; .MuiGrid-root'</code> targets all elements with the class <code>.MuiGrid-root</code> that are descendants of the Grid container.</li><li>As a result, the <code>'&amp; .MuiGrid-root'</code> applies the specified padding styles to all Grid items within the container.</li><li><a href="https://mui.com/material-ui/customization/how-to-customize/">Refer to this</a> for how to use this in more detail</li></ul>]]></content>
    
    
    <categories>
      
      <category>CS142</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Stanford CS142 笔记 - Server Communication</title>
    <link href="/2024/10/08/CS142/server-communication/"/>
    <url>/2024/10/08/CS142/server-communication/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>In software engineering, server comminicates with browser. Controller fetches the model for the View. There are a lot of tools that enable this functionality.</p><h3 id="AJAX">AJAX</h3><p>AJAX stands for Asynchronous JavaScript and XML. It is a set of web development techniques that allows a web page to communicate with a server asynchronously, meaning that the web page can update parts of itself (such as data in a table or form) without needing to reload the entire page. AJAX uses JavaScript to make HTTP requests to a server, fetch data, and then update parts of the web page.</p><h3 id="XMLHttpRequest">XMLHttpRequest</h3><p>One of the early methods for enabling browser-server communication was the XMLHttpRequest (XHR) object. It allows browsers to send asynchronous HTTP requests without refreshing the entire page.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> xhr;xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();xhr.<span class="hljs-property">onreadystatechange</span> = xhrHandler; <span class="hljs-comment">// Event handler for state change</span>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&quot;GET&quot;</span>, url); <span class="hljs-comment">// Open a connection (GET request in this case)</span>xhr.<span class="hljs-title function_">send</span>(); <span class="hljs-comment">// Send the request</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">xhrHandler</span>(<span class="hljs-params">event</span>) &#123;    <span class="hljs-comment">// this === xhr (the XMLHttpRequest object)</span>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">readyState</span> != <span class="hljs-number">4</span>) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> != <span class="hljs-number">200</span>) &#123;        <span class="hljs-keyword">return</span>;    &#125;    <span class="hljs-keyword">let</span> text = <span class="hljs-variable language_">this</span>.<span class="hljs-property">responseText</span>;    <span class="hljs-comment">// You can now use &#x27;text&#x27; as needed (e.g., display it, process it, etc.)</span>&#125;</code></pre></div><ul><li><p>Create an XMLHttpRequest object, open a connection to the server (GET/POST/other methods), and send the request.</p></li><li><p><strong>The onreadystatechange event handler is called every time the readyState of the XMLHttpRequest object changes</strong>. The <strong>readyState</strong> property of the XMLHttpRequest object represents the current state of the request:</p></li><li><p>0: UNSENT – The request has not been initialized yet.</p></li><li><p>1: OPENED – The request has been opened but not sent yet.</p></li><li><p>2: HEADERS_RECEIVED – The request has been sent, and headers have been received.</p></li><li><p>3: LOADING – The request is in progress, and some response data has been received (but not fully).</p></li><li><p>4: DONE – The request is complete, and the full response is available.</p></li><li><p>In this example, the handler only cares about the final state (i.e., readyState == 4) when the request has been completed:</p></li><li><p><code>this.readyState != 4</code>: This condition checks whether the request has completed or not. If the state is not 4 (DONE), it returns early and doesn’t proceed.</p></li><li><p><code>this.status != 200</code>: Once the request is complete, this condition checks whether the HTTP status code is 200 (OK). If the status is not 200, it returns early, meaning it only proceeds if the request was successful.</p></li><li><p><code>this.responseText</code>: After confirming the request has completed successfully, it retrieves the response text (the raw data returned from the server) and stores it in text. You can then use this text as needed.</p></li><li><p>Nowadays, <code>fetch()</code> api is more widely used. The response is usually JSON object nowadays.</p></li></ul><h3 id="REST-API">REST API</h3><p>REST API (Representational State Transfer Application Programming Interface) is a set of rules that allows systems to communicate with each other over the internet using HTTP methods.</p><ul><li>Resource: A resource in REST is any data or object that can be accessed and manipulated via the API, such as user profiles, blog posts, comments, products, etc.</li><li>URI: Uniform Resource Identifier, typically a URL, e.g., <code>/books</code> might represent the collection of books.</li><li>HTTP methods: GET, POST, DELETE, PUT.</li><li>e.g., <code>GET /photo/78237489</code>, <code>POST /photo/</code>.</li><li>Clients (web apps, mobile apps) send HTTP requests to specific endpoints, and the server responds with data (often in JSON format)</li><li>REST APIs are platform-independent and can be accessed by any client that can send HTTP requests (e.g., web browsers, mobile apps, or servers). With a REST API, the frontend and backend can be developed independently.</li><li>RESTful APIs are stateless, meaning that the server does not store any information about the client between requests.</li></ul><p>In conclusion, RESt API provides Standardization (otherwise, we need to customize how browser interacts with the server), Decoupling of frontend and backend, and Scalability.</p><h3 id="Axios">Axios</h3><p>Axios is a JavaScript library that simplifies making HTTP requests. Axios is also promise-based and is widely used for communicating with RESTful APIs. It is a wrapper around XMLHttpRequest but provides a cleaner, more intuitive API, automatic JSON parsing, and better error handling. Axios can be used for making AJAX requests, just like fetch() or XMLHttpRequest. Here is an example usage:</p><div class="code-wrapper"><pre><code class="hljs javascript">axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/user/123&#x27;</span>)  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(response.<span class="hljs-property">data</span>)) <span class="hljs-comment">// Process the JSON response</span>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Error:&#x27;</span>, error));</code></pre></div><h2 id="Promises">Promises</h2><p>For how to use promises, please refer to <a href="https://thiefcat.github.io/2024/07/14/MIT-Weblab/Async-Control/">MIT Weblab笔记 - Asynchronous Control</a>.</p><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Document on promises</a></p>]]></content>
    
    
    <categories>
      
      <category>CS142</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Stanford CS142 笔记 - Single Page Application</title>
    <link href="/2024/08/13/CS142/spa/"/>
    <url>/2024/08/13/CS142/spa/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>In a traditional web app, changing the URL usually means sending a request to the server for a new HTML document.</p><p>In contrast, SPAs generally involve a single HTML file that serves as the structure for the entire app. Once loaded, this file stays in place, and JavaScript handles any further changes to the page’s content. SPAs dynamically rewrite the current page using JavaScript, allowing for a smoother, faster user experience.</p><h2 id="React-Router">React Router</h2><h3 id="HashRouter">HashRouter</h3><p>We can use the URL to control which components are rendered by React. The URL becomes the single source of truth for what should be displayed on the screen.</p><p>The primary role of a router in a Single Page Application (SPA) is to manage page navigation without triggering a full page reload.</p><ul><li>The router listens for changes in the browser’s URL. The router intercepts the change and decides which part of the application to render. For example, if the URL changes from <code>/home</code> to <code>/about</code>, the router will swap out the current component for a different one.</li></ul><div class="code-wrapper"><pre><code class="hljs javascript">&lt;<span class="hljs-title class_">HashRouter</span>&gt;  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">    ...</span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/states&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&#123;States&#125;</span> /&gt;</span></span><span class="language-xml">    ...</span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/states&quot;</span>&gt;</span>States<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span><span class="language-xml">    ...</span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>&lt;/<span class="hljs-title class_">HashRouter</span>&gt;</code></pre></div><ul><li><code>&lt;HashRouter&gt;</code>: With HashRouter, the URL will contain a <code>#</code> symbol, followed by the client-side route. For example: <code>http://localhost:3000/#/users/123</code>. In this case, the URL before the hash (<a href="http://localhost:3000/">http://localhost:3000/</a>) is what the server handles, and everything after the <code>#</code> (/users/123) is used by the client-side routing mechanism to render the appropriate view in the React app.</li><li><code>&lt;Route /&gt;</code>: Define a route in application. When the URL matches the path, React Router renders the component specified in the component prop. <strong>If the URL starts with the defined path, the route is considered a match.</strong></li><li><code>&lt;Link /&gt;</code>: Generates a hyperlink with href=“#/states” and the text “States”.</li><li>In conclusion, when clicking the link with text “States”, the url will be updated to <code>http://localhost:3000/p5.html#/states</code>, where <code>http://localhost:3000/p5.html</code> is the current path, and the component <code>States</code> will be rendered by <code>&lt;Route path=&quot;/states&quot; component={States} /&gt;</code>. In a URL, the part after the # is called the fragment identifier or hash. The primary purpose of the hash in URLs is to provide a way to navigate to a specific section or state of a page without causing a full page reload.</li><li>When you load a URL with a hash (e.g., <code>http://localhost:3000/#/users/123</code>), the browser doesn’t send anything after the <code>#</code> to the server. It only requests the base URL (in this case, <code>http://localhost:3000/</code>). Then, hashRouter looks at the fragment (#/users/123) and maps it to the appropriate route defined in your React app (e.g., <code>/users/:userId</code>).</li></ul><p>We can also pass parameters with React Router</p><div class="code-wrapper"><pre><code class="hljs javascript">&lt;<span class="hljs-title class_">Route</span>  path=<span class="hljs-string">&quot;/Book/:book/ch/:chapter&quot;</span>  component=&#123;<span class="hljs-title class_">BookChapterComponent</span>&#125;/&gt;<span class="hljs-keyword">function</span> <span class="hljs-title function_">BookChapterComponent</span>(<span class="hljs-params">&#123; match &#125;</span>) &#123;  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Book: &#123;match.params.book&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Chapter: &#123;match.params.chapter&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;&lt;<span class="hljs-title class_">Link</span> to=<span class="hljs-string">&quot;/Book/Moby/ch/1&quot;</span>&gt;<span class="hljs-title class_">Moby</span>&lt;/<span class="hljs-title class_">Link</span>&gt;</code></pre></div><ul><li><code>:book</code> and <code>:chapter</code> are placeholders in the URL that will be dynamically replaced by actual values when the route is matched.</li><li><code>match</code> is an object that contains information about how the URL matches the route.</li><li>When this link is clicked, the React Router will navigate to this URL, and the BookChapterComponent will render with <code>match.params.book</code> set to “Moby” and <code>match.params.chapter</code> set to “1”.</li><li>this.props.match is passed automatically to any component that is rendered by a <code>Route</code>.</li><li>If your component is supposed to receive props from React Router (like match, location, and history), it must be rendered inside a Route</li></ul><div class="code-wrapper"><pre><code class="hljs html">import &#123; Route &#125; from &#x27;react-router-dom&#x27;;<span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/users/:userId&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">&#123;YourComponent&#125;</span> /&gt;</span></code></pre></div><ul><li>Deep linking: Deep linking refers to the ability to link directly to a specific page or view within a web application. URLs that map directly to certain views (like <code>/photos/57231f1a30e4351f4e9f4bd8</code>) can be shared with others, who can then access the same page or state.</li></ul><p>React Router provides two main ways to render components when a route matches: the <code>component</code> prop and the <code>render</code> prop.</p><ul><li>component: This is used when you want to simply render a component without needing to pass additional props or logic.</li><li>render: This is used when you want to pass custom props or add additional logic before rendering the component. With render, you can control what props are passed to the component and include any dynamic data. <code>render</code> should be a function that returns the component.</li></ul><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/users/:userId&quot;</span> <span class="hljs-attr">render</span>=<span class="hljs-string">&#123;props</span> =&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">UserDetail</span> &#123;<span class="hljs-attr">...props</span>&#125; <span class="hljs-attr">extraProp</span>=<span class="hljs-string">&#123;extraProp&#125;</span> <span class="hljs-attr">handler</span>=<span class="hljs-string">&#123;this.handleUserNameChange&#125;</span> /&gt;</span>&#125; /&gt;</code></pre></div><h3 id="Switch">Switch</h3><p>Switch is responsible for rendering the <strong>first child</strong> <code>&lt;Route&gt;</code> that matches the current URL. It ensures that only one route is displayed at a time.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> routes = (  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Switch</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">exact</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/&quot;</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">Home</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/about&quot;</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">About</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/:user&quot;</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">User</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Route</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">NoMatch</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">Switch</span>&gt;</span></span>);</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>CS142</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Stanford CS142 笔记 - How React Works</title>
    <link href="/2024/08/12/CS142/how-react-works/"/>
    <url>/2024/08/12/CS142/how-react-works/</url>
    
    <content type="html"><![CDATA[<p>For how to use React to create a Web Application, including how to create component, props, and states, please refer to <a href="https://thiefcat.github.io/2024/07/03/MIT-Weblab/React/">MIT Weblab笔记 - React Introduction</a> and <a href="https://thiefcat.github.io/2024/07/04/MIT-Weblab/React-Advanced/">MIT Weblab笔记 - React Advanced</a>.</p><h2 id="Takeaway">Takeaway</h2><ul><li>To create a React application, we first define a React.js Web Application Page, then define a root React component (like <code>&lt;APP /&gt;</code>), and then render the root React component into browser DOM.</li><li>JSX maps to calls to <code>React.createElement</code>.</li><li>A React component can be defined as a function, and the states are managed by hooks.</li><li>When I first type a url and hit enter, I send a http request to the server. Since this is the initial connect, the server responds a <code>index.html</code> file, which is the entry of the web application, as well as a <code>bundle.js</code> file, which is generated by Webpack (According to a configuration file <code>webpack.config.js</code>). Webpack takes all my project’s JavaScript, along with other assets (like CSS, images, or even other files), and bundles them into one or more output files that can be served to the browser. Then browser executes <code>bundle.js</code>. This is where the app’s frontend logic starts running.</li></ul><h2 id="Create-a-React-Application">Create a React Application</h2><h3 id="React-js-Web-Application-Page">React.js Web Application Page</h3><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>CS142 Example<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>   <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>   <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;reactapp&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>     <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./webpackOutput/reactApp.bundle.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>   <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><ul><li>the <code>div</code> element with the ID “reactapp”: serves as the “root” of the React application, where the entire React component tree will be rendered. Essentially, when the application runs, React will take control of this div and dynamically update the content within it based on the application’s state and logic.</li><li>bundle.js: The script tag is used to include the JavaScript file that contains the bundled React code. The file bundles all the React components, JavaScript, and other assets into a single file (or multiple files) for efficient loading and execution in the browser.</li><li>When the script is loaded, it uses the DOM API to render and update the view inside the <code>div</code> with ID reactapp.</li></ul><h3 id="Render-elements-into-browser-DOM">Render elements into browser DOM</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-dom&#x27;</span>;<span class="hljs-keyword">import</span> <span class="hljs-title class_">ReactAppView</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./components/ReactAppView&#x27;</span>;<span class="hljs-keyword">let</span> viewTree = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-title class_">ReactAppView</span>, <span class="hljs-literal">null</span>);<span class="hljs-keyword">let</span> where = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;reactapp&#x27;</span>);<span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(viewTree, where);</code></pre></div><ul><li>viewTree: creates an instance of the ReactAppView React component</li><li>where: the DOM element with the ID “reactapp”</li><li>ReactDOM.render: This is the key function that tells React to render the viewTree (which contains the ReactAppView component) into the where element, which is the div with the ID reactapp define in the previous React.js Web Application Page. This effectively “mounts” the React component into the browser’s DOM.</li></ul><h3 id="Define-ReactAppView-component">Define <code>ReactAppView</code> component</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<span class="hljs-keyword">class</span> <span class="hljs-title class_">ReactAppView</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;    <span class="hljs-variable language_">super</span>(props);    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123; <span class="hljs-attr">yourName</span>: <span class="hljs-string">&quot;&quot;</span> &#125;;    <span class="hljs-comment">// Binding handleChange method in the constructor</span>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleChange</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleChange</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);  &#125;  <span class="hljs-title function_">handleChange</span>(<span class="hljs-params">event</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">yourName</span>: event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span> &#125;);  &#125;  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">let</span> label = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;label&#x27;</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">&#x27;Name: &#x27;</span>);    <span class="hljs-keyword">let</span> input = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;input&#x27;</span>, &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;text&#x27;</span>, <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">yourName</span>, <span class="hljs-attr">onChange</span>: <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleChange</span>(event) &#125;);    <span class="hljs-keyword">let</span> h1 = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;h1&#x27;</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">&#x27;Hello &#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">yourName</span>, <span class="hljs-string">&#x27;!&#x27;</span>);    <span class="hljs-keyword">return</span> <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>, <span class="hljs-literal">null</span>, label, input, h1);  &#125;&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">ReactAppView</span>;</code></pre></div><ul><li><p>constructor: initialize the component’s state or bind methods. In this case, this.state is an object that contains key-value pairs representing the component’s state.</p></li><li><p><code>render()</code>: The <code>render()</code> method is required for any React component. It defines what the component should output to the DOM. This method returns a React element or a tree of elements.</p></li><li><p><code>react.createElement()</code>: const element = createElement(type, props, …children).</p></li><li><p>type: HTML tag or React Component</p></li><li><p>props: attributes</p></li><li><p>children: can be String or numbers, React element, or an array of the above</p></li><li><p><code>this.setState</code> is a method provided by React’s Component class to change the state.</p></li><li><p>The above code renders the following HTML Structure:</p></li></ul><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Name: <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">...</span> /&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello &#123;this.state.yourName&#125;!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><p>We can use JSX to concisely define the component output to the DOM instead of using <code>react.createElement()</code>:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;  <span class="hljs-variable language_">super</span>(props);  <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123; <span class="hljs-attr">yourName</span>: <span class="hljs-string">&quot;&quot;</span> &#125;;  <span class="hljs-comment">// Binding handleChange method in the constructor</span>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleChange</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleChange</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>);&#125;<span class="hljs-title function_">handleChange</span>(<span class="hljs-params">event</span>) &#123;  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">yourName</span>: event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span> &#125;);&#125;<span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Name: <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;this.state.yourName&#125;</span></span></span><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;this.handleChange&#125;</span></span></span><span class="hljs-tag"><span class="language-xml">      /&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello &#123;this.state.yourName&#125;!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;</code></pre></div><ul><li>JSX maps to calls to <code>React.createElement</code>.</li><li>Writing in JavaScript HTML-like syntax that is converted to JavaScript function calls.</li><li>when <code>this.handleChange</code> is called from the event, the “this” keyword inside <code>handleChange</code> function might not refer to the component instance (ReactAppView), so “this” in <code>this.setState({ yourName: event.target.value })</code> of <code>handleChange</code> function might cause errors. As a result, we use <code>this.handleChange = this.handleChange.bind(this)</code>: binding the “this” context of handleChange to the component instance.</li></ul><p>We can use arrow functions (Arrow functions inherently bind this to the surrounding context at the time of their definition):</p><div class="code-wrapper"><pre><code class="hljs javascript">handleChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">yourName</span>: event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span> &#125;);&#125;</code></pre></div><ul><li>In this case, we can avoid bindding “this” in the constructor.</li><li>Everytime handleChange is called, the “this” keyword inside this function refers to the object of the class.</li></ul><p>A more concise component definition:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<span class="hljs-keyword">class</span> <span class="hljs-title class_">ReactAppView</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;    <span class="hljs-variable language_">super</span>(props);    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123; <span class="hljs-attr">yourName</span>: <span class="hljs-string">&quot;&quot;</span> &#125;;  &#125;  handleChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">yourName</span>: event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span> &#125;);  &#125;  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> (      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Name: <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">input</span></span></span><span class="hljs-tag"><span class="language-xml">          <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">          <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;this.state.yourName&#125;</span></span></span><span class="hljs-tag"><span class="language-xml">          <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;this.handleChange&#125;</span></span></span><span class="hljs-tag"><span class="language-xml">        /&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello &#123;this.state.yourName&#125;!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>    );  &#125;&#125;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">ReactAppView</span>;</code></pre></div><h3 id="Stateless-Components-and-React-Hooks">Stateless Components and React Hooks</h3><p>A React component can be defined as a function if it only depends on props. Previously, we define React component by defining a class that extends <code>React.Component</code>.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params">props</span>) &#123;    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>My name is &#123;props.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;&#125;</code></pre></div><p>Before hooks, functional components were “stateless.” With hooks like <code>useState</code>, we can now add state to these components.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<span class="hljs-keyword">function</span> <span class="hljs-title function_">Example</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You clicked &#123;count&#125; times<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;</span><span class="language-xml">        Click me</span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;</code></pre></div><h2 id="React-js-Tool-Chain">React.js Tool Chain</h2><div style="text-align: center;"><img src="tool-chain.png" style="width: 80%; height: auto;" alt="Sample Image"></div><ul><li>Each React component is passed through Babel, a popular JavaScript compiler, which transpiles JSX and ES6+ into a version of JavaScript that is compatible with all browsers.</li><li>The transpiled components are then bundled together by Webpack.</li><li><code>bundle.js</code>: <strong>This bundled file is what actually gets loaded in the browser, and it contains everything your React application needs to run.</strong></li></ul><p>Webpack can bundle all of your project’s files (JavaScript, CSS, images, etc.) into a single file. It enables us to do like following:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// app.js</span><span class="hljs-keyword">import</span> &#123; add &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./math&#x27;</span>;<span class="hljs-keyword">import</span> &#123; logResult &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./utils&#x27;</span>;<span class="hljs-keyword">const</span> result = <span class="hljs-title function_">add</span>(<span class="hljs-number">5</span>, <span class="hljs-number">10</span>);<span class="hljs-title function_">logResult</span>(result);</code></pre></div><p>Now we only need to include one script in the HTML, otherwise, we need to manually include all script files.</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;bundle.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>CS142</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Stanford CS142 笔记 - DOM</title>
    <link href="/2024/08/06/CS142/dom/"/>
    <url>/2024/08/06/CS142/dom/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>The Document Object Model (DOM) is a programming interface provided by web browsers. It represents the structure of an HTML document in a way that JavaScript can interact with it. JavaScript can query or modify the HTML document. We can refer to the DOM by <code>document</code> variable.</p><h3 id="DOM-Hierarchy">DOM Hierarchy</h3><ul><li><p>When a web page is loaded, the browser parses the HTML document and creates a tree-like structure called the DOM tree. Each element in the HTML document becomes a node in this tree. For instance, a <code>&lt;div&gt;</code> tag, a piece of text, or an attribute like class are all nodes in the DOM.</p></li><li><p>DOM rooted at window.document</p></li><li><p>The DOM exposes these nodes as JavaScript objects, and each object provides methods and properties to interact with that part. This means that every part of the document can be accessed and manipulated using JavaScript.</p></li></ul><p>An example DOM:</p><div style="text-align: center;">  <img src="dom.png" style="width: 500px; height: auto;" alt="Sample Image"></div><h3 id="DOM-Node-Properties-and-Methods">DOM Node Properties and Methods</h3><p>The DOM provides a variety of methods (functions) and properties (attributes) to interact with the nodes: <a href="https://www.w3schools.com/jsref/dom_obj_document.asp">DOM tutorial</a></p><p>Example methods and properties:</p><ul><li><code>document.getElementById(&quot;myDiv&quot;)</code>: Finds an element with the specified ID.</li><li><code>element = document.createElement(&quot;P&quot;)</code>: Create a new element.</li><li><code>element.innerHTML = &quot;Hello, World!</code>: Changes the content inside an element.</li><li><code>element.setAttribute(&quot;class&quot;, &quot;newClass&quot;)</code>: Sets a new attribute or changes an existing one.</li><li><code>element.appendChild(newElement)</code>: Add a new child to element.</li></ul><p>Example:</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>My Page<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;myDiv&quot;</span>&gt;</span>Hello, World!<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">        <span class="hljs-comment">// JavaScript to interact with the DOM</span></span><span class="language-javascript">        <span class="hljs-keyword">var</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;myDiv&quot;</span>);</span><span class="language-javascript">        element.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;Hello, DOM!&quot;</span>;</span><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>CS142</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Stanford CS142 笔记 - JavaScript</title>
    <link href="/2024/08/02/CS142/javascript/"/>
    <url>/2024/08/02/CS142/javascript/</url>
    
    <content type="html"><![CDATA[<h2 id="Functions">Functions</h2><h3 id="Arrow-Functions-and-Traditional-Functions">Arrow Functions and Traditional Functions</h3><h4 id="Traditional-Functions">Traditional Functions</h4><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>) &#123;    <span class="hljs-keyword">return</span> a + b;&#125;</code></pre></div><ul><li>hoisting<br>JavaScript moves the function declarations to the top of their scope before execution.</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)); <span class="hljs-comment">// Works fine, even though add is defined later</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a, b</span>) &#123;    <span class="hljs-keyword">return</span> a + b;&#125;</code></pre></div><ul><li>“this” keyword<br><strong>The value of “this” inside a traditional function depends on how the function is called</strong>.</li></ul><h4 id="Arrow-Functions">Arrow Functions</h4><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">a, b</span>) =&gt; &#123;    <span class="hljs-keyword">return</span> a + b;&#125;;</code></pre></div><ul><li>No hoisting</li><li>“this” keyword<br><strong>Arrow functions do not have their own “this” context. Instead, they inherit “this” from the surrounding scope where the arrow function is defined</strong>.</li></ul><h3 id="First-Class-Functions">First Class Functions</h3><ul><li>Functions are treated like variables in JavaScript</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> obj = &#123;<span class="hljs-attr">count</span>: <span class="hljs-number">0</span>&#125;; obj.<span class="hljs-property">increment</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">amount</span>) &#123;     <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> += amount;     <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>; &#125;obj.<span class="hljs-title function_">increment</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// returns 1 </span>obj.<span class="hljs-title function_">increment</span>(<span class="hljs-number">3</span>); <span class="hljs-comment">// returns 4</span></code></pre></div><p><code>this</code> refers to the object that the method was called on. In this case, it refers to <code>obj</code>.</p><ul><li>Functions can have properties</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">plus1</span>(<span class="hljs-params">value</span>) &#123;     <span class="hljs-keyword">if</span> (plus1.<span class="hljs-property">invocations</span> == <span class="hljs-literal">undefined</span>) &#123;         plus1.<span class="hljs-property">invocations</span> = <span class="hljs-number">0</span>;     &#125;     plus1.<span class="hljs-property">invocations</span>++;     <span class="hljs-keyword">return</span> value + <span class="hljs-number">1</span>; &#125;</code></pre></div><p><code>plus1.invocations</code> will be the number times function is called.</p><h3 id="Closures">Closures</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> globalVar = <span class="hljs-number">1</span>; <span class="hljs-keyword">function</span> <span class="hljs-title function_">localFunc</span>(<span class="hljs-params">argVar</span>) &#123;     <span class="hljs-keyword">let</span> localVar = <span class="hljs-number">0</span>;     <span class="hljs-keyword">function</span> <span class="hljs-title function_">embedFunc</span>(<span class="hljs-params"></span>) &#123;<span class="hljs-keyword">return</span> ++localVar + argVar + globalVar;&#125;     <span class="hljs-keyword">return</span> embedFunc; &#125;<span class="hljs-keyword">let</span> myFunc = <span class="hljs-title function_">localFunc</span>(<span class="hljs-number">10</span>);</code></pre></div><ul><li>The <code>localFunc</code> returns the <code>embedFunc</code> function.</li><li><code>let myFunc = localFunc(10)</code>: This creates a new function <code>myFunc</code> by calling localFunc with 10 as the argument. <code>myFunc</code> now holds the reference to the <code>embedFunc</code> closure, with <code>localVar</code> initialized to 0 and <code>argVar</code> set to 10.</li><li>Each call <code>console.log(myFunc())</code> increases localVar by 1 and returns the updated sum.</li><li>Closures are an advanced programming concept in JavaScript that allow functions to retain access to variables from their lexical scope even after the outer function has finished executing. The <code>embedFunc</code> closure retains access to localVar, argVar, and globalVar even after <code>localFunc</code> has finished executing.</li><li>Using closures to encapsulate the state:</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> myModule = (<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-comment">// Private variables and functions</span>  <span class="hljs-keyword">var</span> privateVariable = <span class="hljs-string">&#x27;I am private&#x27;</span>;  <span class="hljs-keyword">function</span> <span class="hljs-title function_">privateFunction</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(privateVariable);  &#125;  <span class="hljs-comment">// Public API</span>  <span class="hljs-keyword">return</span> &#123;    <span class="hljs-attr">publicMethod</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;        <span class="hljs-title function_">privateFunction</span>();    &#125;,    <span class="hljs-attr">publicProperty</span>: <span class="hljs-string">&#x27;I am public&#x27;</span>  &#125;;&#125;)();myModule.<span class="hljs-title function_">publicMethod</span>();</code></pre></div><ul><li>The function is defined and immediately invoked, creating a new scope. <code>var myModule = (function () {do something})();</code></li><li>myModule is not a function, but the return value of the function, which is an object.</li><li>An IIFE (Immediately Invoked Function Expression) is a function that is executed right after it is defined. <code>myModule</code> is the return value of IIFE.</li></ul><h2 id="“this”-keyword">“this” keyword</h2><p>In JavaScript, <code>this</code> is a keyword that refers to an object. <strong>However, the exact object that this refers to depends on how a function is called.</strong></p><ul><li>Global Context</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// outside of any function</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// In a browser, this will log the window object</span></code></pre></div><p>In browsers, the global object is <code>window</code>.</p><ul><li>Function Context</li></ul><p>When a function is called as a method of an object, this refers to the object that the method is called on.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> obj = &#123;  <span class="hljs-attr">value</span>: <span class="hljs-number">42</span>,  <span class="hljs-attr">getValue</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;  &#125;&#125;;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-title function_">getValue</span>()); <span class="hljs-comment">// 42</span></code></pre></div><ul><li>Constructor Functions</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) &#123;  <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;&#125;<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;Alice&#x27;</span>);<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-property">name</span>); <span class="hljs-comment">// Alice</span></code></pre></div><p><code>this</code> inside <code>Person</code> refers to the new object being created.<br>The <code>new</code> Keyword creates a new object, sets <code>this</code> to that object inside the constructor function, and returns the object.</p><h3 id="Binding">Binding</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Hello, &#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);&#125;</code></pre></div><p>The value of <code>this</code> inside the function is not determined at the time the function is defined. Instead, it is determined at the time the function is called.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> person = &#123;  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Alice&#x27;</span>,  <span class="hljs-attr">greet</span>: greet&#125;;person.<span class="hljs-title function_">greet</span>(); <span class="hljs-comment">// `this` refers to `person`, so it logs `Hello, Alice`</span></code></pre></div><ul><li>We can explicitly set <code>this</code>:</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Hello, &#x27;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>);&#125;<span class="hljs-keyword">const</span> person = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Alice&#x27;</span> &#125;;greet.<span class="hljs-title function_">call</span>(person); <span class="hljs-comment">// Hello, Alice</span><span class="hljs-keyword">const</span> greetPerson = greet.<span class="hljs-title function_">bind</span>(person);<span class="hljs-title function_">greetPerson</span>(); <span class="hljs-comment">// Hello, Alice</span></code></pre></div><ul><li><code>.call()</code>: Calls a function with a given <code>this</code> value.</li><li><code>.bind()</code>: Creates a new function that, when called, has its <code>this</code> keyword set to the provided value.</li></ul>]]></content>
    
    
    <categories>
      
      <category>CS142</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - React State Management</title>
    <link href="/2024/07/29/MIT_Weblab/React-State-Management/"/>
    <url>/2024/07/29/MIT_Weblab/React-State-Management/</url>
    
    <content type="html"><![CDATA[<h2 id="React-Context">React Context</h2><p>Previously, we pass state and setState as props through components to allow child component to update states of parent. If the component that needs the state is deep in the tree, this is a problem called “prop drilling”, where props are passed through many intermediate components.</p><p>The <code>useState</code> hook is commonly used to manage local component state. By combining it with Context, we can create a shared state accessible by any component in the tree. It’s particularly useful for global states, such as user authentication status, themes, or other application-wide settings.</p><ol><li>Create a Context</li></ol><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; createContext, useState, useContext &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<span class="hljs-keyword">const</span> <span class="hljs-title class_">MyContext</span> = <span class="hljs-title function_">createContext</span>();</code></pre></div><ol start="2"><li>Create a Provider: Can use context MyContext in any descendant of <code>MyContext.Provider</code>.</li></ol><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">MyProvider</span> = (<span class="hljs-params">&#123; children &#125;</span>) =&gt; &#123;  <span class="hljs-keyword">const</span> [state, setState] = <span class="hljs-title function_">useState</span>(initialState);  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">state</span>, <span class="hljs-attr">setState</span> &#125;&#125;&gt;</span></span><span class="language-xml">      &#123;children&#125;</span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">MyContext.Provider</span>&gt;</span></span>  );&#125;;</code></pre></div><ol start="3"><li>Wrap Your Application: Make <code>MyComponent</code> a descendent of <code>MyProvider</code>, so <code>MyComponent</code> can use the context.</li></ol><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"></span>) =&gt; &#123;  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyProvider</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">MyProvider</span>&gt;</span></span>  );&#125;;</code></pre></div><ol start="4"><li>Consume the Context: use <code>const { state, setState } = useContext(MyContext)</code> to extract the value provided by <code>MyContext.Provider</code>.</li></ol><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">MyComponent</span> = (<span class="hljs-params"></span>) =&gt; &#123;  <span class="hljs-keyword">const</span> &#123; state, setState &#125; = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">MyContext</span>);  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleChange</span> = (<span class="hljs-params"></span>) =&gt; &#123;    <span class="hljs-title function_">setState</span>(newState);  &#125;;  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;state.someValue&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;handleChange&#125;</span>&gt;</span>Change State<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;;</code></pre></div><h2 id="Reducers">Reducers</h2><p>Reducers provide a structured way to manage state transitions, especially for complex state logic or multiple state updates based on different actions.</p><ul><li><code>const [state, dispatch] = useReducer(reducer, initialState)</code></li><li>Redcer: A function that specifies how the state should be updated based on the action. <code>Reducer: f(state, action) -&gt; newState</code>. The reducer function takes the current state and an action as arguments and returns a new state. The reducer returns a new state object.</li><li>Dispatch: Use the <code>dispatch</code> function to trigger state transitions based on actions.</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; useReducer &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<span class="hljs-keyword">const</span> initialState = &#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> &#125;;<span class="hljs-keyword">function</span> <span class="hljs-title function_">reducer</span>(<span class="hljs-params">state, action</span>) &#123;  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) &#123;    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;increment&#x27;</span>:      <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span> + <span class="hljs-number">1</span> &#125;;    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;decrement&#x27;</span>:      <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span> - <span class="hljs-number">1</span> &#125;;    <span class="hljs-attr">default</span>:      <span class="hljs-keyword">return</span> state;  &#125;&#125;<span class="hljs-keyword">const</span> <span class="hljs-title function_">Counter</span> = (<span class="hljs-params"></span>) =&gt; &#123;  <span class="hljs-keyword">const</span> [state, dispatch] = <span class="hljs-title function_">useReducer</span>(reducer, initialState);  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: &#123;state.count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &#x27;increment&#x27; &#125;)&#125;&gt;Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> dispatch(&#123; type: &#x27;decrement&#x27; &#125;)&#125;&gt;Decrement<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Counter</span>;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - Typescript</title>
    <link href="/2024/07/24/MIT_Weblab/typescript/"/>
    <url>/2024/07/24/MIT_Weblab/typescript/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>TypeScript is a popular programming language that extends JavaScript by adding static types. Typescript catches errors at compile time rather than at runtime, making the code more reliable and easier to debug.</p><h2 id="Syntax">Syntax</h2><h3 id="Primitive-Data-Types">Primitive Data Types</h3><ul><li>number</li><li>boolean</li><li>string</li><li>object</li><li>undefined</li><li>null</li></ul><h3 id="Declare-a-Type-For-a-Variable">Declare a Type For a Variable</h3><p>Define types of a variable using <code>:</code>.</p><div class="code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;John&quot;</span>;<span class="hljs-keyword">let</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">30</span>;<span class="hljs-keyword">let</span> <span class="hljs-attr">isStudent</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;<span class="hljs-keyword">let</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>[] = [<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>];<span class="hljs-keyword">let</span> <span class="hljs-attr">message</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">string</span>&gt; = [<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>];</code></pre></div><h3 id="Define-a-Type">Define a Type</h3><div class="code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Color</span> = <span class="hljs-string">&quot;Red&quot;</span> | <span class="hljs-string">&quot;Green&quot;</span> | <span class="hljs-string">&quot;Blue&quot;</span>;<span class="hljs-keyword">let</span> <span class="hljs-attr">c</span>: <span class="hljs-title class_">Color</span> = <span class="hljs-string">&quot;Red&quot;</span>; <span class="hljs-comment">// can only be one of three colors</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">type</span> myType = &#123;    <span class="hljs-attr">myProperty</span>: <span class="hljs-built_in">string</span>;&#125;;<span class="hljs-keyword">const</span> <span class="hljs-attr">newVariable</span>: myType = &#123;<span class="hljs-attr">myProperty</span>: <span class="hljs-string">&quot;xxx&quot;</span>&#125;;</code></pre></div><div class="code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">type</span> <span class="hljs-title class_">User</span> = &#123;    <span class="hljs-attr">_id</span>: <span class="hljs-built_in">string</span>;    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;    <span class="hljs-attr">is_admin</span>?: <span class="hljs-built_in">boolean</span>;&#125;;<span class="hljs-keyword">const</span> <span class="hljs-attr">user</span>: <span class="hljs-title class_">User</span> = &#123;    <span class="hljs-attr">_id</span>: <span class="hljs-string">&quot;555&quot;</span>;    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Eric&quot;</span>;&#125;;<span class="hljs-keyword">export</span> &#123;<span class="hljs-title class_">User</span>&#125;</code></pre></div><ul><li>Denote optional params with ?</li></ul><h3 id="Typed-Functions">Typed Functions</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">getComments</span> = (<span class="hljs-params">id</span>) =&gt; &#123;    <span class="hljs-keyword">return</span> [];&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> getComments = (<span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Comment</span>[] =&gt; &#123;    <span class="hljs-keyword">return</span> [];&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs typescript"><span class="hljs-comment">// add type for a function</span><span class="hljs-keyword">type</span> <span class="hljs-title class_">CommentProps</span> = &#123;    <span class="hljs-attr">_id</span>: <span class="hljs-built_in">string</span>;    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;    <span class="hljs-attr">handleAdd</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>Typescript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - Sockets</title>
    <link href="/2024/07/21/MIT_Weblab/socket/"/>
    <url>/2024/07/21/MIT_Weblab/socket/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>Steps for a http request:</p><ul><li>Client sends request to Server</li><li>Server responds to client</li></ul><p>If we want to achieve a live chat function, where</p><ul><li>A user sends a message</li><li>All users can see the updates message immediately without refreshing the page</li></ul><p>However, server cannot send a message without a request. Sockets can solve this!</p><h2 id="Sockets">Sockets</h2><h3 id="Syntax">Syntax</h3><ul><li>Broadcast a message from server to everyone connected:</li></ul><div class="code-wrapper"><pre><code class="hljs javascript">socketManager.<span class="hljs-property">getIo</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;event_name&quot;</span>, data); <span class="hljs-comment">// shout</span></code></pre></div><ul><li>Broadcast a message to a specific client:</li></ul><div class="code-wrapper"><pre><code class="hljs javascript">socketManager.<span class="hljs-title function_">getSocketFromUserID</span>(userID).<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;eventName&quot;</span>, data); <span class="hljs-comment">// whisper</span></code></pre></div><ul><li>Listen for messages on client:</li></ul><div class="code-wrapper"><pre><code class="hljs javascript">socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;event_name&quot;</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;    <span class="hljs-comment">// do something with data</span>&#125;);</code></pre></div><ul><li>The <code>socketManager</code> class is defined for demonstration, in real life, please define by yourself.</li></ul><h3 id="Usage">Usage</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Frontend:</span><span class="hljs-keyword">const</span> <span class="hljs-title function_">Chatbook</span> = (<span class="hljs-params">props</span>) =&gt; &#123;  <span class="hljs-keyword">const</span> [activeChat, setActiveChat] = <span class="hljs-title function_">useState</span>(&#123;    <span class="hljs-attr">recipient</span>: <span class="hljs-variable constant_">ALL_CHAT</span>,    <span class="hljs-attr">messages</span>: [],  &#125;);  <span class="hljs-keyword">const</span> <span class="hljs-title function_">addMessages</span> = (<span class="hljs-params">data</span>) =&gt; &#123;    <span class="hljs-title function_">setActiveChat</span>(<span class="hljs-function"><span class="hljs-params">prevActiveChat</span> =&gt;</span> (&#123;      <span class="hljs-attr">recipient</span>: prevActiveChat.<span class="hljs-property">recipient</span>,      <span class="hljs-attr">messages</span>: prevActiveChat.<span class="hljs-property">messages</span>.<span class="hljs-title function_">concat</span>(data),    &#125;));  &#125;;  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;    socket.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;message&quot;</span>, addMessages);    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;      socket.<span class="hljs-title function_">off</span>(<span class="hljs-string">&quot;message&quot;</span>, addMessages);    &#125;;  &#125;, []);&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Backend:</span>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/message&quot;</span>, auth.<span class="hljs-property">ensureLoggedIn</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Received a chat message from <span class="hljs-subst">$&#123;req.user.name&#125;</span>: <span class="hljs-subst">$&#123;req.body.content&#125;</span>`</span>);  <span class="hljs-comment">// insert this message into the database</span>  <span class="hljs-keyword">const</span> message = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>(&#123;    <span class="hljs-attr">recipient</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">recipient</span>,    <span class="hljs-attr">sender</span>: &#123;      <span class="hljs-attr">_id</span>: req.<span class="hljs-property">user</span>.<span class="hljs-property">_id</span>,      <span class="hljs-attr">name</span>: req.<span class="hljs-property">user</span>.<span class="hljs-property">name</span>,    &#125;,    <span class="hljs-attr">content</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">content</span>,  &#125;);  message.<span class="hljs-title function_">save</span>();  socketManager.<span class="hljs-title function_">getIo</span>().<span class="hljs-title function_">emit</span>(<span class="hljs-string">&quot;message&quot;</span>, message);&#125;);</code></pre></div><p>What happens in the code:</p><ol><li>When the Chatbook component mounts, it sets up a socket listener for the “message” event using <code>useEffect</code>. <code>socket.on(&quot;message&quot;, addMessages)</code> adds <strong>a listener that calls addMessages whenever a new message is received</strong>. When the component unmounts, it calls the return statemnet: <code>socket.off(&quot;message&quot;, addMessages)</code>, which cleans up the event listener.</li><li>A user sends a POST request to the <code>/message</code> endpoint with the chat message content and recipient information.</li><li>The backend creates a new message and saves it to the database.</li><li><code>socketManager.getIo().emit(&quot;message&quot;, message)</code>: The message is emitted to all connected clients using <a href="http://Socket.io">Socket.io</a>, with data “message”.</li><li><code>socket.on(&quot;message&quot;, addMessages)</code> listener calls the addMessages function with “message” as parameter, updating the existing messages.</li></ol><ul><li>setActiveChat here can also accept a function as an argument. This function receives the previous state <code>prevActiveChat</code> as its argument.</li></ul>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>sockets</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - Authentication</title>
    <link href="/2024/07/18/MIT_Weblab/account/"/>
    <url>/2024/07/18/MIT_Weblab/account/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>Setting up account and authentication involves achieving two goals:</p><ul><li>Initial login</li><li>Staying login when making requests or refreshing pages</li></ul><h3 id="Initial-Login">Initial Login</h3><p>User send username and password to the server, however, it’s not safe to directly pass them as JSON. Using Google Authentication can help us manage the account.</p><h3 id="Session">Session</h3><ul><li>When a user logs in, the server creates a session and assigns a unique session ID to the user.</li><li>The session ID is stored on the client-side in a cookie, while the actual session data corresponding to the session ID is stored on the server</li><li>On each subsequent request, the server uses the session ID from the cookie to retrieve the session data and identify the user.</li></ul><h3 id="JWT-Json-Web-Token">JWT (Json Web Token)</h3><p>JWTs do not require server-side storage of session data.</p><ul><li>When a user logs in, the server generates a JWT containing the user’s information and sends it to the client.</li><li>Browser puts JWT in local storage. The client includes the JWT for subsequent requests.</li><li>The server verifies the token’s signature to authenticate the user.</li></ul><h2 id="How-to-Manage-Login">How to Manage Login?</h2><div style="text-align: center;">  <img src="workflow.png" style="width: 500px; height: auto;" alt="Login Workflow"></div><h3 id="Login-Frontend">Login (Frontend)</h3><p>At Frontend:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">GoogleLogin</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-google-login&quot;</span>;<span class="hljs-comment">// This identifies your web application to Google&#x27;s authentication service</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">GOOGLE_CLIENT_ID</span> = <span class="hljs-string">&quot;your-google-client-id&quot;</span>;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">GoogleLogin</span></span></span><span class="hljs-tag"><span class="language-xml">  <span class="hljs-attr">clientId</span>=<span class="hljs-string">&#123;GOOGLE_CLIENT_ID&#125;</span></span></span><span class="hljs-tag"><span class="language-xml">  <span class="hljs-attr">buttonText</span>=<span class="hljs-string">&quot;Login&quot;</span></span></span><span class="hljs-tag"><span class="language-xml">  <span class="hljs-attr">onSuccess</span>=<span class="hljs-string">&#123;handleLogin&#125;</span></span></span><span class="hljs-tag"><span class="language-xml">  <span class="hljs-attr">onFailure</span>=<span class="hljs-string">&#123;(err)</span> =&gt;</span> console.log(err)&#125;</span><span class="language-xml">  className=&quot;NavBar-link NavBar-login&quot;</span><span class="language-xml">/&gt;</span><span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogin</span> = (<span class="hljs-params">res</span>) =&gt; &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);  <span class="hljs-title function_">setLoggedIn</span>(<span class="hljs-literal">true</span>);  <span class="hljs-keyword">const</span> userToken = res.<span class="hljs-property">tokenObj</span>.<span class="hljs-property">id_token</span>;  <span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/api/login&quot;</span>, &#123; <span class="hljs-attr">token</span>: userToken &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(user);  &#125;);&#125;;</code></pre></div><ul><li>When user clicks the login button, it triggers google login process. (GoogleLogin component from the react-google-login package).</li><li><code>onSuccess={handleLogin}</code>: Triggers handleLogin function when loggin in successgully, passing response from google as the parameter.</li></ul><div style="text-align: center;"><img src="response.png" style="width: 600px; height: auto;" alt="Google Response Object"></div><ul><li>Inside <code>handleLogin</code>, It extracts the id_token from the response by <code>userToken = res.tokenObj.id_token</code> and sends it to the server via a POST request to the <code>/api/login</code> endpoint.</li></ul><h3 id="Login-Backend">Login (Backend)</h3><p>Define user schema for MongoDB:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// User.js</span><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mongoose&quot;</span>);<span class="hljs-keyword">const</span> <span class="hljs-title class_">UserSchema</span> = <span class="hljs-keyword">new</span> mongoose.<span class="hljs-title class_">Schema</span>(&#123;  <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>,  <span class="hljs-attr">googleid</span>: <span class="hljs-title class_">String</span>,&#125;);<span class="hljs-comment">// compile model from schema</span><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">&quot;user&quot;</span>, <span class="hljs-title class_">UserSchema</span>);</code></pre></div><p>The frontend passes the userToken to backend through post request.<br>Handling <code>/api/login</code> Post request by calling <code>login</code> function in the following:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">OAuth2Client</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;google-auth-library&quot;</span>);<span class="hljs-keyword">const</span> <span class="hljs-title class_">User</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./models/user&quot;</span>); <span class="hljs-comment">// Import User model</span><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CLIENT_ID</span> = <span class="hljs-string">&quot;your-google-client-id&quot;</span>;<span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OAuth2Client</span>(<span class="hljs-variable constant_">CLIENT_ID</span>);<span class="hljs-keyword">function</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">req, res</span>) &#123;  <span class="hljs-title function_">verify</span>(req.<span class="hljs-property">body</span>.<span class="hljs-property">token</span>)    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> <span class="hljs-title function_">getOrCreateUser</span>(user))    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Logged in as <span class="hljs-subst">$&#123;user.name&#125;</span>`</span>);      <span class="hljs-comment">// persist user in the session</span>      req.<span class="hljs-property">session</span>.<span class="hljs-property">user</span> = user;      res.<span class="hljs-title function_">send</span>(user);    &#125;)    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Failed to log in: <span class="hljs-subst">$&#123;err&#125;</span>`</span>);      res.<span class="hljs-title function_">status</span>(<span class="hljs-number">401</span>).<span class="hljs-title function_">send</span>(&#123; err &#125;);    &#125;);&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">verify</span>(<span class="hljs-params">token</span>) &#123;  <span class="hljs-keyword">return</span> client    .<span class="hljs-title function_">verifyIdToken</span>(&#123;      <span class="hljs-attr">idToken</span>: token,      <span class="hljs-attr">audience</span>: <span class="hljs-variable constant_">CLIENT_ID</span>,    &#125;)    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ticket</span>) =&gt;</span> ticket.<span class="hljs-title function_">getPayload</span>());&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">getOrCreateUser</span>(<span class="hljs-params">user</span>) &#123;  <span class="hljs-comment">// the &quot;sub&quot; field means &quot;subject&quot;, which is a unique identifier for each user</span>  <span class="hljs-keyword">return</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findOne</span>(&#123; <span class="hljs-attr">googleid</span>: user.<span class="hljs-property">sub</span> &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">existingUser</span>) =&gt;</span> &#123;    <span class="hljs-keyword">if</span> (existingUser) <span class="hljs-keyword">return</span> existingUser;    <span class="hljs-keyword">const</span> newUser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(&#123;      <span class="hljs-attr">name</span>: user.<span class="hljs-property">name</span>,      <span class="hljs-attr">googleid</span>: user.<span class="hljs-property">sub</span>,    &#125;);    <span class="hljs-keyword">return</span> newUser.<span class="hljs-title function_">save</span>();  &#125;);&#125;</code></pre></div><ul><li>The <code>login</code> function calls the <code>verify</code> function to validate the token with Google.</li><li>The <code>login</code> function then calls <code>getOrCreateUser</code>. This function checks if the user already exists in the database using the googleid. If the user exists, it returns the existing user; if not, it creates a new user in the database.</li><li>Then, the login function stores the user information in the session by <code>req.session.user = user</code>.</li><li>sends the user data back to the client.</li></ul><h3 id="req-session-and-authenticating-following-requests">req.session and authenticating following requests</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// In server.js</span><span class="hljs-keyword">const</span> session = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;express-session&quot;</span>);app.<span class="hljs-title function_">use</span>(  <span class="hljs-title function_">session</span>(&#123;    <span class="hljs-attr">secret</span>: <span class="hljs-string">&quot;session-secret&quot;</span>,    <span class="hljs-attr">resave</span>: <span class="hljs-literal">false</span>,    <span class="hljs-attr">saveUninitialized</span>: <span class="hljs-literal">false</span>,  &#125;));<span class="hljs-keyword">const</span> auth = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./auth&#x27;</span>);app.<span class="hljs-title function_">use</span>(auth.<span class="hljs-property">populateCurrentUser</span>);<span class="hljs-comment">// In auth.js</span><span class="hljs-keyword">function</span> <span class="hljs-title function_">populateCurrentUser</span>(<span class="hljs-params">req, res, next</span>) &#123;  req.<span class="hljs-property">user</span> = req.<span class="hljs-property">session</span>.<span class="hljs-property">user</span>;  <span class="hljs-title function_">next</span>();&#125;</code></pre></div><ul><li><p><code>app.use(session({...}))</code>:</p></li><li><p>This middleware sets up and manages sessions in an Express application.</p></li><li><p>It uses a server-side storage mechanism to store session data.</p></li><li><p>It creates a session ID, which is stored in a cookie on the client side.</p></li><li><p>Previously, we do <code>req.session.user = user</code>, the following happens:</p></li><li><p>The <code>express-session</code> middleware stores the user object in the session data associated with the current session on server side.</p></li><li><p>The session middleware ensures that a cookie containing the <code>session ID</code> is sent to the client’s browser.</p></li><li><p>For every subsequent request, the browser automatically includes the session ID cookie in the request headers. <strong>The session middleware parses the session ID from the client’s cookie, retrieves the session data, and attaches it to req.session</strong>. As a result, req.session is automatically filled by the <code>user</code> document that we previously stored in session.</p></li><li><p><code>populateCurrentUser</code> middleware: The populateCurrentUser middleware sets req.user to the user data from req.session.user for each following request.</p></li></ul><h3 id="Stay-Logged-In-At-Frontend">Stay Logged In At Frontend</h3><p>Now, since the session ID is in my browser’s cookie, everytime I make a request, <strong>as long as the cookies exist, my <code>req.user</code> will be set as the user that I previously logged in</strong>.<br>To let frontend know that I am currently logged in, we can send a get request to backend, then backend checks <code>req.user</code> and sends back.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// At Frontend:</span><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/api/whoami&quot;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> &#123;      <span class="hljs-keyword">if</span> (user.<span class="hljs-property">_id</span>) &#123;        <span class="hljs-title function_">setLoggedIn</span>(<span class="hljs-literal">true</span>);      &#125;    &#125;)&#125;, []);<span class="hljs-comment">// At Backend:</span>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/whoami&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  <span class="hljs-keyword">if</span> (req.<span class="hljs-property">user</span>) &#123;    res.<span class="hljs-title function_">send</span>(req.<span class="hljs-property">user</span>);  &#125; <span class="hljs-keyword">else</span> &#123;    res.<span class="hljs-title function_">send</span>(&#123;&#125;);  &#125;&#125;);</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>JWT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dynamic Programming</title>
    <link href="/2024/07/15/Leetcode/dp/"/>
    <url>/2024/07/15/Leetcode/dp/</url>
    
    <content type="html"><![CDATA[<h2 id="DP-and-Backtracking">DP and Backtracking</h2><p>Many DP problems can be also solved by backtracking algorithm.</p><h3 id="LC-416">LC 416</h3><p>Given an integer array nums, return true if you can partition the array into two subsets such that the sum of the elements in both subsets is equal or false otherwise.</p><ul><li>Solution using backtracking (recursion):</li></ul><div class="code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">canPartition</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;        <span class="hljs-type">boolean</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> backtrack(nums, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);        <span class="hljs-keyword">return</span> result;    &#125;    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">backtrack</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums, <span class="hljs-type">int</span> index, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span> &#123;        <span class="hljs-keyword">if</span> (index == nums.length &amp;&amp; left == right) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (index == nums.length) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;        &#125;        <span class="hljs-type">boolean</span> <span class="hljs-variable">includeLeft</span> <span class="hljs-operator">=</span> backtrack(nums, index+<span class="hljs-number">1</span>, left+nums[index], right);        <span class="hljs-type">boolean</span> <span class="hljs-variable">includeRight</span> <span class="hljs-operator">=</span> backtrack(nums, index+<span class="hljs-number">1</span>, left, right+nums[index]);        <span class="hljs-keyword">return</span> includeLeft || includeRight;    &#125;&#125;</code></pre></div><ul><li>Idea: Our goal is to partition the array into two subsets, naming them “left” and “right” respectively. For each number in the array, it is either in the “left” subset or “right” subset. We explore all possibilities using recursion.</li><li>Complexity: <code>O(2^n)</code>. Thinking about a tree, each node is a backtrack function. The tree is of depth <code>n</code>, each node takes <code>O(1)</code> time.</li><li>Solution using dynamic programming:</li></ul><p>Transform the solution to knapsack problem: achieve <code>sum/2</code> using elements in an array.</p><div class="code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">canPartition</span><span class="hljs-params">(<span class="hljs-type">int</span>[] nums)</span> &#123;        <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : nums) &#123;            sum += num;        &#125;        <span class="hljs-keyword">if</span> (sum % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;        <span class="hljs-type">int</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> sum / <span class="hljs-number">2</span>;        <span class="hljs-type">boolean</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">boolean</span>[target+<span class="hljs-number">1</span>];        dp[<span class="hljs-number">0</span>] = <span class="hljs-literal">true</span>;        <span class="hljs-keyword">if</span> (nums[<span class="hljs-number">0</span>] &lt; target) &#123;            dp[nums[<span class="hljs-number">0</span>]] = <span class="hljs-literal">true</span>;        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; nums.length; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> target; j &gt;= nums[i]; j--) &#123;                dp[j] = dp[j] || dp[j-nums[i]];            &#125;        &#125;        <span class="hljs-keyword">return</span> dp[target];    &#125;&#125;</code></pre></div><ul><li><code>dp[i][j]</code> is boolean, representing whether summation j can be achieved using indexes 0, 1, …, i.</li><li>If <code>nums[i]</code> is used to achieve the summation j, then <code>dp[i-1][j-nums[i]]</code> must be true. If <code>nums[i]</code> is not used to achieve the summation, then <code>dp[i-1][j]</code> must be true.</li><li>Complexity: <code>O(nW)</code>, where n is array size, W is array summation.</li></ul><h2 id="Optimize-Space-Complexity">Optimize Space Complexity</h2><h3 id="Knapsack-Problem">Knapsack Problem</h3><p>Given bag space N, what is the most valuable way to put items in the bag? One Item can be used only once.</p><div class="code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// 2D array</span><span class="hljs-comment">// DP[i][j]: most valuable combination of items for space j using items 0-i.</span><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">solve</span><span class="hljs-params">(<span class="hljs-type">int</span> M, <span class="hljs-type">int</span> N, <span class="hljs-type">int</span>[] spaces, <span class="hljs-type">int</span>[] values)</span> &#123;    <span class="hljs-type">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[M+<span class="hljs-number">1</span>][N+<span class="hljs-number">1</span>];    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> spaces[<span class="hljs-number">0</span>]; j &lt;= N; j++) &#123;        dp[<span class="hljs-number">0</span>][j] = values[<span class="hljs-number">0</span>];    &#125;    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= M; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= N; j++) &#123;            <span class="hljs-keyword">if</span> (j &gt;= spaces[i-<span class="hljs-number">1</span>]) &#123;                dp[i][j] = Math.max(dp[i-<span class="hljs-number">1</span>][j], dp[i-<span class="hljs-number">1</span>][j-spaces[i-<span class="hljs-number">1</span>]] + values[i-<span class="hljs-number">1</span>]);            &#125; <span class="hljs-keyword">else</span> &#123;                dp[i][j] = dp[i-<span class="hljs-number">1</span>][j];            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[M][N];&#125;</code></pre></div><p>Use 1D array to solve this:</p><div class="code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">solve</span><span class="hljs-params">(<span class="hljs-type">int</span> M, <span class="hljs-type">int</span> N, <span class="hljs-type">int</span>[] spaces, <span class="hljs-type">int</span>[] values)</span> &#123;    <span class="hljs-type">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[N+<span class="hljs-number">1</span>];            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> spaces[<span class="hljs-number">0</span>]; i &lt; N+<span class="hljs-number">1</span>; i++) &#123;        dp[i] = values[<span class="hljs-number">0</span>];    &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; M; i++) &#123;        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> N; j &gt;= <span class="hljs-number">1</span>; j--) &#123; <span class="hljs-comment">// iterate from N to 1!</span>            <span class="hljs-keyword">if</span> (j &gt;= spaces[i]) &#123;                <span class="hljs-type">int</span> <span class="hljs-variable">takei</span> <span class="hljs-operator">=</span> dp[j-spaces[i]] + values[i];                <span class="hljs-type">int</span> <span class="hljs-variable">dtakei</span> <span class="hljs-operator">=</span> dp[j];                dp[j] = Math.max(takei, dtakei);            &#125; <span class="hljs-keyword">else</span> &#123;                dp[j] = dp[j];            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> dp[N];&#125;</code></pre></div><ul><li>In 2D case, each row depends on the values from previous row.</li><li><code>dp[i][j]</code> depends on <code>dp[i-1][j]</code> and <code>dp[i-1][j-spaces[i-1]]</code>, i.e., one top value, one top-left value.</li><li>As a result, in 1D case, update the <code>dp</code> array from right to left.</li></ul><h3 id="When-to-update-from-left-to-right-LC-518">When to update from left to right? (LC 518)</h3><p>You are given an integer array coins representing coins of different denominations and an integer amount representing a total amount of money.</p><p>Return the number of combinations that make up that amount. If that amount of money cannot be made up by any combination of the coins, return 0.</p><p>You may assume that you have an infinite number of each kind of coin.</p><div class="code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">change</span><span class="hljs-params">(<span class="hljs-type">int</span> amount, <span class="hljs-type">int</span>[] coins)</span> &#123;        <span class="hljs-type">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[coins.length][amount+<span class="hljs-number">1</span>];        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; coins.length; i++)&#123;            dp[i][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> coins[<span class="hljs-number">0</span>]; j &lt;= amount; j++)&#123;            dp[<span class="hljs-number">0</span>][j] += dp[<span class="hljs-number">0</span>][j-coins[<span class="hljs-number">0</span>]];        &#125;                <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; coins.length; i++)&#123;            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= amount; j++)&#123;                <span class="hljs-keyword">if</span>(j &lt; coins[i]) dp[i][j] = dp[i-<span class="hljs-number">1</span>][j];                <span class="hljs-keyword">else</span> dp[i][j] = dp[i][j-coins[i]] + dp[i-<span class="hljs-number">1</span>][j];            &#125;        &#125;        <span class="hljs-keyword">return</span> dp[coins.length-<span class="hljs-number">1</span>][amount];    &#125;&#125;</code></pre></div><ul><li>Updation: <code>dp[i][j] = dp[i][j-coins[i]] + dp[i-1][j]</code>, which depends on both <code>previous row</code> and <code>current row but previous column</code>.</li></ul><div class="code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// solution using 1D array</span><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span> &#123;    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">change</span><span class="hljs-params">(<span class="hljs-type">int</span> amount, <span class="hljs-type">int</span>[] coins)</span> &#123;        <span class="hljs-type">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[amount+<span class="hljs-number">1</span>];        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; amount+<span class="hljs-number">1</span>; i++) &#123;            <span class="hljs-keyword">if</span> (i % coins[<span class="hljs-number">0</span>] == <span class="hljs-number">0</span>) dp[i] = <span class="hljs-number">1</span>;        &#125;        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; coins.length; i++) &#123;            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> coins[i]; j &lt;= amount; j++) &#123;                dp[j] += dp[j-coins[i]];            &#125;        &#125;        <span class="hljs-keyword">return</span> dp[amount];    &#125;&#125;</code></pre></div><ul><li>At iteration i, dp[j] is the number of combinations that make up amount j, using coins with indexes 0-i.</li><li>Because solution using 2D array uses <code>dp[i][j] = dp[i][j-coins[i]] + dp[i-1][j]</code>, so in 1D array, we update from left to right so that <code>dp[j]</code> uses the <code>dp[j-coins[i]]</code> from the same row.</li></ul>]]></content>
    
    
    <categories>
      
      <category>Leetcode</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Dynamic Programming</tag>
      
      <tag>leetcode</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - MongoDB</title>
    <link href="/2024/07/15/MIT_Weblab/mongodb/"/>
    <url>/2024/07/15/MIT_Weblab/mongodb/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><h3 id="Why-Use-Databse-in-Web-Development">Why Use Databse in Web Development?</h3><ol><li>Store data persistently</li><li>Fast read and write speed</li><li>Concurrency issues</li><li>Data security</li></ol><h3 id="Relational-Database-SQL-and-Document-Database-NoSQL">Relational Database (SQL) and Document Database (NoSQL)</h3><p>Databases are generally categorized into two types: Relational Databases (SQL) and Document Databases (NoSQL).</p><ul><li>Relational Database: Store data in tables. e.g., MySQL, PostgreSQL.</li><li>Document Database: Store data as documents (like JSON objects). e.g. MongoDB</li></ul><h3 id="Interact-with-Database">Interact with Database</h3><ul><li><p>Get</p>  <div style="text-align: left;">    <img src="relation1.png" style="width: 500px; height: auto;" alt="Get Request Diagram">  </div></li><li><p>Post</p>  <div style="text-align: left;">    <img src="relation2.png" style="width: 500px; height: auto;" alt="Post Request Diagram">  </div></li></ul><h2 id="MongoDB">MongoDB</h2><h3 id="Core-Concepts">Core Concepts</h3><ul><li>Database: A container for collections.</li><li>Collection: A group of MongoDB documents, akin to a table in SQL.</li><li>Document: A record in a collection, stored in Binary JSON format, allowing nested structures and arrays, like a row in a table.</li><li>Field: A key-value pair within a document.</li><li>ObjectId: The default primary key for a MongoDB document (_id field), automatically generated.</li></ul><h3 id="Connect-to-MongoDB">Connect to MongoDB</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// server.js</span><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mongoose&quot;</span>); <span class="hljs-comment">// import mongoose</span><span class="hljs-keyword">const</span> mongoConnectionURL = <span class="hljs-string">&quot;mongodb+srv://USERNAME:PASSWORD@DB.mongodb.net/test?retryWrites=true&quot;</span>;<span class="hljs-keyword">const</span> databaseName = <span class="hljs-string">&quot;someDatabaseName&quot;</span>;<span class="hljs-keyword">const</span> options = &#123;  <span class="hljs-attr">useNewUrlParser</span>: <span class="hljs-literal">true</span>,  <span class="hljs-attr">useUnifiedTopology</span>: <span class="hljs-literal">true</span>,  <span class="hljs-attr">dbName</span>: databaseName,&#125;;mongoose.<span class="hljs-title function_">connect</span>(mongoConnectionURL, options)  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Connected.&quot;</span>))  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Error connecting to MongoDB: <span class="hljs-subst">$&#123;error&#125;</span>`</span>));</code></pre></div><ul><li>mongoose: A NodeJS library that allows MongoDB integration</li></ul><h3 id="Schemas-and-Models">Schemas and Models</h3><ul><li>Schemas define the structure of your documents</li><li>Define the keys and types of the values corresponding to the keys</li><li>Schema Types: String, Number, Date, Buffer, Boolean, Mixed, ObjectId, Array</li><li>Models is responsible for creating and reading documents from the database</li></ul><p>Example:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;mongoose&quot;</span>);<span class="hljs-keyword">const</span> <span class="hljs-title class_">StudentSchema</span> = <span class="hljs-keyword">new</span> mongoose.<span class="hljs-title class_">Schema</span>(&#123;  <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>,  <span class="hljs-attr">age</span>: <span class="hljs-title class_">Number</span>,  <span class="hljs-attr">classes</span>: [<span class="hljs-title class_">String</span>], <span class="hljs-comment">// the type of the elements inside an array should also be specified</span>&#125;);<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">&quot;ModelName&quot;</span>, <span class="hljs-title class_">StudentSchema</span>);</code></pre></div><ul><li>Usually Define one Schema and Model per file, and export the model</li></ul><h3 id="Find-Document">Find Document</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// In backend:</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">Story</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./models/story&quot;</span>); <span class="hljs-comment">// import the model</span><span class="hljs-keyword">const</span> emptyQuery = &#123;&#125;; <span class="hljs-comment">// empty query: return all documents</span><span class="hljs-keyword">const</span> query = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Tim&quot;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">21</span> &#125;; <span class="hljs-comment">// return all documents with name Tim and age 21</span>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/stories&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  <span class="hljs-title class_">Story</span>.<span class="hljs-title function_">find</span>(emptyQuery).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">allStories</span>) =&gt;</span> &#123;    <span class="hljs-comment">// return an array of documents</span>    res.<span class="hljs-title function_">send</span>(allStories);  &#125;)&#125;);router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/comment&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  <span class="hljs-title class_">Comment</span>.<span class="hljs-title function_">find</span>(&#123; <span class="hljs-attr">parent</span>: req.<span class="hljs-property">query</span>.<span class="hljs-property">parent</span> &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">comments</span>) =&gt;</span> &#123;    res.<span class="hljs-title function_">send</span>(comments);  &#125;);&#125;);</code></pre></div><ul><li><code>find(query)</code> returns an array.</li><li><code>findOne(query)</code>: returns only one document that matches the query.</li><li><code>someModel.find()</code> retuens a promise, which is the finding result, and we can use <code>.then()</code> to handle it.</li></ul><h3 id="Save-Document">Save Document</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// In backend:</span><span class="hljs-keyword">const</span> <span class="hljs-title class_">Comment</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./models/comment&quot;</span>);router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/comment&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> newComment = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Comment</span>(&#123;    <span class="hljs-attr">creator_name</span>: myName,    <span class="hljs-attr">parent</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">parent</span>,    <span class="hljs-attr">content</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">content</span>,  &#125;);  newComment.<span class="hljs-title function_">save</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">comment</span>) =&gt;</span> res.<span class="hljs-title function_">send</span>(comment));&#125;);</code></pre></div><ul><li>We can create a new document by <code>const newDocument = new ModelName({parameters})</code>.</li><li><code>newDocument.save()</code> returns a promise. This promise resolves to the document that was saved to the database.</li><li>Every document is automatically assigned a unique identifier, the identifier is assigned under the “_id” field. How to utilize “_id”?</li><li>At Frontend, get document get queries.</li><li>Backend calls <code>find()</code> and send the result to frontend.</li><li>Frontend retrieves and passes the “_id” of one object (one document in database) by</li></ul><div class="code-wrapper"><pre><code class="hljs javascript">&lt;<span class="hljs-title class_">Card</span>  key=&#123;<span class="hljs-string">`Card_<span class="hljs-subst">$&#123;storyObj._id&#125;</span>`</span>&#125;   <span class="hljs-comment">// retrieve the _id from obj, which is the _id generated by MongoDB</span>  _id=&#123;storyObj.<span class="hljs-property">_id</span>&#125;   creator_name=&#123;storyObj.<span class="hljs-property">creator_name</span>&#125;  content=&#123;storyObj.<span class="hljs-property">content</span>&#125;  /&gt;</code></pre></div><ul><li>Pass the “_id” to the get query to retrieve related objects</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/api/comment&quot;</span>, &#123; <span class="hljs-attr">parent</span>: props.<span class="hljs-property">_id</span> &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">comments</span>) =&gt;</span> &#123;    <span class="hljs-title function_">setComments</span>(comments);  &#125;);</code></pre></div><h3 id="Delete-Document">Delete Document</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Student</span>.<span class="hljs-title function_">deleteOne</span>(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Alice&quot;</span> &#125;)  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Deleted&quot;</span>))  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Error: <span class="hljs-subst">$&#123;error&#125;</span>`</span>));<span class="hljs-title class_">Student</span>.<span class="hljs-title function_">deleteMany</span>(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Alice&quot;</span> &#125;)   .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">student</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Deleted many documents&quot;</span>));  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Error: <span class="hljs-subst">$&#123;error&#125;</span>`</span>));</code></pre></div><h3 id="Update">Update</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Student</span>.<span class="hljs-title function_">findOne</span>(query)   .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">student</span>) =&gt;</span> &#123;     student.<span class="hljs-property">fieldToUpdate</span> = newValue;     student.<span class="hljs-title function_">save</span>()   &#125;);</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>MongoDB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - Asynchronous Control</title>
    <link href="/2024/07/15/MIT_Weblab/async-control/"/>
    <url>/2024/07/15/MIT_Weblab/async-control/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><ul><li>Synchronous: Happening consecutively, one after another.</li><li>Asynchronous: Multiple processes can run at the same time.</li></ul><h2 id="Node-js">Node.js</h2><p>Node.js is an open-source, cross-platform JavaScript runtime environment that executes JavaScript code outside of a web browser.</p><ul><li>Single-Threaded Event Loop: Unlike traditional multi-threaded servers that spawn a new thread for each client, Node.js uses a single-threaded event loop to manage all client connections. The Event Loop continuously checks the event queue to see if there are any events to be handled.</li><li>Non-blocking I/O: Node.js performs I/O operations (like reading from a database) asynchronously. Instead of waiting for the operation to complete, Node.js registers a callback and moves on to handle the next event. This non-blocking behavior ensures that Node.js can handle many I/O operations concurrently without getting bogged down by slow operations</li></ul><h2 id="then">.then()</h2><h3 id="syntax">syntax</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> myStories = <span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/stories&#x27;</span>);<span class="hljs-title function_">setStories</span>(myStories);</code></pre></div><ul><li>the <code>get()</code> function returns a promise.</li><li><code>myStories</code> is a promise object immediately after this line runs. The promise represents an operation that hasn’t completed yet. JavaScript continues executing subsequent code without waiting for the promise to resolve.</li><li>setstories is called immediately with the promise <code>myStories</code>, not with the actual data that the promise will resolve to.</li></ul><p>Correct handling:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/stories&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">stories</span>) =&gt;</span> &#123;  <span class="hljs-title function_">setStories</span>(stories);&#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error.<span class="hljs-property">message</span>);&#125;);</code></pre></div><p><code>.then((stories) =&gt; { ... })</code> sets up a handler that waits for the promise to resolve.</p><ul><li>If promise fulfilled, execute .then().</li><li>If promise rejected, execute .catch().</li></ul><h3 id="Async-of-promises">Async of promises</h3><p>Promises let us keep running other code:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;  <span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/stories&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">stories</span>) =&gt;</span> &#123;    <span class="hljs-title function_">setStories</span>(stories);  &#125;)  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;do thing 1&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;do thing 2&quot;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;do thing 3&quot;</span>);&#125;, []);</code></pre></div><ul><li>These <code>console.log</code> statements execute synchronously, meaning they run immediately after the API request is initiated but before the promise resolves.</li><li>When the <code>get</code> function is called, it returns a promise and initiates the asynchronous operation to fetch data. JavaScript does not wait for this operation to complete. Instead, it continues executing the subsequent lines of code immediately. This is known as non-blocking behavior.</li></ul><h3 id="Handling-multiple-promises">Handling multiple promises</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> promise1 = <span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/comments&#x27;</span>, &#123; <span class="hljs-attr">parent</span>: parentId1 &#125;);<span class="hljs-keyword">const</span> promise2 = <span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/comments&#x27;</span>, &#123; <span class="hljs-attr">parent</span>: parentId2 &#125;);<span class="hljs-keyword">const</span> promise3 = <span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/comments&#x27;</span>, &#123; <span class="hljs-attr">parent</span>: parentId3 &#125;);<span class="hljs-keyword">const</span> promise4 = <span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/comments&#x27;</span>, &#123; <span class="hljs-attr">parent</span>: parentId4 &#125;);<span class="hljs-keyword">const</span> promise5 = <span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/comments&#x27;</span>, &#123; <span class="hljs-attr">parent</span>: parentId5 &#125;);<span class="hljs-keyword">const</span> promises = [promise1, promise2, promise3, promise4, promise5];<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">allResults</span>) =&gt;</span> &#123;  <span class="hljs-comment">// allResults represent a list with the result of each promise</span>&#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;  <span class="hljs-comment">// Catch and report any error</span>&#125;);</code></pre></div><ul><li>Returns a promise that resolves to array of results of input promises</li><li><strong>allResults</strong> represent a <strong>list</strong> with the result of each promise</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">race</span>(promises).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">firstResult</span>) =&gt;</span> &#123;  <span class="hljs-comment">// Do something with the first result</span>&#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;  <span class="hljs-comment">// Catch and report any error</span>&#125;);</code></pre></div><ul><li>Return a single Promise</li><li>This returned promise settles as soon as any of the promises in the iterable (list in this example) settles (either fulfills or rejects).</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">any</span>(promises).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">anyResult</span>) =&gt;</span> &#123;  <span class="hljs-comment">// Do something with the first fullfilled promise</span>&#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;  <span class="hljs-comment">// Catch and report any error</span>&#125;);</code></pre></div><ul><li>Return a sinfle Promise</li><li>This returned promise fulfills as soon as any of the promises in the iterable fulfills</li></ul><h2 id="await-and-async-keywords">await and async keywords</h2><ul><li>async function: declare a function to return a Promise.</li><li><strong>Only asynchronous functions can use await</strong>. Asynchronous function is defined by <code>async</code> keyword. Asynchronous functions return control back to the caller before computation is done.</li><li>await waits for the promise to resolve and uses that value</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">myFunction</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Start&#x27;</span>);  <span class="hljs-keyword">const</span> data1 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-string">&#x27;url1&#x27;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Data 1:&#x27;</span>, data1);  <span class="hljs-keyword">const</span> data2 = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchData</span>(<span class="hljs-string">&#x27;url2&#x27;</span>);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Data 2:&#x27;</span>, data2);  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;End&#x27;</span>);&#125;<span class="hljs-title function_">myFunction</span>();<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;After myFunction call&#x27;</span>);</code></pre></div><ul><li>When await is used, <strong>it pauses the execution of the async function</strong> until the awaited promise is resolved or rejected. This means that the lines of code following the await will not execute until the promise is settled. <strong>This “pause” is local to the async function where await is used.</strong></li><li>While the async function is paused, the rest of the JavaScript (outside the specific function) code can continue to run, i.e., <code>console.log('After myFunction call');</code>. This means other tasks, events, and functions can continue to execute, keeping the overall program responsive.</li></ul>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - Advanced CSS</title>
    <link href="/2024/07/14/MIT_Weblab/css/"/>
    <url>/2024/07/14/MIT_Weblab/css/</url>
    
    <content type="html"><![CDATA[<h2 id="CSS-Combinators">CSS Combinators</h2><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;child&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;c1&quot;</span>&gt;</span>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>child 1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;child&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;c2&quot;</span>&gt;</span>child 2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;child&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;c3&quot;</span>&gt;</span>child 3<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;child&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;c4&quot;</span>&gt;</span>child 4<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><h3 id="Descendent-Selector">Descendent Selector</h3><p>Selects all elements that are descendants (children, grandchildren, etc.) of a specified element:<br>All <code>&lt;div&gt;</code> inside class container, which are child 1, 2, 3, 4</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> <span class="hljs-selector-tag">div</span> &#123;    <span class="hljs-attribute">color</span>: blue; &#125;</code></pre></div><h3 id="Child-Selector">Child Selector</h3><p>Only direct <code>&lt;div&gt;</code> children of class container, which are child 2, 3, 4</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &gt; <span class="hljs-selector-tag">div</span> &#123;    <span class="hljs-attribute">color</span>: blue; &#125;</code></pre></div><h3 id="Adjacent-Sibling-Selector">Adjacent Sibling Selector</h3><p>First div sibling after id c1, which are child 2</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-id">#c1</span> + <span class="hljs-selector-tag">div</span> &#123;    <span class="hljs-attribute">color</span>: blue; &#125;</code></pre></div><h3 id="General-Sibling-Selector">General Sibling Selector</h3><p>All div elements that are siblings of an id c1, which are child 2, 3, 4</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-id">#c1</span> ~ <span class="hljs-selector-tag">div</span> &#123;    <span class="hljs-attribute">color</span>: blue;&#125;</code></pre></div><h2 id="Display-Types">Display Types</h2><h3 id="Block">Block</h3><p>Block makes an element behave as a block-level element. Some elements have <code>display: block</code> by default: <code>&lt;div&gt;</code>, <code>&lt;p&gt;</code>, <code>&lt;h1&gt;</code> to <code>&lt;h6&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;section&gt;</code>, <code>&lt;nav&gt;</code></p><h3 id="Inline">Inline</h3><p>Inline elements do not start on a new line; they only take up as much width as necessary and can sit next to each other horizontally. <code>&lt;span&gt;</code>, <code>&lt;a&gt;</code>, <code>&lt;img&gt;</code> are inline by default.</p><h3 id="Flex">Flex</h3><p>Flex is a flexible box. It can control direction, sizing, distribution. All direct children of a flexible container becomes flexible items. <a href="https://www.w3schools.com/css/css3_flexbox_items.asp">See this demo</a>.</p><h3 id="Grid">Grid</h3><p>Grid containers consist of grid items, placed inside columns and rows. <a href="https://www.w3schools.com/css/css_grid_container.asp">See this demo</a>.</p><h3 id="None">None</h3><p>Tells the browser to remove an element from the document. Different from <code>visibility: hidden</code>, which hides the element but still takes up space in the layout.</p><h2 id="Content-Overflow">Content Overflow</h2><p>The overflow property specifies whether to <strong>clip the content</strong> or to <strong>add scrollbars</strong> when the content of an element is too big to fit in the specified area. <a href="https://www.w3schools.com/css/css_overflow.asp">see the demo</a>.</p><h2 id="Animations">Animations</h2><p>Syntax: use percentages to specify intermediate steps</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-keyword">@keyframes</span> animation-name &#123;  <span class="hljs-number">0%</span> &#123;    <span class="hljs-comment">/* initial styles */</span>  &#125;  <span class="hljs-number">50%</span> &#123;    <span class="hljs-comment">/* intermediate styles */</span>  &#125;  <span class="hljs-number">100%</span> &#123;    <span class="hljs-comment">/* final styles */</span>  &#125;&#125;</code></pre></div><p>Example:</p><div class="code-wrapper"><pre><code class="hljs css">&lt;<span class="hljs-selector-tag">div</span> class=&quot;<span class="hljs-attribute">container</span>&quot;&gt;  &lt;<span class="hljs-selector-tag">p</span>&gt; balabala &lt;/<span class="hljs-selector-tag">p</span>&gt;&lt;/<span class="hljs-selector-tag">div</span>&gt;<span class="hljs-selector-class">.container</span> &#123;  <span class="hljs-attribute">animation</span>: fadeIn;  <span class="hljs-attribute">animation-duration</span>: <span class="hljs-number">5s</span>;  <span class="hljs-attribute">animation-delay</span>: <span class="hljs-number">2s</span>;&#125;<span class="hljs-keyword">@keyframes</span> fadeIn &#123;  <span class="hljs-number">0%</span> &#123;    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;  &#125;  <span class="hljs-number">100%</span> &#123;    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;  &#125;&#125;</code></pre></div><ul><li>opacity changes from 0 to 1 in 5s, after 2s.</li></ul>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>KMP Algorithm</title>
    <link href="/2024/07/07/MIT_Weblab/kmp/"/>
    <url>/2024/07/07/MIT_Weblab/kmp/</url>
    
    <content type="html"><![CDATA[<p>Leetcode 28:</p><p>Given two strings <code>needle</code> and <code>haystack</code>, return the index of the first occurrence of needle in <code>haystack</code>, or -1 if <code>needle</code> is not part of <code>haystack</code>.</p><h2 id="Introduction">Introduction</h2><p>Suppose text is <code>abbbbbbbbbbc</code>, and pattern is <code>abbbc</code>, to find the index of the first match, we start matching on index 0, 1, 2, …. The time complexity if <code>O(mn)</code>, where m is the length of text and n is the length of pattern.</p><div style="text-align: center;">  <img src="demo1.png" style="width: 300px; height: auto;" alt="Brute Force Approach"></div><h3 id="Why-KMP">Why KMP</h3><p>Observation: When there is a mismatch at index 4, and all characters match for previous indexes, where do we start the next match?</p><ul><li>In the pattern string, the first character <code>a</code> is not contained in index 1 ~ 3.</li><li>We have checked that index 0 ~ 3 is matched (same) for text and pattern string.</li><li>As a result, <code>a</code> will not appear in the index 1 ~ 3 at the text string, and we don’t need to re-match at index 1.</li></ul><p>Bad next match:</p><div style="text-align: center;">  <img src="demo3.png" style="width: 300px; height: auto;" alt="Bad Next Match"></div><p>We can re-match at the index 4, because there is no <code>a</code> for index 1 ~ 3 at text string.</p><div style="text-align: center;">  <img src="demo2.png" style="width: 300px; height: auto;" alt="Correct Next Match"></div><h3 id="Another-Example">Another Example</h3><p>Let’s see another example:</p><div style="text-align: center;">  <img src="ano1.png" style="width: 300px; height: auto;" alt="Another Example Start"></div><p>There is a mismatch at index 9:</p><div style="text-align: center;">  <img src="ano.png" style="width: 300px; height: auto;" alt="Mismatch at Index 9"></div><ul><li>The previous pattern: <code>abcxxab</code> matches the text, and mismatches occurs at index 9.</li><li>For the string before the mismatch index: <code>abcxxab</code>, there is a repeated pattern <code>ab</code>: <code>ab</code> occurs at the first two index and the last 2 index.</li><li>If we rematch at the index of the mismatch, we might lose a chance to get a full-match because the first two indexes of the pattern string, <code>ab</code>, also matches the <code>ab</code> at index 7 and 8 in the text string.</li><li>We rematch at the index 2 of the pattern string.</li></ul><div style="text-align: center;">  <img src="ano3.png" style="width: 300px; height: auto;" alt="Rematch Strategy"></div><h3 id="How-do-we-know-where-to-start-re-match">How do we know where to start re-match?</h3><p>Observe the previous example, we find that:</p><div style="text-align: center;">  <img src="exp.png" style="width: 300px; height: auto;" alt="Explanation"></div><ul><li><code>pattern[0:7]</code> matches <code>text[2:9]</code>, the index 9 does not match.</li><li>In pattern shring, <code>ab</code> is repeated in <code>abcxxab</code>.</li><li>As a result, <code>pattern[0:1]</code> matches <code>pattern[-2:0]</code>, which also matches <code>text[7:8]</code>.</li><li>We rematch for <code>pattern[2]</code> and <code>text[9]</code>.</li></ul><h2 id="Construct-“next”-Array">Construct “next” Array</h2><p>We need an array to indicate where to start re-matching if a mismatch occurs.</p><div style="text-align: center;">  <img src="next.png" style="width: 300px; height: auto;" alt="Next Array"></div><div class="code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span>[] getNext(<span class="hljs-type">char</span>[] strArr) &#123;    <span class="hljs-type">int</span>[] next = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[strArr.length];    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;    <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (j &lt; strArr.length) &#123;        <span class="hljs-keyword">if</span> (strArr[i] == strArr[j]) &#123;            next[j] = i+<span class="hljs-number">1</span>;            i++;            j++;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">if</span> (i == <span class="hljs-number">0</span>) &#123;                next[j] = i;                j++;            &#125; <span class="hljs-keyword">else</span> &#123;                i = next[i-<span class="hljs-number">1</span>];            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> next;&#125;</code></pre></div><h2 id="Match">Match</h2><div class="code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">strStr</span><span class="hljs-params">(String haystack, String needle)</span> &#123;    <span class="hljs-type">char</span>[] haystackArr = haystack.toCharArray();    <span class="hljs-type">char</span>[] needleArr = needle.toCharArray();    <span class="hljs-type">int</span>[] next = getNext(needleArr);    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;    <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;    <span class="hljs-keyword">if</span> (haystack.length() &lt; needle.length()) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;    <span class="hljs-keyword">while</span> (i &lt; haystack.length()) &#123;        <span class="hljs-keyword">if</span> (haystackArr[i] == needleArr[j]) &#123;            <span class="hljs-keyword">if</span> (j == needle.length()-<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> i - j;            i++;            j++;        &#125; <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">if</span> (j == <span class="hljs-number">0</span>) &#123;                i++;            &#125; <span class="hljs-keyword">else</span> &#123;                j = next[j-<span class="hljs-number">1</span>];            &#125;        &#125;    &#125;    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>Leetcode</category>
      
    </categories>
    
    
    <tags>
      
      <tag>leetcode</tag>
      
      <tag>KMP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - APIs and Promises Introduction</title>
    <link href="/2024/07/05/MIT_Weblab/apis-promises/"/>
    <url>/2024/07/05/MIT_Weblab/apis-promises/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><ul><li>Client sends request to server, and server responds with result.</li><li>A server binds to a port on a computer. A computer can run multiple servers simultaneously, each server binds to a unique port.</li><li>Domain of my own computer: localhost. (<a href="http://localhost:3000">http://localhost:3000</a>)</li></ul><h2 id="APIs">APIs</h2><ul><li>API (Application Programming Interface). Interface can be thought of as a contract of service between two applications. This contract defines how the two communicate with each other using requests and responses.</li><li>Frontend makes http requests to the endpoints defined on the backend.</li></ul><h3 id="HTTP-S-Methods">HTTP(S) Methods</h3><ul><li>GET: Retrieves data from the server.</li><li>POST: Sends data to the server, often causing a change or creation of new data.</li><li>PUT: Replaces data on the server.</li><li>DELETE: Deletes data on the server.</li></ul><h4 id="HTTP-Request">HTTP Request</h4><ul><li>Request Target (URL) + Params: The endpoint and any parameters.</li><li>HTTP Method: The type of action (GET, POST, etc.).</li><li>Headers: Additional metadata for the request.</li><li>Body: The data sent with the request (for POST and PUT).</li></ul><h4 id="HTTP-Response">HTTP Response</h4><ul><li>Status Code: Indicates the result of the request.<ul><li>2xx: Success</li><li>4xx: Client errors</li><li>5xx: Server errors</li></ul></li><li>Headers: Metadata about the response.</li><li>Body: The data returned by the server.</li></ul><h3 id="Make-HTTP-Requests">Make HTTP Requests</h3><p>The <code>fetch()</code> function in JavaScript is used to make network requests.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">fetch</span>(url, options)</code></pre></div><ul><li><p>url: he URL to which the request is sent.</p></li><li><p>absolute url: e.g. <code>http://example.com/api/data</code></p></li><li><p>relative url: e.g. ‘api/data’ (relative to current page), ‘…/api/data’, ‘/api/data’ (relative to root)</p></li><li><p>options: the option object including properties like method, headers, body, mode</p></li></ul><h4 id="Get-Request">Get Request</h4><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Helper code to make a get request. Default parameter of empty JSON Object for params.</span><span class="hljs-comment">// Returns a Promise to a JSON Object.</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">endpoint, params = &#123;&#125;</span>) &#123;  <span class="hljs-keyword">const</span> fullPath = endpoint + <span class="hljs-string">&quot;?&quot;</span> + <span class="hljs-title function_">formatParams</span>(params);  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(fullPath)    .<span class="hljs-title function_">then</span>(convertToJSON)    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;      <span class="hljs-comment">// give a useful error message</span>      <span class="hljs-keyword">throw</span> <span class="hljs-string">`GET request to <span class="hljs-subst">$&#123;fullPath&#125;</span> failed with error:\n<span class="hljs-subst">$&#123;error&#125;</span>`</span>;    &#125;);&#125;<span class="hljs-comment">// In front-end:</span><span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/api/comment&quot;</span>, &#123; <span class="hljs-attr">parent</span>: props.<span class="hljs-property">_id</span> &#125;) <span class="hljs-comment">// send the request</span></code></pre></div><ul><li>Parameters are passed as part of the URL in the query string for get request</li></ul><h4 id="Post-Request">Post Request</h4><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Helper code to make a post request. Default parameter of empty JSON Object for params.</span><span class="hljs-comment">// Returns a Promise to a JSON Object.</span><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">post</span>(<span class="hljs-params">endpoint, params = &#123;&#125;</span>) &#123;  <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(endpoint, &#123;    <span class="hljs-attr">method</span>: <span class="hljs-string">&quot;post&quot;</span>,    <span class="hljs-attr">headers</span>: &#123; <span class="hljs-string">&quot;Content-type&quot;</span>: <span class="hljs-string">&quot;application/json&quot;</span> &#125;,    <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(params),  &#125;)    .<span class="hljs-title function_">then</span>(convertToJSON) <span class="hljs-comment">// convert result to JSON object</span>    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> &#123;      <span class="hljs-comment">// give a useful error message</span>      <span class="hljs-keyword">throw</span> <span class="hljs-string">`POST request to <span class="hljs-subst">$&#123;endpoint&#125;</span> failed with error:\n<span class="hljs-subst">$&#123;error&#125;</span>`</span>;    &#125;);&#125;<span class="hljs-comment">// In front-end:</span><span class="hljs-keyword">const</span> body = &#123; <span class="hljs-attr">content</span>: value &#125;;<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;api/story&quot;</span>, body)  <span class="hljs-comment">// send the request</span></code></pre></div><ul><li>Parameters are included in the request body as key-value pairs. The body can be in various formats (e.g., JSON, XML, form data), but JSON is common.</li><li><code>body</code>: The actual data sent with the request. <code>JSON.stringify(params)</code> converts the JavaScript object params into a JSON string.</li></ul><h3 id="Define-API-Endpoints">Define API Endpoints</h3><p>The following uses Express.js</p><p>When the backend receives a request to an API endpoint, it executes the corresponding route handler function to process the request, interact with the database, and send back a response.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<span class="hljs-comment">// get</span>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/api/stories&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  res.<span class="hljs-title function_">send</span>(data.<span class="hljs-property">stories</span>);&#125;);<span class="hljs-comment">// post</span>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/api/story&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> newStory = &#123;    <span class="hljs-attr">_id</span>: data.<span class="hljs-property">stories</span>.<span class="hljs-property">length</span>,    <span class="hljs-attr">creator_name</span>: myName,    <span class="hljs-attr">content</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">content</span>,  &#125;;  data.<span class="hljs-property">stories</span>.<span class="hljs-title function_">push</span>(newStory);  res.<span class="hljs-title function_">send</span>(newStory);&#125;);</code></pre></div><ul><li><p>req: The req object represents the HTTP request and contains information about the request that was made by the client. It can be used to access information about the incoming request.</p></li><li><p><strong>req.query</strong>: Extract the query parameters (for get request) from the query string in the URL</p></li><li><p><strong>req.body</strong>: Data sent in the body of the request (typically with POST, PUT, or DELETE requests).</p></li><li><p>res: The res object represents the HTTP response that an Express application sends when it receives a request.</p></li><li><p>res.send(): The parameter can be of different types, such as a string, Buffer, JSON object, array, etc.</p></li><li><p>res.status(404).send(‘Page not found’): First set status code and then send.</p></li><li><p>res.sendFile(path.join(reactPath, “index.html”)): send a file back</p></li></ul><h3 id="Middleware">Middleware</h3><p>Middleware: Run code in between receiving a request and running endpoint code. Middlewares are called in order of definition. Register middleware by calling app.use().</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();app.<span class="hljs-title function_">use</span>(path, middlewareFunction);</code></pre></div><ul><li>path (optinoal): Specifies the base path for the middleware function. If omitted, the middleware will be executed for every request to the app.</li><li>A function to execute for the given path.</li></ul><h4 id="Using-Middleware-to-route">Using Middleware to route</h4><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// api.js</span><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>();router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/test&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;    res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;API Test Endpoint&#x27;</span>);&#125;);<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router;</code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// server.js</span><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<span class="hljs-keyword">const</span> apiRouter = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./api&#x27;</span>);app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>()); <span class="hljs-comment">// Middleware to parse JSON bodies</span>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/api&#x27;</span>, apiRouter); <span class="hljs-comment">// Middleware to route /api paths to api.js</span>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Server is running on port 3000&#x27;</span>);&#125;);</code></pre></div><p>When <code>http://localhost:3000/api/test</code> request is sent to the server, the following sequence happens:</p><ol><li>The JSON parsing middleware <code>express.json()</code> processes the request.</li><li>The request path <code>/api/test</code> is checked against the <code>apiRouter</code>, matches, and then the request is forwarded to <code>apiRouter</code>.</li><li>The router checks its defined routes and finds a match for GET <code>/test</code>, and the handler for <code>/test</code> is executed.</li></ol><h2 id="Promises">Promises</h2><h3 id="Async-Handling">Async Handling</h3><p>Get or Post returns a promise. <strong>Promises allow for asynchronous processing</strong>.</p><p>A bad example:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> myStories = <span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/stories&#x27;</span>);<span class="hljs-title function_">setStories</span>(myStories);</code></pre></div><p>In this example, <code>get('/api/stories')</code> returns a promise, but setStories(myStories) is called immediately, before the promise has resolved. As a result, the immediately returned promise: myStories, will not contain any data.</p><p>Correct way to handle this:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/stories&#x27;</span>)  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;    <span class="hljs-title function_">setStories</span>(data); <span class="hljs-comment">// Set the stories with the fetched data</span>  &#125;)  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Error fetching stories:&#x27;</span>, error); <span class="hljs-comment">// Handle any errors</span>  &#125;);</code></pre></div><ul><li><code>.then()</code> block waits for the promise to resolve. Once the data is fetched, the parsed <code>data</code> is then passed to <code>setStories(data)</code>. This also returns a promise.</li><li>The <code>.catch()</code> block handles any errors. Once the promise is rejected, do stuff (call a callback function). Returns a promise.</li><li>If the fetch is accepted, <code>.catch()</code> will not be executed. If the fetch is rejected, any <code>.then()</code> will not be executed.</li></ul><h2 id="Put-Together">Put Together</h2><p>Get request example:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// In frontend:</span><span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/api/comment&quot;</span>, &#123; <span class="hljs-attr">parent</span>: props.<span class="hljs-property">_id</span> &#125;)  <span class="hljs-comment">// send a get request to backend</span>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">comments</span>) =&gt;</span> &#123;      <span class="hljs-title function_">setComments</span>(comments);  &#125;); <span class="hljs-comment">// In backend:</span>router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/comment&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  <span class="hljs-comment">// define the logic to handle the get request from url &quot;/api/comment&quot;</span>  <span class="hljs-keyword">const</span> filteredComments = data.<span class="hljs-property">comments</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">comment</span>) =&gt;</span> comment.<span class="hljs-property">parent</span> == req.<span class="hljs-property">query</span>.<span class="hljs-property">parent</span>);  res.<span class="hljs-title function_">send</span>(filteredComments); <span class="hljs-comment">// send responses back to the client</span>&#125;);</code></pre></div><p>The following happens sequentially:</p><ol><li>The <code>get</code> function sends a GET request to the backend at the endpoint “/api/comment” with a query parameter parent set to props._id.</li><li>The backend’s <code>router.get(&quot;/comment&quot;, (req, res) =&gt; { ... })</code> function is triggered by the incoming GET request to “/comment”.</li><li>The backend extracts the parent parameter from the query string using <code>req.query.parent</code>.</li><li>The backend constructs and sends the <code>filteredComments</code> array back to the frontend using <code>res.send(filteredComments)</code>.</li><li>The frontend’s promise, returned by the <code>get</code> function, resolves with the <code>filteredComments</code> array received from the backend.</li><li>The <code>.then((comments) =&gt; { ... })</code> method is called with <code>comments</code> as the argument, which is the <code>filteredComments</code> array.</li><li>setComments(comments) is called, triggering a re-render of the component with the new comments.</li></ol><p>Put request example:</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// In frontend:</span><span class="hljs-keyword">const</span> body = &#123; <span class="hljs-attr">parent</span>: props.<span class="hljs-property">storyId</span>, <span class="hljs-attr">content</span>: value &#125;;<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/api/comment&quot;</span>, body)  <span class="hljs-comment">// send a get request to backend</span>.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">comment</span>) =&gt;</span> &#123;  props.<span class="hljs-title function_">addNewComment</span>(comment);&#125;);<span class="hljs-comment">// In backend:</span>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&quot;/comment&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;  <span class="hljs-keyword">const</span> newComment = &#123;    <span class="hljs-attr">_id</span>: data.<span class="hljs-property">comments</span>.<span class="hljs-property">length</span>,    <span class="hljs-attr">creator_name</span>: myName,    <span class="hljs-attr">parent</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">parent</span>,    <span class="hljs-attr">content</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">content</span>,  &#125;;  data.<span class="hljs-property">comments</span>.<span class="hljs-title function_">push</span>(newComment);  res.<span class="hljs-title function_">send</span>(newComment);&#125;);</code></pre></div><ul><li>The parameter of post request can be extracted by <code>req.body.xxx</code> in the backend.</li><li>The backend sends back the newComment to the client.</li><li><code>.then()</code> waits for the promise to resolve. The callback function defined in <code>.then()</code> takes the response as the parameter and makes changes.</li></ul>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - React Advanced</title>
    <link href="/2024/07/04/MIT_Weblab/react-advanced/"/>
    <url>/2024/07/04/MIT_Weblab/react-advanced/</url>
    
    <content type="html"><![CDATA[<h2 id="React-Lifecycle">React Lifecycle</h2><ol><li><strong>Trigger</strong>: First time component is called or State Change</li><li><strong>Render</strong>: React runs the Javascript code in component and calls subcomponents</li><li><strong>Commit</strong>: React puts returned JSX into HTML DOM to be served to viewer</li><li><strong>Unmounting</strong>: React Removes the component from DOM</li></ol><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">Steak</span> = (<span class="hljs-params"></span>) =&gt; &#123;  <span class="hljs-keyword">const</span> [doneness, setDoneness] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);  <span class="hljs-comment">// Everything below are called again during re-render</span>  <span class="hljs-keyword">const</span> &#123; name, imgSrc &#125; = steakLookup[doneness];  <span class="hljs-keyword">const</span> sentence = <span class="hljs-string">`Here is your <span class="hljs-subst">$&#123;name&#125;</span> steak!`</span>;  <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendToKitchen</span> = (<span class="hljs-params"></span>) =&gt; &#123;    <span class="hljs-title function_">setDoneness</span>(doneness + <span class="hljs-number">1</span>);  &#125;;  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>&#123;sentence&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#123;imgSrc&#125;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">maxWidth:</span> &quot;<span class="hljs-attr">500px</span>&quot; &#125;&#125; /&gt;</span></span><span class="language-xml">      &#123;doneness &lt; 4 &amp;&amp; (</span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">fontSize:</span> &quot;<span class="hljs-attr">24px</span>&quot; &#125;&#125; <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;sendToKitchen&#125;</span>&gt;</span></span><span class="language-xml">          Send Back To Kitchen</span><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">      )&#125;</span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;;</code></pre></div><p>When a state is updated, the javascript code in component is executed again, except the state definition lines (Non-state variables don’t persist!)</p><h2 id="React-Hooks">React Hooks</h2><h3 id="useEffect">useEffect()</h3><h4 id="Syntax">Syntax</h4><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">useEffect</span>(  <span class="hljs-function">() =&gt;</span> &#123;    <span class="hljs-comment">/*</span><span class="hljs-comment">    Do something here,</span><span class="hljs-comment">    e.g. interacting with an external service</span><span class="hljs-comment">    */</span>    <span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;/api/stories&quot;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">storyObjs</span>) =&gt;</span> &#123;      <span class="hljs-title function_">setStories</span>(storyObjs);    &#125;);    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;&#125;;  &#125;,[<span class="hljs-comment">/* dependencies */</span>]);</code></pre></div><ul><li>Setting state (defined by <code>useState()</code> hook) is async</li><li><code>useEffect()</code> is used to run function every time a variable in dependency array changes</li><li>Commonly used to load external data into state</li><li>The return is a callback function that runs when the component dismounts, like cleanup function</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">myFunction</span> = (<span class="hljs-params"></span>) =&gt; &#123;  <span class="hljs-comment">// Do something</span>&#125;;<span class="hljs-title function_">useEffect</span>(myFunction, [var1, var2]); <span class="hljs-comment">// Calls myFunction every time var1 or var2 changes</span><span class="hljs-title function_">useEffect</span>(myFunction, []); <span class="hljs-comment">// Calls myFunction only once when the component is rendered for the first time (on mount)</span><span class="hljs-title function_">useEffect</span>(myFunction); <span class="hljs-comment">// Calls myFunction at every render (first component call + every time any state changes)</span></code></pre></div><h2 id="Router-Reach-Router">Router (Reach Router)</h2><p>Routers select a child to render based on the child’s path. The children are just other components that could be rendered on their own outside of a Router. We usually define the <code>&lt;Router&gt;</code> part in the <code>&lt;App&gt;</code> component.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span><span class="hljs-keyword">import</span> &#123; render &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Router</span>, <span class="hljs-title class_">Link</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@reach/router&quot;</span><span class="hljs-keyword">let</span> <span class="hljs-title function_">Home</span> = (<span class="hljs-params"></span>) =&gt; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="hljs-keyword">let</span> <span class="hljs-title function_">Dash</span> = (<span class="hljs-params"></span>) =&gt; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Dash<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="hljs-keyword">let</span> <span class="hljs-title function_">Team</span> = (<span class="hljs-params"></span>) =&gt; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Team<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="hljs-title function_">render</span>(  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Home</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/&quot;</span> /&gt;</span>  // root</span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Dash</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;dashboard&quot;</span> /&gt;</span> // append &quot;dashboard&quot; to the end of the current url</span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Team</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/team&quot;</span> /&gt;</span> // root + &quot;/team&quot;</span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">NotFound</span> <span class="hljs-attr">default</span> /&gt;</span> // display the NotFound component if the URL is undefined</span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span></span>)</code></pre></div><ul><li>The path <code>/</code> represents the homepage or the main entry point of the application.</li><li>This path starts with a <code>/</code> indicates it is an absolute path from the root of the application.</li></ul><h2 id="Link">Link</h2><p>We can add links to nav bars.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> <span class="hljs-title function_">Home</span> = (<span class="hljs-params"></span>) =&gt; (  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/&quot;</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;dashboard&quot;</span>&gt;</span>Dashboard<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>)<span class="hljs-keyword">let</span> <span class="hljs-title function_">Dash</span> = (<span class="hljs-params"></span>) =&gt; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Dash<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="hljs-title function_">render</span>(  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Home</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/&quot;</span> /&gt;</span> // root path</span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Dash</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;dashboard&quot;</span> /&gt;</span> // relative path</span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span></span>)</code></pre></div><h2 id="Control-Flow">Control Flow</h2><p>How to dynamically render different JSX based on conditions? For example, I want a component looks different depending on the state value.</p><p>In JSX, we cannot directly use control flow statements like <code>if</code>, <code>for</code>, or <code>while</code> within the curly braces (<code>{}</code>). This is because these JavaScript control flow statements do not return a value. They are considered statements rather than expressions in JavaScript. The following ways can help us control what the component renders (What is inside JSX):</p><h3 id="Assign-JSX-fragements-to-JavaScript-variables">Assign JSX fragements to JavaScript variables</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">outOfBandJSX</span>(<span class="hljs-params">option</span>) &#123;  <span class="hljs-keyword">var</span> optionJSX;  <span class="hljs-keyword">if</span> (option) &#123;    optionJSX = <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Option was True<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;  &#125; <span class="hljs-keyword">else</span> &#123;    optionJSX  = <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Option was False<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;  &#125;  <span class="hljs-keyword">var</span> listItems = [];  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;    listItems[i] = <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;i&#125;</span>&gt;</span>List Item &#123;i&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span>;  &#125;  <span class="hljs-keyword">var</span> retVal =    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      &#123;optionJSX&#125;</span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><span class="language-xml">        &#123;listItems&#125;</span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;  <span class="hljs-keyword">return</span> retVal;&#125;</code></pre></div><ul><li>The function combines the conditional JSX fragment and the list of items into a single return value. The retVal variable is a JSX fragment that includes both the conditionally rendered optionJSX and the dynamically generated listItems. This JSX is returned by the function and can be rendered in the component.</li><li>Then we can include <code>{this.outOfBandJSX(true)}</code> or <code>{this.outOfBandJSX(false)}</code> in the JSX to effectively control what we want.</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> greeting; <span class="hljs-keyword">const</span> en = <span class="hljs-string">&quot;Hello&quot;</span>; <span class="hljs-keyword">const</span> sp = <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>Hola<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span></span>; <span class="hljs-keyword">let</span> &#123;useSpanish&#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">prop</span>; <span class="hljs-keyword">if</span> (useSpanish) &#123;greeting = sp&#125; <span class="hljs-keyword">else</span> &#123;greeting = en&#125;; <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>&#123;greeting&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></code></pre></div><h3 id="Embedding-the-operations-inside-of-curly-braces">Embedding the operations inside of curly braces</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">return</span> (  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;loading ? &quot;Loading...&quot; : &quot;Actual page content&quot;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>);</code></pre></div><ul><li>Although arbitrary JavaScript can appear inside braces, it must return a string or JSX expression to work. The <code>?:</code> operator always return a value.</li><li>If loading is true, it displays the text “Loading…”.</li><li>If loading is false, it displays “Actual page content”.</li></ul><h3 id="Short-circuit-boolean-operations">Short-circuit boolean operations</h3><div class="code-wrapper"><pre><code class="hljs jsx">&lt;div&gt;  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>A paragraph will appear between this paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>  &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">inputValue</span> &amp;&amp; (      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This text will appear when this.state.inputValue is truthy.</span><span class="language-xml">        this.state.inputValue === &#123;this.state.inputValue&#125;</span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>    )  &#125;  &lt;p&gt;... and <span class="hljs-variable language_">this</span> one when some characters are typed into the input box below.&lt;/p&gt;&lt;/div&gt;</code></pre></div><ul><li>If <code>this.state.inputValue</code> is true, the right-hand-side of <code>&amp;&amp;</code> will be executed, a new <code>&lt;p&gt;</code> element will be rendered. Else, nothing will be rendered.</li></ul><h2 id="Rendering-an-Array-of-Data">Rendering an Array of Data</h2><h3 id="Key">Key</h3><div class="code-wrapper"><pre><code class="hljs javascript">storiesList = stories.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">storyObj</span>) =&gt;</span> (  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Card</span></span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;</span>`<span class="hljs-attr">Card_</span>$&#123;<span class="hljs-attr">storyObj._id</span>&#125;`&#125;</span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">_id</span>=<span class="hljs-string">&#123;storyObj._id&#125;</span></span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">creator_name</span>=<span class="hljs-string">&#123;storyObj.creator_name&#125;</span></span></span><span class="hljs-tag"><span class="language-xml">    <span class="hljs-attr">content</span>=<span class="hljs-string">&#123;storyObj.content&#125;</span></span></span><span class="hljs-tag"><span class="language-xml">  /&gt;</span></span>));</code></pre></div><ul><li>the “key” prop is a special attribute you need to include when creating lists of elements. Keys help React identify which items have changed, are added, or are removed, improving efficiency of rendering</li><li>In this case, the key is a unique string that combines the word “Card_” with the unique identifier <code>_id</code> from the storyObj</li></ul><p>Return an array of html elements</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> data = [  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&quot;My favorite food is doritos&quot;</span> &#125;,  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&quot;I like nachos because they look like doritos&quot;</span> &#125;,];<span class="hljs-keyword">return</span> data.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;item.id&#125;</span>&gt;</span>&#123;item.text&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;&#125;);</code></pre></div><p>Return an array of components</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> data = [  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&quot;My favorite food is doritos&quot;</span> &#125;,  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&quot;I like nachos because they look like doritos&quot;</span> &#125;,];<span class="hljs-keyword">return</span> data.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ItemComponent</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;item.id&#125;</span>&gt;</span>&#123;item.text&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">ItemComponent</span>&gt;</span></span>);</code></pre></div><ul><li>Reasons for Using <code>key</code> in React Lists: This allows React to determine which elements have changed, added, or removed and to update only the necessary parts of the DOM. Without keys, React would need to re-render the entire list, which can be inefficient.</li></ul><h2 id="Input-using-DOM-like-handlers">Input using DOM-like handlers</h2><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;    <span class="hljs-variable language_">super</span>(props);    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;      <span class="hljs-attr">inputValue</span>: <span class="hljs-string">&#x27;&#x27;</span>    &#125;;  &#125;  handleChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123; <span class="hljs-attr">inputValue</span>: event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span> &#125;);  &#125;  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-keyword">return</span> (      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;this.state.inputValue&#125;</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">&#123;this.handleChange&#125;</span> /&gt;</span></span>    );  &#125;&#125;</code></pre></div><ul><li><code>type=&quot;text&quot;</code>: This specifies that the input field is for text input.</li><li><code>value={this.state.inputValue}</code>: This binds the value of the input field to the <code>inputValue</code> property in the component’s state.</li><li>The <code>onChange</code> event is triggered every time the user types something in the input field.</li></ul>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - React Introduction</title>
    <link href="/2024/07/03/MIT_Weblab/react/"/>
    <url>/2024/07/03/MIT_Weblab/react/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>React is a JavaScript library for building user interfaces, particularly single-page applications.</p><p>React uses a virtual DOM to efficiently update the user interface. The Virtual DOM is an in-memory representation of the real DOM elements generated by React components. React updates the Virtual DOM whenever the state of a component changes and then determines the most efficient way to update the real DOM to match the Virtual DOM.</p><p>The React code is executed in the user’s browser, enabling the creation of more interactive and responsive applications. The applications can update the user interface quickly without needing to refresh the entire page or make frequent server requests.</p><h2 id="React-Key-Ideas">React Key Ideas</h2><h3 id="Components">Components</h3><ol><li>Divide the app into components, and put one in each file</li><li>Each component is a function that takes props as input and returns JSX (HTML-like code).</li></ol><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// App.js</span><span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"></span>) =&gt; &#123;  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">NavBar</span> /&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Intro</span> /&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Photos</span> /&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">Post</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;;</code></pre></div><p>This code defines a React component named App (parent component) using an arrow function. The component returns a JSX structure that includes other components: NavBar, Intro, Photos, and Post (children components).</p><h3 id="Props">Props</h3><ol start="3"><li>We pass props from parent component to child component:</li></ol><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// App.js</span>&lt;<span class="hljs-title class_">Post</span> name=<span class="hljs-string">&quot;Kenneth&quot;</span> text=<span class="hljs-string">&quot;Welcome to web lab!&quot;</span> /&gt; <span class="hljs-comment">// inside parent component</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Post.js</span><span class="hljs-keyword">const</span> <span class="hljs-title function_">Post</span> = (<span class="hljs-params">props</span>) =&gt; &#123;  <span class="hljs-comment">// child component</span>  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>&#123;props.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;props.text&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>&quot;Like&quot;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;;</code></pre></div><ul><li>React uses className instead of class for CSS style.</li><li><strong>What the component function returns is what to be rendered.</strong></li><li>What inside <code>return()</code> uses JSX syntax (HTML-like code).</li></ul><h3 id="JSX-Syntax">JSX Syntax</h3><ul><li>We can write HTML in JSX environment.</li><li>Parentheses <code>()</code> allow us to enter a JSX environment.</li><li><strong>Inside the JSX environment, curly braces <code>{}</code> allow us to create a mini JavaScript environment.</strong></li></ul><h3 id="State">State</h3><ol start="4"><li>State is data maintained by a component and is mutable. State can be kept in parent components so that it can be passed into reusable child components as props.</li></ol><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Post.js</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-title function_">Post</span> = (<span class="hljs-params">props</span>) =&gt; &#123;  <span class="hljs-keyword">const</span> [isLiked, setIsLiked] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// declare state variable in the Post component</span>  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>&#123;props.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;props.text&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> &#123;</span><span class="language-xml">          setIsLiked(!isLiked);</span><span class="language-xml">        &#125;&#125;</span><span class="language-xml">      &gt;</span><span class="language-xml">        &#123;isLiked ? &quot;Liked&quot; : &quot;Like&quot;&#125;</span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;;</code></pre></div><ul><li>When clicking on the <code>Like</code> button, the state variable <code>isLiked</code> will be changed to <code>true</code>, and “Liked” will be displayed.</li><li><code>useState(false)</code> returns two values. isLiked: The initial state value, set to false. setIsLiked: A function that lets you update the isLiked state.</li><li>Calling <code>setIsLiked(true)</code> will set isLiked to true and trigger a <strong>re-render</strong>.</li><li>**State variable can only be modified through the set function, i.e., we can’t do <code>isLiked = false</code>, we should do <code>setIsLiked(false)**</code>. Another example is that if a state is an array, and to add a new element to the array, we should do <code>setXXX(XXX.concat(data))</code> because <code>.concat()</code> will create a new array without directly modifying the original array.</li></ul><h3 id="Put-Together">Put Together</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// App.js</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<span class="hljs-keyword">import</span> <span class="hljs-title class_">NavBar</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./NavBar&quot;</span>;<span class="hljs-keyword">import</span> <span class="hljs-title class_">Intro</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./Intro&quot;</span>;<span class="hljs-keyword">import</span> <span class="hljs-title class_">Photos</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./Photos&quot;</span>;<span class="hljs-keyword">import</span> <span class="hljs-title class_">Post</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./Post&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"></span>) =&gt; &#123;  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">NavBar</span> /&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Intro</span> /&gt;</span></span><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Photos</span></span></span><span class="hljs-tag"><span class="language-xml">          <span class="hljs-attr">links</span>=<span class="hljs-string">&#123;[</span></span></span><span class="hljs-tag"><span class="language-xml">            &quot;<span class="hljs-attr">pic1.jpg</span>&quot;,</span></span><span class="hljs-tag"><span class="language-xml">            &quot;<span class="hljs-attr">pic2.jpg</span>&quot;,</span></span><span class="hljs-tag"><span class="language-xml">            &quot;<span class="hljs-attr">pic3.jpg</span>&quot;,</span></span><span class="hljs-tag"><span class="language-xml">            &quot;<span class="hljs-attr">pic4.jpg</span>&quot;,</span></span><span class="hljs-tag"><span class="language-xml">            &quot;<span class="hljs-attr">pic5.jpg</span>&quot;,</span></span><span class="hljs-tag"><span class="language-xml">            &quot;<span class="hljs-attr">pic6.jpg</span>&quot;,</span></span><span class="hljs-tag"><span class="language-xml">            &quot;<span class="hljs-attr">pic7.jpg</span>&quot;,</span></span><span class="hljs-tag"><span class="language-xml">          ]&#125;</span></span><span class="hljs-tag"><span class="language-xml">        /&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">Post</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Songlin Zhao&quot;</span> <span class="hljs-attr">text</span>=<span class="hljs-string">&quot;Welcome to my space!&quot;</span> /&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;</code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Photos.js</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-title function_">Photos</span> = (<span class="hljs-params">props</span>) =&gt; &#123;  <span class="hljs-keyword">const</span> myImageTags = props.<span class="hljs-property">links</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">photoLink</span>) =&gt;</span> &#123; <span class="hljs-comment">// map an array of string to an array of html contents</span>    <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#123;photoLink&#125;</span> /&gt;</span></span>;  &#125;);  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Photos<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><span class="language-xml">      &#123;myImageTags&#125;</span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Photos</span>;</code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Post.js</span><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;<span class="hljs-keyword">const</span> <span class="hljs-title function_">Post</span> = (<span class="hljs-params">props</span>) =&gt; &#123;  <span class="hljs-keyword">return</span> (    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>&#123;props.name&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#123;props.text&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> &#123;</span><span class="language-xml">          setIsLiked(!isLiked);</span><span class="language-xml">        &#125;&#125;</span><span class="language-xml">      &gt;</span><span class="language-xml">        &#123;isLiked ? &quot;Liked&quot; : &quot;Like&quot;&#125;</span><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>  );&#125;;<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Post</span>;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - JavaScript Basis</title>
    <link href="/2024/06/27/MIT_Weblab/javascript/"/>
    <url>/2024/06/27/MIT_Weblab/javascript/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><ul><li>Adding a Javascript file to HTML: <code>&lt;script src=&quot;snake.js&quot;&gt;&lt;/script&gt;</code> inside <code>&lt;head&gt;</code> section.</li><li>Any code that is not inside a function will run as soon as the script is loaded.</li><li>Any functions that are called in the global code will be executed <strong>in the order they appear</strong>.</li><li>When both files are included in the HTML with <code>&lt;script&gt;</code> tags, they share the same global scope. This allows functions and variables defined in one file to be accessible in the other.</li></ul><h3 id="Run-Javascript">Run Javascript</h3><div class="code-wrapper"><pre><code class="hljs bash">node code.js</code></pre></div><h3 id="Triggering-Javascript">Triggering Javascript</h3><h4 id="Inline-Event-Handlers">Inline Event Handlers</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;buttonClicked()&quot;</span>&gt;</span>Click Me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">buttonClicked</span>(<span class="hljs-params"></span>) &#123;  <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;Button clicked!&quot;</span>);&#125;</code></pre></div><p>or</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;alert(&#x27;Button clicked!&#x27;)&quot;</span>&gt;</span>Click Me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></code></pre></div><p>The onclick attribute in the <code>&lt;button&gt;</code> tag specifies JavaScript code to run when the button is clicked.</p><h4 id="Event-Listeners">Event Listeners</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;myButton&quot;</span>&gt;</span>Click Me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;myButton&quot;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">    <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;Button clicked!&quot;</span>);</span><span class="language-javascript">  &#125;);</span><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div><ul><li><code>document.getElementById('myButton')</code>: Selects the HTML element with the id myButton and returns a reference to the button element.</li><li><code>.addEventListener</code>: Attaches an event handler to the selected element.</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;keydown&quot;</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event.<span class="hljs-property">key</span>);&#125;);</code></pre></div><ul><li><code>window</code>: The global window object represents the window containing the DOM document.</li></ul><h4 id="Page-Load">Page Load</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><span class="language-javascript">  <span class="hljs-variable language_">window</span>.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><span class="language-javascript">    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Page loaded!&quot;</span>);</span><span class="language-javascript">  &#125;;</span><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div><ul><li>The code inside <code>window.onload</code> runs when the entire page has finished loading.</li></ul><h4 id="Timers">Timers</h4><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;This alert appears after 3 seconds&quot;</span>);&#125;, <span class="hljs-number">3000</span>);<span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;This message appears every 2 seconds&quot;</span>);&#125;, <span class="hljs-number">2000</span>);</code></pre></div><h2 id="Syntax">Syntax</h2><h3 id="Data-Types">Data Types</h3><p>Primitive Types:</p><ul><li>boolean (true, false)</li><li>number (12, 1.3, -45.6, 0)</li><li>string (“Hello”)</li><li>null</li><li>undefined</li></ul><h3 id="Variables">Variables</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> name = <span class="hljs-string">&quot;John Doe&quot;</span>;<span class="hljs-keyword">let</span> age = <span class="hljs-number">30</span>;<span class="hljs-keyword">const</span> isStudent = <span class="hljs-literal">true</span>;</code></pre></div><ul><li>var: Declares a variable that can be globally or functionally scoped.</li><li>let: Declares a block-scoped variable, which means it is limited to the <code>{}</code> to which it is defined.</li><li>const: Declares a block-scoped variable that cannot be reassigned.</li></ul><h3 id="Operaters">Operaters</h3><ul><li><code>===</code>: Compares two values for equality without performing type conversion.</li><li><code>==</code>: Forcing the arguments to be of the same type before comparing them.</li></ul><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-number">5</span> == <span class="hljs-string">&quot;5&quot;</span>; <span class="hljs-comment">// true</span><span class="hljs-number">5</span> === <span class="hljs-string">&quot;5&quot;</span>; <span class="hljs-comment">// false</span><span class="hljs-string">&quot;hello&quot;</span> === <span class="hljs-string">&quot;hello&quot;</span>; <span class="hljs-comment">// true</span></code></pre></div><p><code>===</code> can only compare primitive types! For objects, <code>===</code> compares references to them.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<span class="hljs-keyword">let</span> arr2 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];arr1 === arr2; <span class="hljs-comment">// false</span></code></pre></div><h3 id="Arrays">Arrays</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> colors = [<span class="hljs-string">&quot;red&quot;</span>, <span class="hljs-string">&quot;green&quot;</span>, <span class="hljs-string">&quot;blue&quot;</span>]; <span class="hljs-comment">// initialize</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(colors[<span class="hljs-number">1</span>]); <span class="hljs-comment">// &quot;green&quot;</span>colors[<span class="hljs-number">2</span>] = <span class="hljs-string">&quot;white&quot;</span>;colors.<span class="hljs-title function_">pop</span>(); <span class="hljs-comment">// remove the last</span>colors.<span class="hljs-title function_">push</span>(<span class="hljs-string">&quot;black&quot;</span>); <span class="hljs-comment">// add to the back</span>colors.<span class="hljs-title function_">unshift</span>(<span class="hljs-string">&quot;purple&quot;</span>); <span class="hljs-comment">// add to the front</span></code></pre></div><h3 id="Conditional-Statements">Conditional Statements</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> time = <span class="hljs-number">20</span>;<span class="hljs-keyword">if</span> (time &lt; <span class="hljs-number">12</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Good morning!&quot;</span>);&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (time &lt; <span class="hljs-number">18</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Good afternoon!&quot;</span>);&#125; <span class="hljs-keyword">else</span> &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Good evening!&quot;</span>);&#125;</code></pre></div><h3 id="Loops">Loops</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Number: &quot;</span> + i);&#125;</code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;<span class="hljs-keyword">while</span> (i &lt; <span class="hljs-number">5</span>) &#123;  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Number: &quot;</span> + i);  i++;&#125;</code></pre></div><h3 id="Objects">Objects</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Objects is key-value pairs inside a &#123;&#125;</span><span class="hljs-keyword">let</span> person = &#123;  <span class="hljs-attr">firstName</span>: <span class="hljs-string">&quot;Songlin&quot;</span>,  <span class="hljs-attr">lastName</span>: <span class="hljs-string">&quot;Zhao&quot;</span>,  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,&#125;;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person.<span class="hljs-property">age</span>); <span class="hljs-comment">// 30</span><span class="hljs-comment">// object destructing: obtain multiple properties at once</span><span class="hljs-keyword">const</span> &#123; firstName, lastName &#125; = person;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(firstName); <span class="hljs-comment">// &quot;Songlin&quot;</span><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(lastName); <span class="hljs-comment">// &quot;Zhao&quot;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// Array of objects</span><span class="hljs-keyword">const</span> snakeBody = [  &#123; <span class="hljs-attr">x</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">11</span> &#125;,  &#123; <span class="hljs-attr">x</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">12</span> &#125;,  &#123; <span class="hljs-attr">x</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">13</span> &#125;,];</code></pre></div><h4 id="Copying-two-objects">Copying two objects</h4><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<span class="hljs-keyword">let</span> copyArr = [...arr];<span class="hljs-keyword">let</span> obj = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Eric&quot;</span> &#125;;<span class="hljs-keyword">let</span> copyObj = &#123; ...obj &#125;;</code></pre></div><h3 id="Functions">Functions</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">addOne</span> = (<span class="hljs-params">num</span>) =&gt; &#123;  <span class="hljs-keyword">const</span> result = num + <span class="hljs-number">1</span>;  <span class="hljs-keyword">return</span> result;&#125;;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">addOne</span>(<span class="hljs-number">4</span>)); <span class="hljs-comment">// Output: 5</span></code></pre></div><ul><li>Function is unmodifiable, so use <strong>const functionName</strong></li><li>(parameters) =&gt; {function contents}</li></ul><h3 id="Class">Class</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;  <span class="hljs-comment">// Constructor method to initialize the object</span>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, age</span>) &#123;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;  &#125;  <span class="hljs-title function_">displayDetails</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Name: <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.name&#125;</span>, Age: <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.age&#125;</span>`</span>);  &#125;  <span class="hljs-comment">// Static method</span>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params"></span>) &#123;    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Hello!&#x27;</span>);  &#125;&#125;<span class="hljs-keyword">const</span> person1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;Alice&#x27;</span>, <span class="hljs-number">30</span>);person1.<span class="hljs-title function_">displayDetails</span>(); <span class="hljs-comment">// Output: Name: Alice, Age: 30</span><span class="hljs-title class_">Person</span>.<span class="hljs-title function_">greet</span>(); <span class="hljs-comment">// Output: Hello!</span></code></pre></div><h2 id="Advanced">Advanced</h2><h3 id="Callback-Functions">Callback Functions</h3><p>Pass functions as parameters: Convert array of Celsius to Fahrenheit.</p><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">modifyArray</span> = (<span class="hljs-params">arr, func</span>) =&gt; &#123;  <span class="hljs-keyword">const</span> newArr = [];  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.<span class="hljs-property">length</span>; i++) &#123;    newArr.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">func</span>(arr[i]));  &#125;  <span class="hljs-keyword">return</span> newArr;&#125;;<span class="hljs-keyword">const</span> <span class="hljs-title function_">T2F</span> = (<span class="hljs-params">tempC</span>) =&gt; &#123;  <span class="hljs-keyword">return</span> (tempC * <span class="hljs-number">9</span>) / <span class="hljs-number">5</span> + <span class="hljs-number">32</span>;&#125;;<span class="hljs-keyword">const</span> tempsC = [<span class="hljs-number">0</span>, <span class="hljs-number">25</span>, <span class="hljs-number">100</span>];<span class="hljs-keyword">const</span> tempsF1 = <span class="hljs-title function_">modifyArray</span>(tempsC, <span class="hljs-variable constant_">T2F</span>);<span class="hljs-keyword">const</span> tempsF2 = <span class="hljs-title function_">modifyArray</span>(tempsC, <span class="hljs-function">(<span class="hljs-params">tempC</span>) =&gt;</span> (tempC * <span class="hljs-number">9</span>) / <span class="hljs-number">5</span> + <span class="hljs-number">32</span>); <span class="hljs-comment">// directly put the function in the parameter</span></code></pre></div><ul><li>When using <code>{}</code>, the return value should be specified by the <code>return</code> keyword.</li></ul><h3 id="map">map()</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> myArray = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<span class="hljs-keyword">const</span> newArray = myArray.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> &#123;  <span class="hljs-keyword">return</span> num * <span class="hljs-number">3</span>;&#125;); <span class="hljs-comment">// newArray = [3,6,9,12,15]</span><span class="hljs-keyword">const</span> newArray = myArray.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num * <span class="hljs-number">3</span>); <span class="hljs-comment">// equivalent</span></code></pre></div><ul><li>map() creates a new array.</li><li>map() applies the callback function to every element of the array.</li></ul><h3 id="filter">filter()</h3><div class="code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> values = [-<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<span class="hljs-keyword">const</span> filteredArray = values.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x &gt; <span class="hljs-number">0</span>); <span class="hljs-comment">// filteredArray = [3,4,5]</span></code></pre></div><ul><li>filter() creates a new array.</li><li>filter() selects the element which passes the “test”.</li></ul>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shell - How Shell Works</title>
    <link href="/2024/06/24/CS_Basis/Shell2/"/>
    <url>/2024/06/24/CS_Basis/Shell2/</url>
    
    <content type="html"><![CDATA[<h3 id="Configuration-file">Configuration file</h3><ul><li><code>~/.zshrc</code>: The primary config file for zsh</li><li><code>~/.bashrc</code>: The primary config file for bash (on linux systems)<br>The shell automatically reads (it “sources”) this file every time you open a new terminal. The source command is a built-in shell command that executes a script in the current shell session. For example, if the script exports a variable (e.g., export MY_VAR=“hello”), that variable becomes part of your current shell’s environment.</li></ul><h3 id="How-the-shell-executes-programs">How the shell executes programs</h3><p>When a command is entered in the shell, it follows these steps to execute:</p><ol><li><strong>Parsing:</strong> The shell reads the command line input and breaks it into components. <strong>The first word is the command (program), and the following words are arguments.</strong></li><li><strong>Command Lookup:</strong> The shell searches for the command in the directories listed in the <code>$PATH</code> environment variable.<div class="code-wrapper"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span></code></pre></div></li><li><strong>Forking:</strong> The shell <strong>creates a new process</strong> (child process) to execute the command.</li><li><strong>Return:</strong> After the child process finishes, control returns to the user.</li></ol><h3 id="Executing-programs">Executing programs</h3><div class="code-wrapper"><pre><code class="hljs bash">% <span class="hljs-built_in">echo</span> <span class="hljs-variable">$PATH</span>/Users/.../bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin</code></pre></div><p>The <code>echo $PATH</code> command executes the program <code>echo</code>. The shell searches for it in the directories defined in <code>$PATH</code>. To find where the <code>echo</code> program resides:</p><div class="code-wrapper"><pre><code class="hljs bash">% <span class="hljs-built_in">which</span> <span class="hljs-built_in">echo</span><span class="hljs-built_in">echo</span>: shell built-in <span class="hljs-built_in">command</span></code></pre></div><p>Other examples:</p><div class="code-wrapper"><pre><code class="hljs bash">% <span class="hljs-built_in">which</span> <span class="hljs-built_in">ls</span>/bin/ls% <span class="hljs-built_in">which</span> <span class="hljs-built_in">mkdir</span>/bin/mkdir% <span class="hljs-built_in">which</span> npm/Users/.../bin/npm% <span class="hljs-built_in">which</span> python/opt/anaconda3/bin/python</code></pre></div><p>Check where is my python:</p><div class="code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">There are two python3 installed on my commputer</span><span class="hljs-meta prompt_">% </span><span class="language-bash"><span class="hljs-built_in">which</span> -a python3</span>/opt/miniconda3/bin/python3/usr/bin/python3<span class="hljs-meta prompt_"></span><span class="hljs-meta prompt_"># </span><span class="language-bash">But this <span class="hljs-built_in">command</span> only <span class="hljs-built_in">return</span> one</span><span class="hljs-meta prompt_">% </span><span class="language-bash"><span class="hljs-built_in">which</span> python3</span>/opt/miniconda3/bin/python3</code></pre></div><p><strong>When you have multiple versions of the same command, The shell executes the first one it finds, searching the directories in your <code>$PATH</code> from left to right.</strong></p><h3 id="Export">Export</h3><p>In Linux, every time you run a command or a script, the system creates a process. The child process won’t see the variables defined in parent process unless declared using <code>export</code>.</p><div class="code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">--worker.sh--</span><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span>echo &quot;Starting worker in $APP_MODE mode on port $DB_PORT...&quot;</code></pre></div><div class="code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span>export APP_MODE=&quot;production&quot;export DB_PORT=5432./worker.sh</code></pre></div><p>Without <code>export</code>, the process running <code>./worker.sh</code> won’t see the two variables.</p><h3 id="Types-of-Commands">Types of Commands</h3><ul><li><p>Built-in commands<br>A built-in command is a command that is part of the shell program itself. Examples: <code>cd, echo, exit, export, alias, pwd</code>.</p>  <div class="code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta prompt_">% </span><span class="language-bash"><span class="hljs-built_in">type</span> <span class="hljs-built_in">pwd</span></span>     pwd is a shell builtin</code></pre></div></li><li><p>External Commands<br>An external command is a separate program that exists as a file on your system. Examples: <code>ls, grep, git, python, node</code>.</p>  <div class="code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta prompt_">% </span><span class="language-bash"><span class="hljs-built_in">type</span> <span class="hljs-built_in">ls</span></span>ls is /bin/ls</code></pre></div></li></ul><h2 id="Advanced">Advanced</h2><h3 id="Redirection">Redirection</h3><p>In the shell, each program has an input stream and an output stream — by default, the keyboard and terminal. We can redirect input or output using <code>&lt; file</code> or <code>&gt; file</code>.</p><div class="code-wrapper"><pre><code class="hljs bash">% <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Hello, World&quot;</span> &gt; output.txt</code></pre></div><ul><li><code>echo &quot;Hello, World&quot;</code>: prints text to the terminal.</li><li><code>&gt;</code>: redirects output to the file specified on its right.</li></ul><p>Result: the text “Hello, World” is written to <code>output.txt</code>. <code>&gt;</code> overwrites a file, while <code>&gt;&gt;</code> appends to it.</p><h3 id="Pipes">Pipes</h3><p>Pipes (<code>|</code>) pass the output of one command as input to another.</p><div class="code-wrapper"><pre><code class="hljs bash">% <span class="hljs-built_in">ls</span> -l | grep <span class="hljs-string">&quot;.txt&quot;</span>-rw-r--r--  1 user  staff  13 Jun 24 16:18 output.txt</code></pre></div><p>Explanation:</p><ul><li><code>ls -l</code>: lists files in long format.</li><li><code>|</code>: passes output to the next command.</li><li><code>grep &quot;.txt&quot;</code>: filters for <code>.txt</code> files.</li></ul><p>Combining redirection and pipes:</p><div class="code-wrapper"><pre><code class="hljs bash">% <span class="hljs-built_in">ls</span> -l | grep <span class="hljs-string">&quot;.txt&quot;</span> &gt; txt_files_list.txt% <span class="hljs-built_in">cat</span> txt_files_list.txt-rw-r--r--  1 user  staff  13 Jun 24 16:18 output.txt-rw-r--r--  1 user  staff   0 Jun 24 16:34 txt_files_list.txt</code></pre></div><hr><h2 id="Useful">Useful</h2><h3 id="Alias">Alias</h3><div class="code-wrapper"><pre><code class="hljs bash">bash-3.2$ <span class="hljs-built_in">alias</span> gs=<span class="hljs-string">&quot;git status&quot;</span>bash-3.2$ gsOn branch mainnothing to commit, working tree cleanbash-3.2$ git statusOn branch mainnothing to commit, working tree clean</code></pre></div><p>To make an alias persistent, include it in configuration files like <code>.bashrc</code> or <code>.zshrc</code>.</p>]]></content>
    
    
    <categories>
      
      <category>Computer Basis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MIT Weblab笔记 - HTML &amp; CSS Basis</title>
    <link href="/2024/06/24/MIT_Weblab/html-css-basis/"/>
    <url>/2024/06/24/MIT_Weblab/html-css-basis/</url>
    
    <content type="html"><![CDATA[<h2 id="Introduction">Introduction</h2><p>HTML provides the structure of the web pages, while CSS is used to control the layout of these pages.</p><h2 id="HTML">HTML</h2><h3 id="Structure">Structure</h3><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>    # appears at the browser tabs    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Web Page<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>    # link to the css file for styling    <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;styles.css&quot;</span> /&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello, World!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Welcome to my first web page.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre></div><ul><li><code>&lt;head&gt;</code> contains meta-information about the document, such as its title, link to CSS files</li><li><code>&lt;body&gt;</code> contains the content that will be displayed on the web page.</li></ul><h3 id="Syntax">Syntax</h3><h4 id="Headings">Headings</h4><p><code>&lt;h1&gt;</code> to <code>&lt;h6&gt;</code>.</p><h4 id="Paragraphs">Paragraphs</h4><p><code>&lt;p&gt;</code>, start on new line.</p><h4 id="Divisions">Divisions</h4><p><code>&lt;div&gt;</code>, represents a block-level portion of a document such as a few paragraphs, or an image with its caption. Starts on new line.</p><h4 id="Sections">Sections</h4><p><code>&lt;section&gt;</code>, is used to group meaningful components, like introduction, about, ,etc. Starts on new line.</p><h4 id="Spans">Spans</h4><p><code>&lt;span&gt;</code> represents an <strong>inline</strong> portion of a document, for example words within a sentence.</p><h4 id="Lists">Lists</h4><p>Unordered Lists</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></code></pre></div><p>Ordered Lists</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Item 3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span></code></pre></div><h4 id="Links">Links</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;http://xxx&quot;</span>&gt;</span> content <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></code></pre></div><h4 id="Images">Images</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;image.png&quot;</span> /&gt;</span></code></pre></div><h3 id="Relative-Path">Relative Path</h3><p>A relative path points to a location that is relative to the current file’s location.</p><ul><li>Current Directory (<code>./</code>). It refers to the folder that contains the current file you’re working on. e.g. <code>&lt;img src=&quot;./image.jpg&quot;&gt;</code>, image.jpg is in the same directory as the HTML file or the script calling it.</li><li>Parent Directory (<code>../</code>)</li></ul><h2 id="CSS">CSS</h2><h3 id="Types">Types</h3><ul><li>Inline CSS<br>Using the style attribute:</li></ul><div class="code-wrapper"><pre><code class="hljs css">&lt;<span class="hljs-selector-tag">h1</span> style=&quot;<span class="hljs-attribute">color</span>: red;&quot;&gt;This is <span class="hljs-selector-tag">a</span> heading&lt;/<span class="hljs-selector-tag">h1</span>&gt;</code></pre></div><ul><li>Internal CSS<br>Define within a <code>&lt;style&gt;</code> tag inside the HTML document’s <code>&lt;head&gt;</code> section:</li></ul><div class="code-wrapper"><pre><code class="hljs css">&lt;head&gt;  &lt;style&gt;    <span class="hljs-selector-tag">p</span> &#123;      <span class="hljs-attribute">color</span>: green;      <span class="hljs-attribute">font-family</span>: Arial, sans-serif;    &#125;  &lt;/style&gt;&lt;/head&gt;</code></pre></div><ul><li>External CSS<br>Define in a separate file:</li></ul><div class="code-wrapper"><pre><code class="hljs css">&lt;head&gt;  &lt;link rel=&quot;stylesheet&quot; href=&quot;styles<span class="hljs-selector-class">.css</span>&quot;&gt;&lt;/head&gt;</code></pre></div><h3 id="Syntax-2">Syntax</h3><p>Import fonts from <code>https://fonts.google.com/</code>.</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-keyword">@import</span> url(<span class="hljs-string">&quot;[https://fonts.googleapis.com/css?family=Open+Sans:300,600](https://fonts.googleapis.com/css?family=Open+Sans:300,600)&quot;</span>);</code></pre></div><h4 id="Global-Definition">Global Definition</h4><p>Root variables, defining CSS custom properties (variables) for colors that can be reused throughout the stylesheet. Other parts of the css file can use it by <code>var(--grey)</code>.</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-pseudo">:root</span> &#123;  <span class="hljs-attr">--primary</span>: <span class="hljs-number">#396dff</span>;  <span class="hljs-attr">--grey</span>: <span class="hljs-number">#f7f7f7</span>;  <span class="hljs-attr">--white</span>: <span class="hljs-number">#fff</span>;  <span class="hljs-attr">--xs</span>: <span class="hljs-number">4px</span>;  <span class="hljs-attr">--s</span>: <span class="hljs-number">8px</span>;  <span class="hljs-attr">--m</span>: <span class="hljs-number">16px</span>;  <span class="hljs-attr">--l</span>: <span class="hljs-number">24px</span>;&#125;</code></pre></div><h4 id="Element">Element</h4><p>The style defined here automatically applies to the entire body of the document (inside <code>&lt;body&gt;</code> and <code>&lt;/body&gt;</code>).</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">body</span> &#123;  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;  <span class="hljs-attribute">font-family</span>: <span class="hljs-string">&quot;Open Sans&quot;</span>, sans-serif;&#125;</code></pre></div><h4 id="Class">Class</h4><p>Style for class. <code>&lt;div class=&quot;navTitle&quot;&gt;</code>. <strong>An element can have multiple classes. Can use the same class on multiple elements.</strong></p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.navTitle</span> &#123;  <span class="hljs-attribute">color</span>: <span class="hljs-built_in">var</span>(--primary);  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;  <span class="hljs-attribute">font-weight</span>: normal;&#125;</code></pre></div><h4 id="ID">ID</h4><p>Style for ID. <code>&lt;div id=&quot;unique&quot;&gt;</code>. An element can only have one ID. ID must be unique in any give HTML document.</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-id">#unique</span> &#123;  <span class="hljs-attribute">color</span>:red;  <span class="hljs-attribute">font-family</span>: Arial;&#125;</code></pre></div><h3 id="Style-Rules">Style Rules</h3><p>Priority:</p><ol><li>Inline Style</li><li>ID Attributes (<code>#unique {}</code>)</li><li>Classes (<code>.container {}</code>)</li><li>Elements (<code>div {}</code>)</li></ol><h2 id="Formatting-Techniques">Formatting Techniques</h2><h3 id="The-Box-Model">The Box Model</h3><ul><li>Margin: the space outside the element’s border.</li><li>Border: border surrounds the padding of the element.</li><li>Padding: the space between the element’s border and its content. It creates space inside the parent element, around the content area.</li></ul><div style="text-align: center;"><img src="box.png" style="width: 300px; height: auto;" alt="Box Model"></div><p>Margin and padding are transparent. Width and height are dimensions of the element.</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.xxClass</span> &#123;  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0px</span>;  <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid black;  <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;&#125;</code></pre></div><p><strong>To inspect an element’s box model and other detailed attributes:</strong></p><p><strong>1. Open the browser</strong><br><strong>2. Inspect</strong><br><strong>3. Command + Shift + C</strong><br><strong>4. Click on the element to inspect</strong></p><div style="text-align: center;"><img src="inspect.png" style="width: 80%; height: auto;" alt="Inspect Element"></div><h3 id="Margin-Ordering">Margin Ordering</h3><p>Margin orders in the sequence of top, right, bottom, left</p><ol><li>margin: 10px;: All sides 10px</li><li>margin: 10px 20px;: top and bottom 10px, left and right 20px</li><li>margin: 10px 20px 30px;: top 10px, right 20px, bottom 30px, left 20px</li><li>margin: 10px 20px 30px 40px;: top 10px, right 20px, bottom 30px, left 40px</li></ol><p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/margin">See this demo</a></p><h3 id="Positioning">Positioning</h3><p>In HTML, elements are typically laid out according to the normal document flow. This means they appear in the order they are defined in the HTML. If we want to explicitly set an element’s position, we can use the top, bottom, left, and right properties. However, these properties will not work unless the position property is set first.</p><p><a href="https://www.w3schools.com/css/css_positioning.asp">See this demo</a></p><ul><li>static: Default, position in document flow</li><li>relative: Position relative to default position via top, right, bottom, left properties</li><li>fixed: Position relative to the viewport, which means it always stays in the same place even if the page is scrolled</li><li>absolute: Position relative to the nearest positioned ancestor</li></ul><h3 id="Flex">Flex</h3><p>Flex is a flexible box. It can control direction, sizing, distribution. All direct children of a flexible container becomes flexible items. <a href="https://www.w3schools.com/css/css3_flexbox_items.asp">See this flex demo</a>.</p><div style="text-align: center;"><img src="flex.png" style="width: 50%; height: auto;" alt="Flex Example"></div><p>An example flex container defined in CSS:</p><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.flex-container</span> &#123;  <span class="hljs-attribute">display</span>: flex;  # this attribute makes this class <span class="hljs-selector-tag">a</span> <span class="hljs-attribute">flex</span> <span class="hljs-attribute">container</span>  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#f1f1f1</span>;&#125;</code></pre></div><h4 id="Order">Order</h4><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;flex-container&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;order: 3&quot;</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;order: 2&quot;</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;order: 4&quot;</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;order: 1&quot;</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><h4 id="Sizing">Sizing</h4><p>Make the third flex item grow 2 times faster than the other flex items:</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;flex-container&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;flex-grow: 1&quot;</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;flex-grow: 1&quot;</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;flex-grow: 2&quot;</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><p>Set the initial length of the third flex item to 200 pixels:</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;flex-container&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;flex-basis: 200px&quot;</span>&gt;</span>3<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>4<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><p>An example of horizontal direction: The two sections are now in a row and evenly distributed in the flex container.</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;u-flex&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;subContainer u-textCenter&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>About Me<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>      I am more of a turtle person but I&#x27;m just trying to fit in and get a catbook.    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;subContainer u-textCenter&quot;</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>My Favorite Type of Cat<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>      I actually prefer turtles.    <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>  <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.u-flex</span> &#123;  <span class="hljs-attribute">display</span>: flex;  <span class="hljs-comment">/* justify-content: space-between; */</span>&#125;<span class="hljs-selector-class">.subContainer</span> &#123;  <span class="hljs-attribute">flex-grow</span>: <span class="hljs-number">1</span>;  <span class="hljs-attribute">flex-basis</span>: <span class="hljs-number">0</span>;&#125;</code></pre></div><div style="text-align: center;">    <img src="flex1.png" style="width: 300px; height: auto;" alt="Flex Result"></div>]]></content>
    
    
    <categories>
      
      <category>MIT Weblab</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Web Development</tag>
      
      <tag>CSS</tag>
      
      <tag>HTML</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Shell - Basic Syntax</title>
    <link href="/2024/06/24/CS_Basis/Shell1/"/>
    <url>/2024/06/24/CS_Basis/Shell1/</url>
    
    <content type="html"><![CDATA[<h3 id="What-is-the-shell">What is the shell?</h3><p>A shell is a program that acts as the outermost layer of an operating system. It provides an interface for users to access the services of the kernel. It takes human-readable instructions and converts them into system calls that the kernel understands. The shell in macOS before Catalina is bash (Bourne Again Shell) and currently it’s Zsh (Z Shell). On most Linux distributions, the default shell is bash.</p><h3 id="Basic-shell-commands">Basic shell commands</h3><div class="code-wrapper"><pre><code class="hljs shell">. # current directory.. # parent directorylsmkdircd # change directorypwd # print working directoryecho &quot;text&quot; # prints the specified text to the terminalcat # displays the contents of the specified filetouch example.txt # creates a filegrep &quot;Hello&quot; example.txt # searches for the string “Hello” in a file named example.txt and returns the line containing itexport NODE_ENV=production # make a variable an environment variable</code></pre></div><h3 id="Basic-Bash-Syntax">Basic Bash Syntax</h3><p>Every shell script starts with a shebang line:</p><div class="code-wrapper"><pre><code class="hljs Bash"><span class="hljs-meta">#!/bin/bash</span></code></pre></div><p>This tells the system to run the script with Bash.</p><ul><li>Define variables</li></ul><div class="code-wrapper"><pre><code class="hljs Bash">name=<span class="hljs-string">&quot;Alice&quot;</span> <span class="hljs-comment"># no space around &quot;=&quot;</span><span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Hello, <span class="hljs-variable">$&#123;name&#125;</span>!&quot;</span></code></pre></div><p>In this example, <code>name</code> is variable name, <code>$name</code> represents getting the value of the variable.</p><ul><li>Command substitution</li></ul><div class="code-wrapper"><pre><code class="hljs Bash">% <span class="hljs-built_in">date</span>Fri Oct 24 01:19:10 PDT 2025today=$(<span class="hljs-built_in">date</span>) <span class="hljs-comment"># $(date) runs the date command first, and replace it with its output</span><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Today is <span class="hljs-variable">$today</span>&quot;</span></code></pre></div><p><code>$()</code> means running a command and store its output.</p><ul><li>If statements</li></ul><div class="code-wrapper"><pre><code class="hljs Bash"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$age</span> -gt 18 ]; <span class="hljs-keyword">then</span>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Adult&quot;</span><span class="hljs-keyword">else</span>    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Minor&quot;</span><span class="hljs-keyword">fi</span></code></pre></div><p>Common operators: <code>-eq, -ne, -gt, -ge, -lt, -le</code>.</p><ul><li>For loop</li></ul><div class="code-wrapper"><pre><code class="hljs Bash"><span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> item1 item2 item3; <span class="hljs-keyword">do</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$var</span>&quot;</span><span class="hljs-keyword">done</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs Bash"><span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> *.txt; <span class="hljs-keyword">do</span> <span class="hljs-comment"># get all *.txt in the current directory</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;file: <span class="hljs-variable">$f</span>&quot;</span><span class="hljs-keyword">done</span></code></pre></div><ul><li>While loop</li></ul><div class="code-wrapper"><pre><code class="hljs Bash">count=1<span class="hljs-keyword">while</span> [ <span class="hljs-variable">$count</span> -le 5 ]; <span class="hljs-keyword">do</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Count <span class="hljs-variable">$count</span>&quot;</span>  ((count++))<span class="hljs-keyword">done</span></code></pre></div><ul><li>Arithmetic<br><code>(( ))</code> is used for arithmetic evaluation (like addition, subtraction, comparisons, and increments) in Bash.</li></ul><div class="code-wrapper"><pre><code class="hljs Bash">((a = <span class="hljs-number">5</span> + <span class="hljs-number">3</span>))<span class="hljs-built_in">echo</span> <span class="hljs-variable">$a</span>   <span class="hljs-comment"># 8</span>((a++))((c += <span class="hljs-number">5</span>))((d *= <span class="hljs-number">2</span>))</code></pre></div><div class="code-wrapper"><pre><code class="hljs Bash">a=5b=3<span class="hljs-keyword">if</span> ((a &gt; b)); <span class="hljs-keyword">then</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;a is greater&quot;</span><span class="hljs-keyword">fi</span><span class="hljs-keyword">for</span> ((i=<span class="hljs-number">1</span>; i&lt;=<span class="hljs-number">5</span>; i++)); <span class="hljs-keyword">do</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Number <span class="hljs-variable">$i</span>&quot;</span><span class="hljs-keyword">done</span></code></pre></div><ul><li>Functions</li></ul><div class="code-wrapper"><pre><code class="hljs Bash"><span class="hljs-function"><span class="hljs-title">greet</span></span>() &#123;    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Hello, <span class="hljs-variable">$1</span>&quot;</span>&#125;greet <span class="hljs-string">&quot;Alice&quot;</span></code></pre></div><p><code>$1</code> refers to the first argument passed to the function.</p><ul><li>Special Functions<br><code>?</code> and <code>*</code> can be used to match one or any amount of characters respectively.</li></ul><div class="code-wrapper"><pre><code class="hljs Bash">% <span class="hljs-built_in">ls</span>01 hstack.py04 mask.pybasic.ipynb02 transpose.py04 slicing.ipynb03 least-square.py05 histogram.py% <span class="hljs-built_in">ls</span> *.ipynb04 slicing.ipynbbasic.ipynb% <span class="hljs-built_in">ls</span> b?sic.ipynbbasic.ipynb</code></pre></div><p><code>{}</code> can be used when a set of strings have common substrings.</p><div class="code-wrapper"><pre><code class="hljs Bash">% <span class="hljs-built_in">mkdir</span> a b% <span class="hljs-built_in">touch</span> &#123;a,b&#125;/&#123;x,y,z&#125;<span class="hljs-comment"># The above command will create three files inside a and b folder (a/x, a/y, a/z, b/x, b/y, b/z) respectively.</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs Bash"><span class="hljs-built_in">mv</span> *&#123;.py,.ipynb&#125; dest<span class="hljs-comment"># Will move all *.py and *.ipynb files to folder dest</span></code></pre></div><ul><li>Exit Status<br>Every command in Linux returns an exit status. 0 means success, and non-zero means failure. <code>$?</code> is a special variable that stores the exit code of the most recent command.</li></ul><div class="code-wrapper"><pre><code class="hljs Bash"><span class="hljs-built_in">ls</span> /etc<span class="hljs-built_in">echo</span> $?   <span class="hljs-comment"># 0 = success</span><span class="hljs-built_in">ls</span> /no/such/file<span class="hljs-built_in">echo</span> $?   <span class="hljs-comment"># non-zero = error</span></code></pre></div><div class="code-wrapper"><pre><code class="hljs Bash"><span class="hljs-keyword">if</span> <span class="hljs-built_in">ls</span> /no/such/file; <span class="hljs-keyword">then</span> <span class="hljs-comment"># if the ls command succeed, then print &quot;Command succeeded&quot;</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Command succeeded&quot;</span><span class="hljs-keyword">else</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Command failed&quot;</span><span class="hljs-keyword">fi</span></code></pre></div><h3 id="Tests">Tests</h3><p>Tests are used in conditional statements.</p><ul><li><code>-f file</code>, File exists and is a regular file</li></ul><div class="code-wrapper"><pre><code class="hljs Bash"><span class="hljs-keyword">if</span> [ -f <span class="hljs-string">&quot;config.txt&quot;</span> ]; <span class="hljs-keyword">then</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Config file found&quot;</span><span class="hljs-keyword">else</span>  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;No config file&quot;</span><span class="hljs-keyword">fi</span></code></pre></div><ul><li><code>-d file</code>, file is a directory</li><li><code>-z &quot;$str&quot;</code>, string is empty</li><li><code>-n &quot;$str&quot;</code>, string is not empty</li><li><code>&quot;$a&quot; != &quot;$b&quot;</code>, strings are not equal</li></ul><h4 id="Find-Files">Find Files</h4><div class="code-wrapper"><pre><code class="hljs Bash">find . -name src -<span class="hljs-built_in">type</span> d</code></pre></div><ul><li><code>find .</code>: Start searching in the current directory.</li><li><code>-name src</code>: Match directories named src.</li><li><code>-type d</code>: Ensure that the match is a directory.</li></ul><div class="code-wrapper"><pre><code class="hljs Bash">find . -path <span class="hljs-string">&#x27;*/test/*.py&#x27;</span> -<span class="hljs-built_in">type</span> f</code></pre></div><ul><li><code>-path ‘/test/.py’</code>: Match files where test appears as a directory in their path and the filename ends with .py (* can substitute any string).</li><li><code>-type f</code>: Ensure that the match is a regular file (not a directory).</li></ul><h3 id="Special-Parameters">Special Parameters</h3><ul><li><code>$0</code>, name of the current script</li><li><code>$1</code>, first parameter</li><li><code>$#</code>, number of parameters</li><li><code>$$</code>, current script’s process ID</li><li><code>$?</code>, exit status of the last command</li><li><code>$SHELL</code>, current shell path</li><li><code>$PATH</code>, directories to search for executables</li></ul>]]></content>
    
    
    <categories>
      
      <category>Computer Basis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>My first Blog</title>
    <link href="/2024/06/23/test/"/>
    <url>/2024/06/23/test/</url>
    
    <content type="html"><![CDATA[<h2 id="Post">Post</h2><h3 id="Create-a-new-post">Create a new post</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;Name&quot;</span>$ hexo new post <span class="hljs-string">&quot;topic&quot;</span> --path <span class="hljs-string">&quot;folder/topic&quot;</span></code></pre></div><h3 id="Include-image-in-a-post">Include image in a post</h3><p>Move the image to the folder created automatically by Hexo, and then use the relative path to refer to the image.</p><p>Using hexo syntax, but unable to resize the image:</p><div class="code-wrapper"><pre><code class="hljs Markdown">&#123;% asset<span class="hljs-emphasis">_img sample.jpeg &#x27;This is my picture&#x27; %&#125;</span></code></pre></div><img src="/2024/06/23/test/sample.jpeg" class="" title="This is my picture"><p>Or directly use an <code>&lt;img&gt;</code> tag:</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sample.jpeg&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 300px; height: auto;&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Sample Image&quot;</span>&gt;</span></code></pre></div><img src="sample.jpeg" style="width: 300px; height: auto;" alt="Sample Image"><p>With centered alignment:</p><div class="code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;text-align: center;&quot;</span>&gt;</span>  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;sample.jpeg&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;width: 300px; height: auto;&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Sample Image&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre></div><div style="text-align: center;">  <img src="sample.jpeg" style="width: 300px; height: auto;" alt="Sample Image"></div><hr><h2 id="Blog">Blog</h2><h3 id="Generate-static-files">Generate static files</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo g</code></pre></div><h3 id="Run-server">Run server</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo s</code></pre></div><h3 id="Deploy">Deploy</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo d</code></pre></div><h3 id="Generate-and-Deploy">Generate and Deploy</h3><div class="code-wrapper"><pre><code class="hljs bash">$ hexo g -d</code></pre></div><h3 id="Post-Image">Post Image</h3><div class="code-wrapper"><pre><code class="hljs Markdown">index<span class="hljs-emphasis">_img: /img/test.jpeg</span><span class="hljs-emphasis">banner_</span>img: /img/sky<span class="hljs-emphasis">_castle.jpg</span></code></pre></div><h2 id="Create-a-new-page">Create a new page</h2><div class="code-wrapper"><pre><code class="hljs bash">$ hexo new page <span class="hljs-string">&quot;name&quot;</span></code></pre></div><h3 id="Creating-a-new-navigation-bar">Creating a new navigation bar</h3><ol><li>Create a new <code>.ejs</code> file in <code>/themes/fluid/layout/</code></li><li>Add page attributes in <code>_config.fluid.yml</code>, and include a new menu item inside <code>navbar.menu</code></li><li>Modify <code>/themes/fluid/languages/en.yml</code> to add titles and subtitles</li></ol>]]></content>
    
    
    <categories>
      
      <category>test</category>
      
    </categories>
    
    
    <tags>
      
      <tag>test</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
